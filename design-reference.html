<!DOCTYPE html>
<html lang="en">

<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	    <meta name="theme-color" content="#FAFBFC">
	    <meta name="hub-template-version" content="2025-12-17-navscroll-v1">
	    <meta http-equiv="Content-Security-Policy"
	        content="default-src 'self'; script-src 'self' 'unsafe-inline' https://apis.google.com; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://fonts.googleapis.com; font-src 'self' https://cdnjs.cloudflare.com https://fonts.gstatic.com; img-src 'self' data: https:; frame-src https://lookerstudio.google.com https://calendar.google.com https://drive.google.com https://docs.google.com;">
	    <title>Page Template</title>

	    <script>
	        (function () {
	            try {
	                if (window.self !== window.top) document.documentElement.classList.add('is-embedded');
	            } catch (e) {
	                document.documentElement.classList.add('is-embedded');
	            }
	        })();
	    </script>

    
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" as="style"
        href="https://fonts.googleapis.com/css2?family=Google&#43;Sans&#43;Flex:opsz,wght@8..144,400..700&amp;display=swap">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Google&#43;Sans&#43;Flex:opsz,wght@8..144,400..700&amp;display=swap"
        media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Google&#43;Sans&#43;Flex:opsz,wght@8..144,400..700&amp;display=swap">
    </noscript>

    
    <style>
         
	        :root {
	            --primary: #1F3CFF;
	            --secondary: #00CCFF;
	            --bg-base: #FAFBFC;
	            --bg-surface: #FFFFFF;
	            --text-primary: #1A202C;
	            --skyline-image: url('https://storage.googleapis.com/resourcesite-publicassets-prod/townskyline.svg');
	            --skyline-opacity: 0.135;
	            --skyline-height: clamp(365px, 39.4vh, 788px);
	            --skyline-scale: 220%;
	        }

        body {
            margin: 0;
            padding: 0;
            background: var(--bg-base);
            color: var(--text-primary);
            font-family: 'Google Sans Flex', 'Google Sans', 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-optical-sizing: auto;
            opacity: 0;
            animation: bodyFadeIn 0.2s ease-out 0.1s forwards;
            min-height: 100vh;
            position: relative;
        }

	        body::before {
	            content: '';
	            position: fixed;
	            inset: 0;
	            background:
	                radial-gradient(1400px 560px at 15% -10%, rgba(31, 60, 255, 0.12), transparent 72%),
	                radial-gradient(1400px 560px at 85% -12%, rgba(0, 204, 255, 0.09), transparent 74%),
	                linear-gradient(180deg, rgba(248, 250, 255, 0.96) 0%, rgba(245, 252, 255, 0.92) 100%);
	            z-index: -2;
	            pointer-events: none;
	        }

	        .skyline-overlay {
	            position: fixed;
	            left: 0;
	            right: 0;
	            bottom: 0;
	            height: var(--skyline-height);
	            background-image: var(--skyline-image);
	            background-repeat: repeat-x;
	            background-position: bottom center;
	            background-size: auto var(--skyline-scale);
	            opacity: var(--skyline-opacity);
	            pointer-events: none;
	            z-index: -1;
	        }

        @keyframes bodyFadeIn {
            to {
                opacity: 1;
            }
        }

        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 280px;
            height: 100%;
            background: var(--bg-surface);
            overflow: hidden;
        }

        .main-content {
            margin-left: 280px;
            padding: 20px;
        }
    </style>

    
    <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    </noscript>

    <style>
         

	         
	        * {
	            margin: 0;
	            padding: 0;
	            box-sizing: border-box;
	        }

	         
	        html.is-embedded,
	        html.is-embedded body {
	            position: fixed !important;
	            inset: 0 !important;
	            width: 100% !important;
	            height: 100% !important;
	            overflow: hidden !important;
	            margin: 0 !important;
	            padding: 0 !important;
	            scrollbar-width: none !important;
	            -ms-overflow-style: none !important;
	        }

	        html.is-embedded::-webkit-scrollbar,
	        html.is-embedded body::-webkit-scrollbar {
	            display: none !important;
	            width: 0 !important;
	            height: 0 !important;
	        }

	        html.is-embedded .app-container {
	            position: fixed !important;
	            inset: 0 !important;
	            overflow-y: auto !important;
	            overflow-x: hidden !important;
	        }

         
        .banner-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 36px;
            background: linear-gradient(135deg,
                    var(--brand-red-tint) 0%,
                    var(--brand-blue-tint) 50%,
                    var(--brand-red-tint) 100%);
            background-size: 200% 100%;
            animation: banner-gradient 15s ease infinite;
            z-index: 2000;
            overflow: hidden;
            display: none;
             
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 2px 12px rgba(0, 204, 255, 0.1);
            backdrop-filter: blur(10px);
        }

         
        .banner-show-btn {
            position: fixed;
            top: 10px;
            right: 10px;
             
            z-index: 1999;
            background: linear-gradient(135deg, var(--brand-red-tint), var(--brand-blue-tint));
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 6px 12px;
            font-size: 12px;
            cursor: pointer;
            display: none;
             
            align-items: center;
            gap: 6px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .banner-show-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .banner-show-btn.visible {
            display: inline-flex;
        }

        .banner-show-btn {
            background: linear-gradient(135deg, #e8f2ff, #ffe8e6);
            color: var(--text-primary);
            border: 1px solid rgba(31, 60, 255, 0.2);
        }

        @keyframes banner-gradient {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        .banner-container {
            background: linear-gradient(135deg,
                    #e8f2ff 0%,
                    #ffe8e6 25%,
                    #e6efff 50%,
                    #ffe8e6 75%,
                    #e8f2ff 100%);
            background-size: 200% 100%;
            border-bottom: 1px solid rgba(31, 60, 255, 0.3);
            box-shadow: 0 2px 10px rgba(31, 60, 255, 0.15);
            backdrop-filter: none;
        }

        .banner-container.active {
            display: block;
        }

        .banner-content {
            display: flex;
            align-items: center;
            height: 100%;
            position: relative;
            white-space: nowrap;
        }

        .banner-scroll {
            display: inline-flex;
            padding-left: 100%;
            animation: scroll-banner 40s linear infinite;
        }

        .banner-container:hover .banner-scroll {
            animation-play-state: paused;
        }

        @keyframes scroll-banner {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-100%);
            }
        }

        .banner-item {
            display: inline-flex;
            align-items: center;
            padding: 0 25px;
            color: rgba(255, 255, 255, 0.95);
            font-size: 0.8125rem;
            font-weight: 500;
            letter-spacing: 0.4px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            position: relative;
        }

	        .banner-item {
 	            color: var(--brand-blue);
 	            text-shadow: none;
 	        }
 
 	        .banner-item a {
 	            color: var(--dodger-blue);
 	            text-decoration: none;
 	            border-bottom: 1px solid color-mix(in srgb, var(--dodger-blue) 28%, transparent);
 	            transition: border-color 0.2s ease, color 0.2s ease;
 	        }

 	        .banner-item a:visited {
 	            color: var(--dodger-blue);
 	        }
 
 	        .banner-item a:hover {
 	            border-bottom-color: color-mix(in srgb, var(--dodger-blue) 60%, transparent);
 	        }

        .banner-item:not(:last-child)::after {
            content: '|';
            position: absolute;
            right: -1px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0.3;
            font-weight: 300;
        }

        .banner-icon {
            margin-right: 6px;
            font-size: 0.875rem;
            opacity: 0.8;
            animation: pulse-icon 2s ease-in-out infinite;
        }

        @keyframes pulse-icon {

            0%,
            100% {
                opacity: 0.8;
            }

            50% {
                opacity: 1;
            }
        }

        .banner-close {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            padding: 4px 6px;
            border-radius: 50%;
            font-size: 0.625rem;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            z-index: 10;
        }

        .banner-close {
            background: rgba(31, 60, 255, 0.1);
            border: 1px solid rgba(31, 60, 255, 0.2);
            color: var(--brand-blue);
        }

        .banner-close:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-50%) scale(1.1);
        }

        .banner-close:hover {
            background: rgba(31, 60, 255, 0.2);
            border-color: rgba(31, 60, 255, 0.3);
        }

         
        body.has-banner .app-container {
            padding-top: 36px;
        }

        body.has-banner .mobile-header {
            top: 36px;
        }

         
	        :root {
	            color-scheme: light;

	             
	            --brand-blue: #1F3CFF;  
	            --brand-blue-dark: #001DE1;
	            --brand-blue-light: #5268FF;
	            --brand-red: #00CCFF;  
	            --dodger-blue: #1E90FF;
	            --brand-blue-tint: var(--dodger-blue);
	            --brand-red-tint: color-mix(in srgb, var(--brand-red) 58%, #ffffff 42%);
	            --tile-bg:
	            radial-gradient(140% 140% at 18% 0%,
	            rgba(0, 204, 255, 0.09) 0%,
	            rgba(0, 204, 255, 0.03) 55%,
	            rgba(30, 144, 255, 0.02) 100%),
	            linear-gradient(135deg, rgba(0, 204, 255, 0.055), rgba(30, 144, 255, 0.040));
	            --tile-bg-muted:
	            radial-gradient(140% 140% at 18% 0%,
	            rgba(0, 204, 255, 0.072) 0%,
	            rgba(0, 204, 255, 0.024) 55%,
	            rgba(30, 144, 255, 0.016) 100%),
	            linear-gradient(135deg, rgba(0, 204, 255, 0.044), rgba(30, 144, 255, 0.032));
	            --skyline-image: url('https://storage.googleapis.com/resourcesite-publicassets-prod/townskyline.svg');
	            --skyline-opacity: 0.135;
	            --skyline-height: clamp(365px, 39.4vh, 788px);
	            --skyline-scale: 220%;

             
            --primary: var(--brand-blue);
            --primary-dark: var(--brand-blue-dark);
            --primary-light: var(--brand-blue-light);
            --primary-glow: rgba(31, 60, 255, 0.08);
            --primary-glow-intense: rgba(31, 60, 255, 0.15);
            --primary-subtle: rgba(31, 60, 255, 0.04);

            --accent-warm: #1A202C;
            --accent-warm-glow: rgba(26, 32, 44, 0.04);
            --text-cream: #1A202C;

             
            --bg-base: #FAFBFC;
             
            --bg-surface: #FFFFFF;
             
            --bg-elevated: #FFFFFF;
             
            --bg-overlay: #FFFFFF;
             
            --bg-sidebar: #FFFFFF;

             
            --text-primary: #1A202C;
             
            --text-secondary: #4A5568;
             
            --text-muted: #718096;
             
            --text-disabled: #A0AEC0;
             

             
            --border-color: rgba(0, 0, 0, 0.06);
            --glow-subtle: rgba(31, 60, 255, 0.02);
            --glow-default: rgba(31, 60, 255, 0.04);
            --glow-strong: rgba(31, 60, 255, 0.08);

            --success: #10b981;
            --warning: #f59e0b;
            --error: var(--brand-red);

             
            --space-1: 0.25rem;
             
            --space-2: 0.5rem;
             
            --space-3: 0.75rem;
             
            --space-4: 1rem;
             
            --space-5: 1.25rem;
             
            --space-6: 1.5rem;
             
            --space-8: 2rem;
             
            --space-10: 2.5rem;
             
            --space-12: 3rem;
             
            --space-16: 4rem;
             

             
            --sidebar-width: 320px;
            --max-content-width: 1600px;

             
            --radius-sm: 0.375rem;
             
            --radius-md: 0.5rem;
             
            --radius-lg: 0.75rem;
             
            --radius-xl: 1rem;
             
            --radius-squircle: 12px;
             

             
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition: 180ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 280ms cubic-bezier(0.4, 0, 0.2, 1);

             
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.08);
            --shadow-xl: 0 20px 60px rgba(0, 0, 0, 0.12);

             
            --shadow-card:
                0 0 0 1px rgba(15, 23, 42, 0.03),
                0 1px 3px rgba(15, 23, 42, 0.06),
                0 8px 30px rgba(15, 23, 42, 0.04);
            --shadow-card-hover:
                0 0 0 1px rgba(15, 23, 42, 0.03),
                0 1px 3px rgba(15, 23, 42, 0.06),
                0 20px 40px rgba(15, 23, 42, 0.08);
            --card-radius: 0.875rem;
            --card-border: rgba(15, 23, 42, 0.06);
            --divider-color: rgba(15, 23, 42, 0.08);

             
            --surface-glass: rgba(255, 255, 255, 0.85);
            --glass-blur: blur(12px);
        }

         
        body {
            font-family: 'Google Sans Flex', 'Google Sans', 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-optical-sizing: auto;
            background: var(--bg-base);
            color: var(--text-primary);
            line-height: 1.65;
            font-size: 15px;
             
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-feature-settings: 'tnum' 1, 'liga' 1;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-feature-settings: 'tnum' 1, 'liga' 1;
            font-variation-settings: 'opsz' 16;
            letter-spacing: -0.011em;
        }

        button,
        input,
        select,
        textarea {
            font-family: inherit;
            font-weight: inherit;
            letter-spacing: inherit;
        }

         
         
        .flex {
            display: flex;
        }

        .flex-col {
            flex-direction: column;
        }

        .flex-center {
            align-items: center;
            justify-content: center;
        }

        .flex-between {
            justify-content: space-between;
        }

        .flex-gap-2 {
            gap: var(--space-2);
        }

        .flex-gap-3 {
            gap: var(--space-3);
        }

        .flex-gap-4 {
            gap: var(--space-4);
        }

         
        .interactive {
            cursor: pointer;
            transition: all var(--transition);
        }

        .interactive:hover {
            transform: translateY(-1px);
        }

         
        .btn {
            padding: var(--space-2) var(--space-4);
            background: linear-gradient(180deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: var(--radius-squircle);
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition);
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            box-shadow: 0 4px 16px var(--primary-glow);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--primary-glow-intense);
            filter: brightness(1.05);
        }

        .btn:active {
            transform: translateY(0);
        }

         
        .primary-action {
            position: relative;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 9px 24px;
            border-radius: 999px;
            font-weight: 500;
            font-size: 0.95rem;
            text-decoration: none;
            color: #F9FBFF;
            background: linear-gradient(135deg,
                    color-mix(in srgb, var(--brand-blue) 82%, #ffffff 18%) 0%,
                    color-mix(in srgb, var(--brand-blue-light) 65%, var(--brand-red) 35%) 52%,
                    color-mix(in srgb, var(--brand-red) 55%, #ffffff 45%) 100%);
            border: 1px solid rgba(255, 255, 255, 0.28);
            box-shadow: 0 8px 20px rgba(31, 60, 255, 0.2);
            cursor: pointer;
            white-space: nowrap;
            isolation: isolate;
            z-index: 0;
            transition: transform var(--transition),
                box-shadow var(--transition),
                background-position var(--transition),
                opacity var(--transition);
            background-size: 160% 160%;
            background-position: 0% 50%;
            overflow: hidden;
        }

        .primary-action::after {
            content: '';
            position: absolute;
            inset: 2px;
            border-radius: inherit;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.32), rgba(255, 255, 255, 0));
            opacity: 0.85;
            transition: opacity var(--transition);
            pointer-events: none;
            z-index: -1;
        }

        .primary-action i {
            color: inherit;
            font-size: 1rem;
        }

        .primary-action:hover {
            box-shadow: 0 12px 20px rgba(31, 60, 255, 0.2);
            background-position: 100% 50%;
            color: #F9FBFF;
            transform: none;
        }

        .primary-action:hover::after {
            opacity: 1;
        }

        .primary-action:focus-visible {
            outline: 3px solid rgba(255, 255, 255, 0.35);
            outline-offset: 2px;
        }

        .primary-action.stripe {
            background: linear-gradient(135deg, var(--brand-red-tint), var(--brand-blue-tint));
            color: #ffffff;
            border: 1px solid color-mix(in srgb, var(--brand-blue) 30%, #ffffff 70%);
            box-shadow: 0 6px 14px rgba(31, 60, 255, 0.18);
            overflow: hidden;
            transition: box-shadow var(--transition);
        }

        .primary-action.stripe::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            background: #060606;
            opacity: 0;
            transition: opacity 160ms cubic-bezier(0.215, 0.61, 0.355, 1);
            z-index: -1;
        }

        .primary-action.stripe::after {
            opacity: 0.1;
        }

        .primary-action.stripe span,
        .primary-action.stripe svg {
            position: relative;
            z-index: 1;
        }

        .primary-action.stripe .hover-arrow {
            --arrowSpacing: 6px;
            --arrowHoverTransition: 160ms cubic-bezier(0.215, 0.61, 0.355, 1);
            --arrowHoverOffset: translateX(2px);
            stroke: currentColor;
            stroke-width: 2px;
            fill: none;
            width: 20px;
            height: 12px;
            margin-left: var(--arrowSpacing);
            overflow: visible;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .primary-action.stripe .hover-arrow__line {
            opacity: 0;
            transition: opacity var(--arrowHoverTransition);
        }

        .primary-action.stripe .hover-arrow__tip {
            transition: transform var(--arrowHoverTransition);
        }

        .primary-action.stripe:hover {
            box-shadow: 0 8px 16px rgba(13, 28, 63, 0.2);
        }

        .primary-action.stripe:hover::before {
            opacity: 1;
        }

        .primary-action.stripe:hover::after {
            opacity: 0.02;
        }

        .primary-action.stripe:hover .hover-arrow__line {
            opacity: 1;
        }

        .primary-action.stripe:hover .hover-arrow__tip {
            transform: var(--arrowHoverOffset);
        }

        .primary-action:focus-visible {
            outline: 3px solid rgba(255, 255, 255, 0.35);
            outline-offset: 2px;
        }

        .primary-action--small {
            padding: 6px 18px;
            font-size: 0.86rem;
        }

        .primary-action--compact {
            padding: 6px 16px;
            font-size: 0.82rem;
        }

        .primary-action--uppercase {
            text-transform: none;
            letter-spacing: normal;
            font-size: 0.85rem;
        }

        .primary-action--block {
            width: 100%;
            justify-content: center;
        }

         
        .icon-gradient {
            background: linear-gradient(180deg, var(--brand-red-tint), var(--brand-blue-tint));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 0 4px var(--primary-glow));
        }

         
        .text-muted {
            color: var(--text-muted);
        }

        .text-secondary {
            color: var(--text-secondary);
        }

        .text-cream {
            color: var(--text-cream);
        }

        .text-sm {
            font-size: 0.875rem;
        }

        .text-xs {
            font-size: 0.75rem;
        }

        .text-bold {
            font-weight: 500;
        }

        .text-upper {
            text-transform: none;
            letter-spacing: normal;
        }

         
        ::selection {
            background: color-mix(in srgb, var(--brand-blue) 70%, #ffffff 30%);
            color: var(--text-cream);
        }

         
        body::after {
            content: '';
            position: fixed;
            inset: -10% -10% -30% -10%;
            pointer-events: none;
            background:
                radial-gradient(600px 420px at 10% 8%, rgba(0, 204, 255, .05), transparent 60%),
                radial-gradient(520px 360px at 92% 12%, rgba(31, 60, 255, .035), transparent 60%);
            filter: blur(26px);
            opacity: .35;
            z-index: 0;
        }

         
	        .app-container {
	            display: flex;
	            min-height: 100vh;
	            position: relative;
	        }


         
        .sidebar {
            background: rgba(255, 255, 255, 0.88);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            padding: var(--space-6);
            padding-bottom: 100px;
             
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: var(--space-6);
            position: fixed;
             
            top: 0;
            left: 0;
            height: 100vh;
            width: var(--sidebar-width);
            flex-shrink: 0;
            box-shadow: 2px 0 18px rgba(15, 23, 42, 0.06);
            border-right: 1px solid rgba(15, 23, 42, 0.06);
        }

         
        .sidebar-logo {
            display: flex;
            align-items: center;
            padding: calc(var(--space-6) + 16px) 0 var(--space-4) 0;
            margin-bottom: var(--space-2);
            position: relative;
        }

        .sidebar-logo-wrapper {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

		        .sidebar-logo-img {
		            width: 62px;
		            height: 62px;
		            opacity: 0.95;
		            transition: all 0.3s ease;
		        }

		        .hub-logo-svg {
		            fill: url(#hubLogoGradient);
		        }

        .sidebar-logo-text {
            font-size: 1.75rem;
            font-weight: 500;
            letter-spacing: -0.02em;
            color: #101010;
            font-family: 'Google Sans Flex', 'Google Sans', 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }

        .sidebar-logo::after {
            display: none;
        }

        .sidebar-logo:hover .sidebar-logo-img {
            opacity: 1;
            transform: scale(1.05);
        }

        .sidebar-logo::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg,
                    transparent,
                    var(--glow-default) 20%,
                    var(--glow-default) 80%,
                    transparent);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            position: relative;
        }

         
        .logo-icon {
            font-size: 2rem;
            color: var(--text-cream);
            opacity: 0.9;
            filter: drop-shadow(0 0 20px var(--accent-warm-glow));
        }

        .logo-text-wrapper {
            display: flex;
            flex-direction: column;
            line-height: 1;
        }

        .logo-text-the {
            font-family: 'Google Sans Flex', 'Google Sans', 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-size: 0.625rem;
            font-weight: 400;
            letter-spacing: 0.25em;
            color: var(--text-cream);
            opacity: 0.85;
            text-transform: uppercase;
            margin-bottom: 6px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
            transition: opacity 0.3s ease;
        }

        .logo-text-main {
            font-family: 'Google Sans Flex', 'Google Sans', 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-size: 1.5rem;
            font-weight: 400;
            letter-spacing: 0.02em;
            color: var(--text-cream);
            text-transform: uppercase;
            position: relative;
            text-shadow: 0 2px 8px rgba(31, 60, 255, 0.25), 0 2px 12px rgba(0, 204, 255, 0.12);
            transition: all 0.3s ease;
        }

        .logo-text-main::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: -10%;
            right: -10%;
            height: 2px;
            background: linear-gradient(90deg, transparent 0%, var(--brand-red) 20%, var(--brand-blue) 80%, transparent 100%);
            opacity: 0.6;
            filter: blur(1px);
            transition: opacity 0.3s ease;
        }

        .sidebar-logo:hover .logo-text-the {
            opacity: 1;
        }

        .sidebar-logo:hover .logo-text-main {
            transform: scale(1.02);
        }

        .sidebar-logo:hover .logo-text-main::after {
            opacity: 0.9;
        }


         
        .nav-section {
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
            padding-top: var(--space-6);
            height: 100%;
            min-height: 0;
            overflow-y: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .nav-section::-webkit-scrollbar {
            width: 0;
            height: 0;
        }

         
        .nav-scroll-container {
            position: relative;
            flex: 1 1 auto;
            min-height: 0;
        }

        .nav-scrollbar {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            width: 12px;
            opacity: 0;
            pointer-events: none;
            transition: opacity var(--transition-fast);
            z-index: 2;
        }

        .nav-scrollbar::before {
            content: '';
            position: absolute;
            top: 6px;
            bottom: 6px;
            right: 3px;
            width: 6px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.06);
        }

        .nav-scrollbar-thumb {
            position: absolute;
            top: 6px;
            right: 3px;
            width: 6px;
            height: 44px;
            border-radius: 999px;
            background: linear-gradient(180deg, rgba(31, 60, 255, 0.35), rgba(0, 204, 255, 0.35));
            transform: translateY(0);
            will-change: transform, height;
        }

        .sidebar:hover .nav-scroll-container.nav-scrollable .nav-scrollbar,
        .nav-scroll-container.nav-scrollable:focus-within .nav-scrollbar {
            opacity: 1;
        }

        .nav-section-title {
            font-size: 0.75rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-cream);
            opacity: 0.6;
            padding: var(--space-2) var(--space-3);
            margin-bottom: var(--space-1);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3) var(--space-3);
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            text-decoration: none;
            transition: all var(--transition);
            position: relative;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
        }

        .nav-item:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
            transform: translateX(1px);
        }

        .nav-item.active {
            background: var(--bg-elevated);
            color: var(--text-primary);
            box-shadow: none;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%) scaleY(0);
            transform-origin: center;
            width: 3px;
            height: 60%;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 0 3px 3px 0;
            box-shadow: none;
            opacity: 0;
            transition: transform var(--transition), opacity var(--transition);
        }

        .nav-item.active::before {
            opacity: 1;
            transform: translateY(-50%) scaleY(1);
        }

        .nav-icon {
            width: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .nav-badge {
            position: relative;
            margin-left: auto;
            padding: 2px 8px;
            min-width: 22px;
            text-align: center;
            border-radius: 999px;
             
            font-size: 0.625rem;
            font-weight: 500;
            color: var(--text-cream);
            background: linear-gradient(180deg, var(--brand-red-tint), var(--brand-blue-tint));
            border: 1px solid rgba(255, 255, 255, 0.12);
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.18),
                0 4px 18px var(--primary-glow);
            backdrop-filter: saturate(140%) blur(4px);
            -webkit-backdrop-filter: saturate(140%) blur(4px);
            overflow: hidden;
        }

        .nav-badge::after {
            content: '';
            position: absolute;
            top: -2px;
            bottom: -2px;
            left: -30%;
            right: -30%;
            background: linear-gradient(120deg, transparent, rgba(255, 255, 255, .35), transparent);
            transform: translateX(-120%);
            transition: transform 600ms cubic-bezier(.16, 1, .3, 1);
            pointer-events: none;
        }

        .nav-item:hover .nav-badge {
            transform: translateY(-1px);
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 8px 24px var(--primary-glow);
        }

        .nav-item:hover .nav-badge::after {
            transform: translateX(120%);
        }

         
        .view-controls {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
            padding: 0 var(--space-3);
        }

        .view-toggle {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-size: 0.875rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: color var(--transition);
        }

        .view-toggle:hover {
            color: var(--text-primary);
        }

        .view-toggle input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: var(--primary);
            cursor: pointer;
        }

         
        .sidebar-stats {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
            padding: 0 var(--space-3);
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
        }

        .stat-label {
            color: var(--text-secondary);
        }

        .stat-value {
            font-weight: 500;
            color: var(--text-cream);
            background: var(--primary);
            padding: 2px 8px;
            border-radius: var(--radius-sm);
            min-width: 28px;
            text-align: center;
            box-shadow: 0 0 8px var(--primary-glow);
        }

         
        .sidebar-action-btn {
            width: 100%;
            padding: var(--space-3) var(--space-4);
            margin-bottom: var(--space-2);
            background: var(--bg-elevated);
            border: none;
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition);
            display: flex;
            align-items: center;
            gap: var(--space-2);
            box-shadow: var(--shadow-glow),
                inset 0 1px 0 var(--glow-subtle);
        }

        .sidebar-action-btn:hover {
            background: var(--bg-overlay);
            color: var(--text-cream);
            transform: translateY(-1px);
            box-shadow: 0 0 24px var(--primary-glow), var(--shadow-depth), inset 0 1px 0 var(--glow-default);
        }

        .sidebar-action-btn:active {
            transform: translateY(0);
            filter: brightness(0.98);
        }

        .sidebar-action-btn i {
            font-size: 0.875rem;
        }

	         
	        .main-content {
	            padding: var(--space-10) var(--space-12);
	             
	            background: transparent;
	            position: relative;
	            flex: 1;
	            margin-left: var(--sidebar-width);
	             
	        }

	        html.is-embedded .main-content {
	        
	        }

	        html.is-embedded .main-content::-webkit-scrollbar {
	        
	        }

         
        .greeting-header {
            max-width: 1600px;
            margin: 0 auto;
            padding-top: var(--space-8);
            padding-bottom: var(--space-4);
            position: relative;
            z-index: 1;
        }

        .greeting-header::before {
            content: '';
            position: absolute;
            left: -40px;
            right: -40px;
            top: -20px;
            height: 180px;
            background:
                radial-gradient(460px 160px at 18% 38%, rgba(0, 204, 255, 0.12), transparent 62%),
                radial-gradient(420px 140px at 84% 8%, rgba(31, 60, 255, 0.08), transparent 62%);
            filter: blur(14px);
            opacity: .38;
            -webkit-mask-image: linear-gradient(to bottom, transparent 0, #000 24%, #000 76%, transparent 100%);
            mask-image: linear-gradient(to bottom, transparent 0, #000 24%, #000 76%, transparent 100%);
            pointer-events: none;
            z-index: 0;
        }

        .greeting-text {
            font-family: 'Google Sans Flex', 'Google Sans', 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-size: 2.15rem;
            font-weight: 500;
            color: var(--text-cream);
            letter-spacing: -0.02em;
            margin-bottom: var(--space-2);
        }

        .greeting-good {
            color: var(--text-cream);
        }

        .greeting-good {
            color: #101010;
        }

	        .greeting-time {
	            color: var(--dodger-blue);
	            font-weight: 600;
	            letter-spacing: -0.02em;
	            position: relative;
	            display: inline-block;
	            background: none;
	            -webkit-background-clip: initial;
	            background-clip: initial;
	            animation: none;
	            filter: none;
	        }

        @keyframes shiftGradient {

            0%,
            100% {
                background-position: 50% 0%;
            }

            50% {
                background-position: 50% 100%;
            }
        }

        @media (max-width: 1024px) {
            .greeting-header::before {
                opacity: .24;
                filter: blur(10px);
            }
        }

         
        .greeting-header::before {
            display: none;
        }

        .greeting-comma {
            color: var(--primary);
            margin: 0 0.25rem;
        }

        .greeting-name {
            color: var(--primary);
        }

        .greeting-date {
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: var(--space-4);
            background: linear-gradient(135deg,
                    var(--brand-red-tint) 0%,
                    var(--brand-blue-tint) 50%,
                    var(--brand-red-tint) 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            animation: shiftGradient 8s ease-in-out infinite;
        }

         
        .daily-quote-line {
            font-size: 0.85rem;
            font-style: italic;
            margin-top: var(--space-2);
            margin-bottom: var(--space-6);
            text-align: left;
            color: #101010;
            -webkit-background-clip: initial;
            background-clip: initial;
            -webkit-text-fill-color: initial;
            filter: none;
        }

        .quote-author {
            font-style: normal;
            margin-left: var(--space-2);
            color: #101010;
            -webkit-background-clip: initial;
            background-clip: initial;
            -webkit-text-fill-color: initial;
        }

         
        .metrics-band {
            max-width: 1600px;
            margin: 0 auto var(--space-6) auto;
            padding: var(--space-4) 0;
            position: relative;
        }

        .metrics-band::after {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(0, 204, 255, .16) 20%, rgba(31, 60, 255, .16) 80%, transparent);
            transform: scaleY(.5);
            transform-origin: bottom;
        }

         
        .progress-container {
            display: flex;
            flex-direction: column;
            gap: clamp(var(--space-3), 4vw, var(--space-4));
        }

        .progress-item {
            flex: 1;
        }

        .progress-title {
            font-weight: 500;
            color: var(--text-cream);
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
        }

        .progress-label {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            align-items: center;
            margin-bottom: var(--space-2);
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .progress-label>span:first-child {
            font-weight: 500;
            color: var(--text-cream);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            text-align: left;
        }

        .progress-dates {
            font-size: 0.625rem;
            color: var(--text-muted);
            text-align: center;
        }

        .progress-percent {
            font-weight: 500;
            background: linear-gradient(180deg, var(--brand-red-tint), var(--brand-blue-tint));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-align: right;
        }

        .progress-bar {
            height: 8px;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.08));
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
             
            position: relative;
            box-shadow: var(--shadow-glow);
        }

        .progress-bar {
            background: linear-gradient(180deg, rgba(0, 0, 0, 0.12), rgba(0, 0, 0, 0.06));
            border: 1px solid rgba(0, 0, 0, 0.15);
        }

        .progress-fill {
            height: 100%;
            width: 0;
             
            background: linear-gradient(90deg, var(--brand-red-tint), var(--brand-blue-tint));
            border-radius: 3px;
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            box-shadow: 0 0 10px var(--accent-warm-glow);
        }

         
        .progress-fill::before {
            content: '';
            position: absolute;
            right: -6px;
            top: -6px;
            bottom: -6px;
            width: var(--glow-size, 42px);
            background: radial-gradient(closest-side at right center,
                    color-mix(in srgb, var(--brand-red) 40%, #ffffff 60%) 0%,
                    transparent 70%);
            filter: blur(var(--glow-blur, 6px));
            opacity: var(--glow-opacity, .26);
            pointer-events: none;
        }

         
        .progress-fill.glint::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, .18), transparent);
            transform: translateX(-100%);
            animation: glint 800ms cubic-bezier(.16, 1, .3, 1) 1;
            pointer-events: none;
        }

        @keyframes glint {
            to {
                transform: translateX(100%);
            }
        }

         
        .markers {
            position: absolute;
            inset: 0;
            pointer-events: none;
        }

        .markers span {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 1px;
            background: rgba(255, 255, 255, 0.16);
            transform: scaleY(0.6);
        }

        .progress-item.fiscal .markers span {
            transform: scaleY(0.8);
            background: rgba(255, 255, 255, 0.18);
        }

        .progress-item.awards .month-markers span:nth-child(3n) {
            transform: scaleY(0.9);
            background: rgba(255, 255, 255, 0.22);
        }

        .progress-item.outside-sales .month-markers span:nth-child(3n) {
            transform: scaleY(0.85);
            background: rgba(255, 255, 255, 0.20);
        }

        .quarter-marker {
            position: absolute;
            top: -2px;
            width: 1px;
            height: 10px;
            background: var(--text-muted);
            opacity: 0.3;
        }

        .quarter-labels {
            display: flex;
            justify-content: space-between;
            margin-top: var(--space-1);
            padding: 0 12.5%;
        }

        .quarter-label {
            font-size: 0.625rem;
            color: var(--text-muted);
            font-weight: 500;
            opacity: 0.7;
        }

         
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: var(--space-8);
            width: 100%;
            max-width: 1600px;
            margin: 0 auto;
            padding: 0;
            box-sizing: border-box;
        }

         
        .card {
            background: var(--bg-surface);
            border-radius: var(--card-radius);
            overflow: hidden;
            position: relative;
            transition: transform var(--transition-slow), box-shadow var(--transition-slow);
            box-shadow: var(--shadow-card);
            border: 1px solid var(--card-border);
        }

        .card::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            pointer-events: none;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 0;
            background: linear-gradient(90deg, var(--brand-red), var(--brand-blue));
            opacity: 0;
            transition: opacity var(--transition);
        }

         
        .card.primary::before {
            height: 3px;
            opacity: 1;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-card-hover);
        }

        .card.primary:hover::before {
            opacity: 1;
        }

	        :where(.shortcut-item,
	            .resource-card,
	            .knowledge-card,
	            .department-card,
	            .team-member-card,
	            .drive-embed-card) {
	            background: var(--tile-bg), var(--bg-surface);
	            border-radius: var(--card-radius);
	            border: 1px solid var(--card-border);
	            box-shadow: var(--shadow-card);
	        }

        .card-header {
            padding: var(--space-5) var(--space-6);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            background: linear-gradient(180deg, var(--bg-elevated) 0%, var(--bg-surface) 100%);
            z-index: 2;
             
            overflow: hidden;
             
        }

         

         
        .archive-btn {
            padding: var(--space-2) var(--space-3);
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .archive-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px var(--primary-glow);
        }

        .archive-btn:active {
            transform: translateY(0);
        }

        .archive-btn i {
            font-size: 0.875rem;
        }

        .card-header::before {
            content: none !important;
        }

         
        .card-header.looker-header {
            flex-direction: column;
            align-items: stretch;
            gap: var(--space-3);
        }

        .card-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: var(--space-6);
            right: var(--space-6);
            height: 1px;
            background: var(--divider-color);
            opacity: 0.65;
        }

        .card-header--with-desc {
            flex-direction: column;
            align-items: flex-start;
            gap: var(--space-2);
        }

        .card-header--with-desc .card-description {
            margin: 0;
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            max-width: 720px;
            text-align: left;
        }

        .card-title {
            font-size: 1.15rem;
            font-weight: 500;
            color: var(--text-cream);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .card-title i {
            color: var(--primary);
            font-size: 1.125rem;
            opacity: 0.9;
        }

        .card-actions {
            display: flex;
            gap: var(--space-2);
        }

        .card-action {
            padding: 6px 10px;
            background: linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, .02));
            border: 1px solid rgba(255, 255, 255, .12);
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: var(--radius-squircle);
            transition: all var(--transition);
            backdrop-filter: saturate(140%) blur(3px);
            -webkit-backdrop-filter: saturate(140%) blur(3px);
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, .18);
        }

        .card-action:hover {
            color: var(--text-cream);
            background: linear-gradient(180deg, rgba(255, 255, 255, .14), rgba(255, 255, 255, .05));
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, .22), 0 6px 20px var(--primary-glow);
            transform: translateY(-1px);
        }

        .card-action:active {
            transform: translateY(0);
            filter: brightness(.98);
        }

        .card-body {
            padding: var(--space-6);
        }

         
        .embed-frame {
            position: relative;
            border-radius: var(--radius-squircle);
            overflow: hidden;
            background: linear-gradient(180deg, var(--bg-elevated), var(--bg-surface));
            box-shadow: var(--shadow-glow), inset 0 1px 0 var(--glow-subtle);
            z-index: 1;
            border: 1px solid var(--glow-default);
        }

        .embed-frame::after {
            content: '';
            position: absolute;
            inset: 0;
            pointer-events: none;
            background:
                 
                linear-gradient(180deg, rgba(255, 255, 255, .08), rgba(255, 255, 255, 0)) top/100% 20px no-repeat,
                 
                radial-gradient(120% 100% at 50% 100%, rgba(0, 0, 0, .28), transparent 70%),
                 
                radial-gradient(120% 120% at 0% 0%, rgba(255, 255, 255, .05), transparent 40%);
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, .05), inset 0 0 0 1px rgba(255, 255, 255, .04);
        }

        .embed-frame::before {
            content: '';
            position: absolute;
            inset: 0;
            pointer-events: none;
            background: radial-gradient(120% 80% at 10% 0%, rgba(0, 204, 255, 0.15), transparent 60%);
        }

        .embed-iframe {
            width: 100%;
            height: 340px;
            border: 0;
            display: block;
            background: var(--bg-surface);
        }

         
        .looker-frame .embed-iframe {
            transition: filter 0.3s ease;
            filter: grayscale(1) saturate(0.85);
        }

        .looker-frame iframe {
            filter: grayscale(1) saturate(0.85);
            transition: filter 0.3s ease;
        }

        .embed-loader {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(180deg, var(--bg-elevated), var(--bg-surface));
            pointer-events: none;
        }

        .embed-loader .skeleton {
            width: 92%;
            height: 80%;
            border-radius: var(--radius-squircle);
            box-shadow: inset 0 1px 0 var(--glow-subtle);
        }

         
        .shortcut-item,
        .department-card,
        .event-item,
        .department-btn,
        .event-btn,
        .sidebar-action-btn,
        .nav-item,
        .looker-select,
        .looker-dd-btn,
        .looker-dd-menu,

         
        .nav-item .nav-icon i,
        .card-title i,
        .shortcut-icon i,
        .department-icon i {
            background: linear-gradient(180deg, var(--brand-red-tint), var(--brand-blue-tint));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 0 4px var(--primary-glow));
        }

        .nav-item:hover .nav-icon i,
        .shortcut-item:hover .shortcut-icon i,
        .department-card:hover .department-icon i {
            filter: drop-shadow(0 0 8px var(--primary-glow));
        }

        .sidebar .nav-item span:not(.nav-icon) {
            color: var(--text-secondary);
            background: none;
            -webkit-background-clip: initial;
            background-clip: initial;
            -webkit-text-fill-color: initial;
            transition: color var(--transition);
        }

        .sidebar .nav-item:hover span:not(.nav-icon),
        .sidebar .nav-item.active span:not(.nav-icon) {
            color: var(--text-primary);
        }

        .embed-actions {
            display: flex;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-1) 0 var(--space-1);
            justify-content: flex-end;
        }

        .embed-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            white-space: nowrap;
        }

        .embed-btn.looker-open-full {
            white-space: nowrap;
        }

         

         
        .looker-controls {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            flex-wrap: wrap;
            width: 100%;
            position: relative;
            z-index: 5;
             
        }

        .looker-select {
            appearance: none;
            background: var(--bg-overlay);
            color: var(--text-secondary);
            border: 1px solid var(--glow-default);
            border-radius: var(--radius-sm);
            font-size: 0.8rem;
            padding: 6px 10px;
            flex: 1 1 auto;
            min-width: 150px;
            max-width: 260px;
            transition: all var(--transition);
            cursor: pointer;
            line-height: 1.2;
            position: relative;
            z-index: 6;
        }

        .looker-select:hover {
            color: var(--text-primary);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-subtle);
        }

        .looker-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-subtle);
        }

         
        .looker-select,
        .looker-select option {
            color: var(--text-cream);
            background: var(--bg-overlay);
        }

         
        .looker-dd {
            position: relative;
            z-index: 8;
        }

        .looker-dd-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-overlay);
            color: var(--text-secondary);
            border: 1px solid var(--glow-default);
            border-radius: var(--radius-sm);
            padding: 6px 10px;
            cursor: pointer;
            font-size: 0.8rem;
            min-width: 260px;
            max-width: 100%;
            transition: all var(--transition);
        }

        .looker-dd-btn:hover,
        .looker-dd-btn[aria-expanded="true"] {
            color: var(--text-primary);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-subtle);
        }

        .looker-dd-menu {
            position: absolute;
            top: calc(100% + 6px);
            left: 0;
            right: auto;
            min-width: 300px;
            max-width: min(520px, 90vw);
            max-height: 50vh;
            overflow: auto;
            background: var(--bg-elevated);
            border: 1px solid var(--glow-default);
            border-radius: var(--radius-sm);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6);
            padding: 8px;
            display: none;
            z-index: 10000;
        }

         
        .looker-dd-btn,
        .looker-dd-menu,
        .looker-dd-item {
            color: var(--text-cream);
        }

        .looker-dd-item {
            background: transparent;
        }

        .looker-dd.open .looker-dd-menu {
            display: block;
        }

        .looker-dd-group {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-muted);
            margin: 6px 4px;
        }

        .looker-dd-item {
            width: 100%;
            text-align: left;
            background: transparent;
            color: var(--text-secondary);
            border: 0;
            padding: 6px 8px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .looker-dd-item:hover {
            background: var(--bg-overlay);
            color: var(--text-primary);
        }

         
        .embed-fallback {
            position: absolute;
            inset: 6px;
            border-radius: var(--radius-md);
            display: none;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            background: linear-gradient(180deg, var(--bg-elevated), var(--bg-surface));
            border: 1px dashed var(--glow-default);
            z-index: 2;
            text-align: center;
            padding: 12px;
        }

        .embed-fallback a {
            color: var(--primary);
            text-decoration: underline;
        }

         
        .span-3 {
            grid-column: span 3;
        }

        .span-4 {
            grid-column: span 4;
        }

        .span-5 {
            grid-column: span 5;
        }

        .span-6 {
            grid-column: span 6;
        }

        .span-7 {
            grid-column: span 7;
        }

        .span-8 {
            grid-column: span 8;
        }

        .span-9 {
            grid-column: span 9;
        }

        .span-12 {
            grid-column: span 12;
        }

         
        @keyframes skeleton-pulse {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.4;
            }

            100% {
                opacity: 1;
            }
        }

        .skeleton {
            background: linear-gradient(90deg,
                    var(--bg-overlay) 25%,
                    var(--bg-elevated) 50%,
                    var(--bg-overlay) 75%);
            background-size: 200% 100%;
            animation: skeleton-pulse 1.5s ease-in-out infinite;
            border-radius: var(--radius-sm);
        }

        .skeleton-event {
            height: 80px;
            margin-bottom: var(--space-3);
        }

        .skeleton-news {
            height: 60px;
            margin-bottom: var(--space-2);
        }

        .skeleton-text {
            height: 16px;
            width: 60%;
            margin-bottom: var(--space-2);
        }

        .skeleton-title {
            height: 20px;
            width: 40%;
            margin-bottom: var(--space-3);
        }

         
        #newsContainer {
            min-height: 320px;
             
            position: relative;
            overflow: visible;
            padding-right: 4px;
             
        }

        .news-items-wrapper {
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            will-change: transform;
        }

        @keyframes slideInFromRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideInFromLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOutToLeft {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(-100%);
                opacity: 0;
            }
        }

        @keyframes slideOutToRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        .slide-in-right {
            animation: slideInFromRight 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        .slide-in-left {
            animation: slideInFromLeft 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        .slide-out-left {
            animation: slideOutToLeft 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        .slide-out-right {
            animation: slideOutToRight 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        .news-item {
            padding: var(--space-4);
            transition: all var(--transition);
            cursor: pointer;
            position: relative;
            margin-bottom: var(--space-2);
            border-radius: var(--radius-md);
        }

        .news-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(135deg, var(--brand-red-tint), var(--brand-blue-tint));
            border-radius: var(--radius-md) 0 0 var(--radius-md);
            box-shadow: 0 0 6px rgba(31, 60, 255, .08);
            opacity: 1;
        }

        .news-item::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: var(--space-4);
            right: var(--space-4);
            height: 1px;
            background: linear-gradient(90deg,
                    transparent,
                    var(--glow-subtle) 50%,
                    transparent);
            opacity: 0.5;
        }

        .news-item:last-child::after {
            display: none;
        }

        .news-item:hover {
            background: var(--bg-overlay);
            transform: translateX(2px);
        }

         
        .news-item.pinned {
            background: linear-gradient(135deg, var(--bg-elevated), rgba(31, 60, 255, 0.05));
            border: 1px solid rgba(31, 60, 255, 0.15);
            box-shadow: 0 2px 8px rgba(31, 60, 255, 0.1);
        }

        .news-item.pinned {
            background: linear-gradient(135deg, var(--bg-elevated), rgba(31, 60, 255, 0.02));
            border: 1px solid rgba(31, 60, 255, 0.12);
        }

        .pin-indicator {
            position: absolute;
            top: var(--space-3);
            right: var(--space-3);
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 4px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .pin-indicator span {
            background: linear-gradient(135deg, var(--brand-red-tint), var(--brand-blue-tint));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .pin-indicator span {
            color: var(--brand-blue);
            background: none;
            -webkit-background-clip: unset;
            background-clip: unset;
        }

        .pin-indicator i {
            transform: rotate(45deg);
            font-size: 0.875rem;
            background: linear-gradient(135deg, var(--brand-red-tint), var(--brand-blue-tint));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .pin-indicator i {
            color: var(--brand-blue);
            background: none;
            -webkit-background-clip: unset;
            background-clip: unset;
        }

        .news-item.skeleton:hover {
            background: var(--bg-card);
            transform: none;
        }

        .news-title {
            font-weight: 500;
            color: var(--text-primary);
            font-size: 0.925rem;
            margin-bottom: var(--space-2);
        }

        .news-meta {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .news-content {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.5;
            margin-bottom: var(--space-3);
        }

         
        .pagination {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            margin-top: var(--space-4);
            padding-top: var(--space-4);
            border-top: 1px solid var(--border-color);
        }

        .pagination-btn {
            padding: var(--space-2) var(--space-3);
            background: var(--bg-elevated);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition);
            font-size: 0.875rem;
        }

        .pagination-btn:hover:not(:disabled) {
            background: var(--bg-overlay);
            color: var(--text-primary);
            border-color: var(--primary);
            box-shadow: 0 0 15px var(--primary-glow);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-btn.active {
            background: var(--primary);
            color: var(--bg-base);
            border-color: var(--primary);
            box-shadow: 0 0 20px var(--primary-glow-intense);
        }

        .pagination-info {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

         
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

         
        .modal-overlay {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px) saturate(150%);
        }

         
        .modal-content {
            background: #ffffff;
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15),
                0 0 100px rgba(0, 0, 0, 0.05);
        }

        .modal-header {
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .modal-close {
            background: rgba(0, 0, 0, 0.05);
            color: #333333;
        }

        .modal-close:hover {
            background: rgba(0, 0, 0, 0.1);
        }

        .modal-overlay.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-6);
        }

        .modal-content {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8),
                0 0 100px var(--primary-glow);
        }

         
        .archive-modal-content {
            max-width: 900px;
        }

        .archive-list {
            padding: var(--space-4);
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }

        .archive-item {
            padding: var(--space-4);
            background: var(--bg-base);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition);
        }

        .archive-item:hover {
            background: var(--bg-elevated);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .archive-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-2);
        }

        .archive-item-title {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text-primary);
            margin: 0;
        }

        .archive-item-date {
            font-size: 0.75rem;
            color: var(--text-muted);
            white-space: nowrap;
        }

        .archive-item-content {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .archive-item-meta {
            display: flex;
            gap: var(--space-3);
            margin-top: var(--space-2);
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .archive-empty {
            padding: var(--space-8);
            text-align: center;
            color: var(--text-muted);
        }

        .archive-empty i {
            font-size: 3rem;
            margin-bottom: var(--space-3);
            opacity: 0.3;
        }

         
        .archive-item {
            background: #f8f9fa;
            border: 1px solid rgba(0, 0, 0, 0.08);
        }

        .archive-item:hover {
            background: #ffffff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .archive-item-title {
            color: #1a1a1a;
        }

        .archive-item-content {
            color: #666666;
        }

        .archive-item-date {
            color: #999999;
        }

        .archive-item-meta {
            color: #999999;
        }

        .modal-header {
            padding: var(--space-6);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .modal-close {
            width: 32px;
            height: 32px;
            background: transparent;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition);
        }

        .modal-close:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
            border-color: var(--primary);
        }

        .modal-body {
            padding: var(--space-6);
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .news-attachments {
            margin-top: var(--space-4);
            border-top: 1px solid var(--border-color);
            padding-top: var(--space-4);
        }

        .news-attachments h4 {
            margin-bottom: var(--space-3);
            font-size: 0.95rem;
            color: var(--text-cream);
        }

        .news-images {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: var(--space-3);
            margin-top: var(--space-2);
        }

        .news-images img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-glow);
        }

        .news-links {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
            margin-top: var(--space-2);
        }

        .news-links a {
            color: var(--text-cream);
            text-decoration: underline;
            word-break: break-word;
        }

        .modal-meta {
            padding: var(--space-4) var(--space-6);
            background: var(--bg-elevated);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: var(--space-4);
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

         

         
        .tile-grid {
            display: grid;
            gap: var(--space-4);
        }

         
        .tile-grid--compact {
             
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        }

        .tile-grid--standard {
             
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }

         
        .shortcuts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: var(--space-4);
        }

         
        .tile {
            background: var(--bg-surface);
            border-radius: var(--card-radius);
            border: 1px solid var(--card-border);
            text-decoration: none;
            color: var(--text-secondary);
            transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-card);
        }

         
        .tile--compact {
             
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            padding: var(--space-5) var(--space-3);
            min-height: 140px;
            text-align: center;
        }

        .tile--standard {
             
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            padding: var(--space-5);
            min-height: 160px;
        }

         
        .shortcut-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            padding: var(--space-4) var(--space-3);
            background: var(--bg-surface);
            border-radius: var(--card-radius);
            border: 1px solid var(--card-border);
            text-decoration: none;
            color: var(--text-secondary);
            transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
            cursor: pointer;
            box-shadow: var(--shadow-card);
            min-height: 120px;
            text-align: center;
        }

         
        .tile:hover,
        .shortcut-item:hover {
            background: var(--bg-surface);
            color: var(--text-primary);
            transform: translateY(-4px);
            border-color: rgba(31, 60, 255, 0.12);
            box-shadow: var(--shadow-card-hover);
        }

        .knowledge-card:hover {
            background: var(--bg-surface);
            color: var(--text-primary);
            transform: translateY(-4px);
            border-color: rgba(31, 60, 255, 0.12);
            box-shadow: var(--shadow-card-hover);
        }

        .tile:active,
        .shortcut-item:active,
        .resource-card:active,
        .knowledge-card:active,
        .department-card:active {
            transform: translateY(-1px);
        }

         
        .tile-icon,
        .shortcut-icon,
        .resource-icon,
        .knowledge-icon,
        .department-icon {
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            color: var(--text-muted);
            transition: all var(--transition);
            flex-shrink: 0;
        }

        .tile:hover .tile-icon,
        .shortcut-item:hover .shortcut-icon,
        .resource-card:hover .resource-icon,
        .knowledge-card:hover .knowledge-icon,
        .department-card:hover .department-icon {
            color: var(--text-cream);
            transform: scale(1.1);
            filter: drop-shadow(0 0 15px var(--accent-warm-glow));
        }

         
        .tile-title,
        .shortcut-label,
        .resource-title,
        .knowledge-title,
        .department-name {
            font-weight: 500;
            color: var(--text-primary);
            text-shadow: none;
            filter: none;
        }

        .tile-title,
        .shortcut-label {
            line-height: 1.3;
        }

        .resource-title,
        .knowledge-title,
        .department-name {
            line-height: 1.38;
            padding-bottom: 0.08em;
        }

        .department-name {
            color: #101010;
            background: none;
            -webkit-background-clip: initial;
            background-clip: initial;
            -webkit-text-fill-color: initial;
        }

        .tile--compact .tile-title,
        .shortcut-label {
            font-size: 0.875rem;
            font-weight: 500;
            text-align: center;
            width: 100%;
            word-wrap: break-word;
        }

        .tile--standard .tile-title,
        .resource-title,
        .knowledge-title,
        .department-name {
            font-size: 1rem;
            margin-bottom: var(--space-2);
        }

         
        .tile-description,
        .resource-description,
        .knowledge-description,
        .department-description {
            font-size: 0.94rem;
            color: var(--text-secondary);
            line-height: 1.52;
        }

         
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: clamp(var(--space-3), 3vw, var(--space-4));
        }

        .team-section-group {
            margin-bottom: var(--space-6);
            padding: var(--space-4) var(--space-5);
            background: var(--bg-surface);
            border-radius: var(--card-radius);
            border: 1px solid rgba(15, 30, 61, 0.08);
            box-shadow: 0 10px 28px rgba(15, 23, 42, 0.05);
        }

        .team-section-group--last {
            margin-bottom: 0;
        }

        .team-section-title {
            margin: 0 0 var(--space-3);
            font-size: 1.05rem;
            font-weight: 500;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

         
        .drive-embed-card {
            display: grid;
            grid-template-rows: auto 1fr;
            gap: var(--space-3);
            padding: var(--space-4);
            height: 100%;
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
        }

        .drive-embed-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: var(--space-3);
        }

        .drive-embed-title {
            font-size: 0.95rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .drive-embed-description {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.45;
            margin-top: 4px;
        }

        .drive-embed-button {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            text-decoration: none;
            color: var(--primary);
            font-weight: 500;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            border: 1px solid rgba(0, 204, 255, 0.3);
            background: rgba(0, 204, 255, 0.12);
            transition: all var(--transition);
            white-space: nowrap;
        }

        .drive-embed-button:hover {
            color: #fff;
            background: var(--primary);
            border-color: var(--primary);
        }

        .drive-embed-frame {
            width: 100%;
            height: 100%;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--bg-base);
            min-height: 0;
        }

        .drive-embed-card {
            background: #fff;
            border-color: rgba(0, 0, 0, 0.06);
        }

        .drive-embed-button {
            background: rgba(0, 204, 255, 0.1);
            border-color: rgba(0, 204, 255, 0.2);
            color: var(--primary);
        }

        .drive-embed-button:hover {
            color: #fff;
        }

        .team-member-card {
            background: linear-gradient(135deg, var(--bg-elevated) 0%, var(--bg-card) 100%);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-color);
            padding: var(--space-4);
            display: grid;
            grid-template-columns: 112px 1fr;
            gap: clamp(var(--space-3), 4vw, var(--space-4));
            align-items: flex-start;
            transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
            box-shadow: 0 18px 40px rgba(0, 0, 0, 0.08);
            position: relative;
        }

        .team-member-card::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            padding: 1px;
            background: linear-gradient(135deg, rgba(0, 204, 255, 0.45), rgba(31, 60, 255, 0.45));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .team-member-card:hover {
            transform: translateY(-4px);
            border-color: rgba(255, 255, 255, 0.16);
            box-shadow: 0 28px 50px rgba(0, 0, 0, 0.22);
        }

        .team-member-card:hover::before {
            opacity: 1;
        }

        .team-member-photo {
            width: 112px;
            height: 112px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(0, 204, 255, 0.22), rgba(31, 60, 255, 0.22));
            border: 4px solid rgba(255, 255, 255, 0.12);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 18px 44px rgba(0, 0, 0, 0.28);
        }

        .team-member-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .team-member-photo .placeholder-avatar {
            font-size: 2.75rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .team-member-info {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
            min-width: 0;
            width: 100%;
        }

        .team-member-name {
            font-size: 1.05rem;
            font-weight: 500;
            color: var(--text-primary);
            margin: 0;
            letter-spacing: -0.02em;
        }

        .team-member-title {
            font-size: 0.85rem;
            color: var(--primary);
            font-weight: 500;
            margin: 0;
            line-height: 1.4;
            word-break: break-word;
        }

        .team-member-contact {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding-top: var(--space-1);
            border-top: 1px solid var(--border-color);
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.45;
            width: 100%;
        }

        .team-contact-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-decoration: none;
            transition: color var(--transition);
            flex-wrap: wrap;
            width: 100%;
            overflow-wrap: anywhere;
            word-break: break-word;
            white-space: normal;
            cursor: pointer;
        }

        .team-contact-item:hover {
            color: var(--primary);
        }

        .team-contact-item i {
            width: 16px;
            font-size: 0.85rem;
            text-align: center;
            color: var(--text-muted);
            flex-shrink: 0;
        }

        .team-member-bio {
            font-size: 0.875rem;
            line-height: 1.6;
            color: var(--text-secondary);
            margin-top: auto;
            padding-top: var(--space-3);
            border-top: 1px solid var(--border-color);
        }

         
	        .team-member-card {
	            background: var(--tile-bg), var(--bg-surface);
	            box-shadow: var(--shadow-card);
	        }

        .team-member-card:hover {
            box-shadow: var(--shadow-card-hover);
        }

         
        .resources-grid {
            width: 100%;
            box-sizing: border-box;
            padding: var(--space-4);
            padding-top: var(--space-4);
            padding-bottom: 0;
            display: grid;
            gap: var(--space-4);
            grid-template-columns: repeat(auto-fit, minmax(260px, 320px));
            justify-content: flex-start;
            align-items: start;
        }

		        .resource-card,
		        .resources-grid>a.resource-card {
		            display: flex;
		            flex-direction: column;
		            border-radius: var(--card-radius);
		            background: var(--bg-surface);
		            border: 1px solid var(--card-border);
		            box-shadow: var(--shadow-card);
		            cursor: default;
		            transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition);
		            min-height: 0;
		            overflow: hidden;
		        }

        .resource-card::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: inherit;
            border: 1px solid rgba(255, 255, 255, 0.08);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .resource-card:hover {
            transform: translateY(-4px);
            border-color: rgba(31, 60, 255, 0.12);
            box-shadow: var(--shadow-card-hover);
        }

        .resource-card:hover::before {
            opacity: 1;
        }

        .resource-card:active {
            transform: translateY(-1px);
        }

        .resource-media,
        .resource-icon {
            width: 100%;
            height: auto;
            position: relative;
            overflow: hidden;
            aspect-ratio: 5 / 3;
            min-height: 150px;
            display: flex;
            align-items: flex-end;
            justify-content: flex-start;
            padding: 20px 24px;
            background: linear-gradient(135deg, rgba(31, 60, 255, 0.65), rgba(0, 204, 255, 0.52));
            flex: 0 0 auto;
        }

        .resource-media::after,
        .resource-icon::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(6, 18, 45, 0.08) 0%, rgba(6, 18, 45, 0.4) 100%);
            opacity: 0.85;
            pointer-events: none;
            transition: opacity 0.35s ease;
        }

        .resource-card:hover .resource-media::after,
        .resource-card:hover .resource-icon::after {
            opacity: 0.65;
        }

        .resource-media-frame {
            position: absolute;
            inset: 0;
        }

        .resource-media-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scale(1.03);
            filter: saturate(1.05);
            transition: transform 0.6s ease;
        }

        .resource-card:hover .resource-media-image {
            transform: scale(1.08);
        }

        .resource-icon {
            background: linear-gradient(135deg, rgba(31, 60, 255, 0.68), rgba(0, 204, 255, 0.55));
        }

        .resource-icon--thumbnail {
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .resource-icon i {
            position: relative;
            z-index: 1;
            font-size: 3.25rem;
            color: rgba(255, 255, 255, 0.92);
            filter: drop-shadow(0 8px 22px rgba(5, 15, 35, 0.35));
        }

        .resource-icon--thumbnail i {
            font-size: clamp(3.75rem, 6vw, 5rem);
            transform: scale(1.03);
            transition: transform 0.6s ease;
        }

        .resource-card:hover .resource-icon--thumbnail {
            transform: none;
            filter: none;
        }

        .resource-card:hover .resource-icon--thumbnail i {
            transform: scale(1.08);
        }

        .resource-card-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            padding: var(--space-4);
        }

        .resource-card--with-children {
            cursor: default;
        }

        .resource-card--has-action {
            cursor: pointer;
        }

        .resource-card--with-children.resource-card--has-action {
            cursor: pointer;
        }

        .resource-card--with-image {
            align-items: stretch;
        }

        .resource-card--with-image .resource-card-content {
            width: 100%;
            max-width: 100%;
        }

        .resource-card-header {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
            margin-bottom: var(--space-1);
        }

        .resource-card-body {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
            flex: 1;
            min-height: 0;
        }

        .resource-card-body--static {
            flex: 0;
        }

        .resource-card--with-children .resource-description {
            color: var(--text-secondary);
        }

        .resource-children {
            flex: 1;
            display: flex;
            flex-direction: column;
            margin-top: var(--space-1);
            padding-bottom: var(--space-3);
            margin-bottom: 0;
            min-height: 0;
            overflow: hidden;
        }

        .resource-card--with-children .resource-title-divider {
            margin-bottom: var(--space-2);
        }

        .resource-card--with-children .resource-sublist {
            margin-top: var(--space-1);
            padding-bottom: var(--space-2);
        }

        .resource-card--static .resource-card-content,
        .resource-card--static .resource-card-body {
            flex: 0;
        }

        .resource-card--static .resource-card-body {
            gap: var(--space-2);
        }

        .resource-card--static .resource-title-divider {
            margin: var(--space-2) 0 var(--space-2);
        }

        .resource-card--static {
            cursor: default;
        }

        .resource-card--with-children .resource-children {
            overflow-y: auto;
            padding-right: 6px;
            padding-bottom: var(--space-3);
            scrollbar-gutter: stable both-edges;
            scroll-padding-bottom: var(--space-2);
            max-height: clamp(12rem, 40vh, 20rem);
        }

        .resource-card--with-children .resource-children::after {
            content: '';
            display: block;
            height: var(--space-3);
            flex-shrink: 0;
        }

        @media (max-width: 720px) {
            .resource-card {
                max-height: none;
            }

            .resource-card--with-children .resource-children {
                max-height: none;
                overflow: visible;
            }
        }

        .department-subtitle {
            font-size: 1.05rem;
            font-weight: 500;
            background: linear-gradient(135deg, var(--brand-blue-tint, #1F3CFF), var(--brand-red-tint, #00CCFF));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
            letter-spacing: 0.01em;
        }

        .department-hero {
            background: var(--bg-surface);
            border-radius: var(--card-radius);
            padding: clamp(var(--space-5), 4vw, var(--space-6));
            box-shadow: var(--shadow-card);
            border: 1px solid rgba(15, 30, 61, 0.05);
            margin-bottom: var(--space-6);
            position: relative;
        }

        .department-hero__inner {
            display: flex;
            flex-wrap: wrap;
            gap: clamp(var(--space-5), 4vw, var(--space-8));
            align-items: flex-start;
        }

        .department-hero__left {
            flex: 1 1 48%;
            min-width: 280px;
            max-width: 640px;
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }

        .department-hero__heading {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .department-description {
            font-size: 1.05rem;
            line-height: 1.7;
            color: var(--text-secondary);
        }

        .department-description p {
            margin: 0;
        }

        .department-hero__right {
            flex: 1 1 38%;
            min-width: 280px;
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
            border-left: 1px solid rgba(15, 30, 61, 0.08);
            padding-left: clamp(var(--space-4), 3vw, var(--space-5));
        }

        .department-support {
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
        }

        .department-support-title {
            font-size: 0.95rem;
            font-weight: 500;
            text-transform: none;
            letter-spacing: 0.01em;
            color: var(--text-primary);
        }

        .department-support-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: var(--space-3);
            align-content: start;
        }

        .support-pagination {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-2);
            margin-top: var(--space-2);
            width: 100%;
        }

        .support-pagination button {
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--card-border);
            background: var(--bg-overlay);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition);
        }

        .support-pagination button:hover:not(:disabled) {
            color: var(--text-primary);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-subtle);
        }

        .support-pagination button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .support-pagination span {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .support-card {
            position: relative;
            overflow: hidden;
            border-radius: var(--card-radius);
            background: var(--bg-surface);
            border: 1px solid var(--card-border);
            box-shadow: var(--shadow-subtle);
            padding: clamp(var(--space-3), 2vw, var(--space-3));
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
            min-height: 100%;
            transition: transform var(--transition), box-shadow var(--transition);
        }

        .support-card:hover {
            box-shadow: var(--shadow-card-hover);
            transform: translateY(-2px);
        }

        .support-card::after {
            content: '';
            position: absolute;
            left: clamp(var(--space-3), 2vw, var(--space-4));
            right: clamp(var(--space-3), 2vw, var(--space-4));
            top: 0;
            height: 3px;
            border-radius: 999px;
            pointer-events: none;
        }

        .support-card--warm::after {
            background: linear-gradient(90deg, var(--brand-red-tint), var(--brand-blue-tint));
        }

        .support-card--cool::after {
            background: linear-gradient(90deg, var(--brand-blue-tint), var(--brand-red-tint));
        }

        .support-card-title {
            font-size: 0.95rem;
            font-weight: 500;
            text-transform: none;
            letter-spacing: 0.01em;
            color: var(--text-primary);
            display: grid;
            grid-template-columns: auto 1fr;
            align-items: flex-start;
            gap: var(--space-2);
            line-height: 1.3;
        }

        .support-card-title i {
            font-size: 1rem;
            margin-top: 2px;
            background: linear-gradient(180deg, var(--brand-red-tint), var(--brand-blue-tint));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 0 4px var(--primary-glow));
        }

        .support-card-body {
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
        }

        .support-detail {
            display: grid;
            grid-template-columns: auto 1fr;
            align-items: start;
            column-gap: var(--space-2);
            row-gap: 2px;
            color: var(--text-primary);
            font-size: 0.92rem;
            line-height: 1.4;
        }

        .support-detail i {
            font-size: 0.875rem;
            margin-top: 2px;
            background: linear-gradient(180deg, var(--brand-red-tint), var(--brand-blue-tint));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 0 3px rgba(31, 60, 255, 0.22));
        }

        .support-detail-text,
        .support-detail-link,
        .support-detail-action {
            flex: 1 1 auto;
            min-width: 0;
            word-break: break-word;
            overflow-wrap: anywhere;
        }

        .support-detail-link {
            color: inherit;
            text-decoration: none;
            transition: color var(--transition);
            font-weight: 500;
        }

        .support-detail-link:hover,
        .support-detail-link:focus-visible {
            color: var(--primary);
        }

        .support-detail-action {
            color: var(--primary);
            font-weight: 500;
            text-decoration: none;
            transition: color var(--transition);
        }

        .support-detail-action:hover,
        .support-detail-action:focus-visible {
            color: var(--secondary);
        }

        @media (max-width: 960px) {
            .department-hero__inner {
                flex-direction: column;
            }

            .department-hero__right {
                border-left: 0;
                padding-left: 0;
                border-top: 1px solid rgba(15, 30, 61, 0.08);
                padding-top: var(--space-4);
            }
        }

        .resource-media {
            width: 100%;
        }

        .resource-title,
        .resource-title--link {
            display: block;
            font-weight: 500;
            color: var(--text-primary);
            line-height: 1.42;
            letter-spacing: -0.01em;
            font-size: 1rem;
            text-decoration: none;
        }

        .resource-title-divider {
            margin: var(--space-2) 0 var(--space-3);
            border: 0;
            height: 1px;
            background: linear-gradient(90deg, rgba(15, 30, 61, 0.08), rgba(15, 30, 61, 0));
            width: 100%;
        }

        .resource-title--link {
            text-decoration: none;
        }

        .resource-title--link:hover {
            color: var(--primary);
        }

        .resource-sublist {
            list-style: none;
            margin: var(--space-2) 0 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
        }

        .resource-sublist--two-column {
            column-count: 1;
        }

        .resource-sublist--nested {
            margin-top: var(--space-2);
            padding-left: var(--space-3);
            border-left: 1px solid rgba(15, 30, 61, 0.08);
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .resource-subitem {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .resource-subitem-link {
            display: inline-flex;
            align-items: flex-start;
            gap: 10px;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 0.88rem;
            font-weight: 500;
            line-height: 1.4;
            transition: color 0.2s ease, transform 0.2s ease;
        }

        .resource-subitem-link:hover,
        .resource-subitem-link:focus-visible {
            color: var(--primary);
            transform: translateX(2px);
        }

        .resource-subitem-link--static {
            color: var(--text-secondary);
            cursor: default;
            transform: none;
        }

        .resource-subitem-bullet {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            margin-top: 6px;
            background: linear-gradient(135deg, var(--brand-blue-tint), var(--brand-red-tint));
            flex-shrink: 0;
            box-shadow: 0 0 8px rgba(31, 60, 255, 0.2);
        }

        .resource-subitem-description {
            font-size: 0.8rem;
            color: var(--text-secondary);
            line-height: 1.4;
            padding-left: calc(10px + 6px + var(--space-2));
        }

        .resource-card--with-children {
            cursor: default;
        }

         
        .knowledge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-4);
        }

        .knowledge-card {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
            padding: var(--space-4);
            background: var(--bg-surface);
            border-radius: var(--card-radius);
            border: 1px solid var(--card-border);
            transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
            cursor: pointer;
            box-shadow: var(--shadow-card);
            min-height: 140px;
            text-decoration: none;
            color: inherit;
        }

         

         
        .department-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-4);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

         
        .department-grid:has(.department-card.expanded) .department-card:not(.expanded) {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            transform: scale(0.98);
            opacity: 0.9;
        }

        .department-card {
            position: relative;
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            padding: var(--space-5);
            border-radius: var(--card-radius);
            border: 1px solid var(--card-border);
            background: var(--bg-surface);
            box-shadow: var(--shadow-card);
            cursor: pointer;
            overflow: hidden;
            transform-origin: top left;
            will-change: transform, grid-column;
            transition:
                transform 0.25s ease,
                box-shadow 0.25s ease,
                border-color 0.25s ease,
                grid-column 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                max-width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .department-card:hover {
            transform: translateY(-4px);
            border-color: rgba(31, 60, 255, 0.12);
            box-shadow: var(--shadow-card-hover);
        }

        .department-card.expanded {
            overflow: visible;
            grid-column: span 2;
            max-width: 600px;
            animation: expandCard 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes expandCard {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.02);
            }

            100% {
                transform: scale(1);
            }
        }

        .department-card.collapsing {
            animation: collapseCard 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            grid-column: span 1;
            max-width: 100%;
        }

        @keyframes collapseCard {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(0.98);
            }

            100% {
                transform: scale(1);
            }
        }

        @media (max-width: 900px) {
            .department-card.expanded {
                grid-column: span 1;
                max-width: 100%;
            }
        }

        #department-drive-section.card {
            display: flex;
            flex-direction: column;
        }

        #department-drive-section .card-body {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        #department-drive-section .drive-embed-card {
            flex: 1;
        }

        .department-header {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
            position: relative;
            min-height: 140px;
        }

        .department-expand-icon {
            position: absolute;
            top: var(--space-3);
            right: var(--space-3);
            color: var(--text-muted);
            transition: transform var(--transition);
            font-size: 0.875rem;
        }

        .department-card.expanded .department-expand-icon {
            transform: rotate(180deg);
        }

        .department-card.expanded .department-arrow i {
            transform: rotate(180deg);
        }

        .department-content {
            max-height: 0;
            overflow: hidden;
            background: var(--bg-overlay);
            border-top: 1px solid var(--border-color);
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
        }

        .department-card.expanded .department-content {
            opacity: 1;
            transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                opacity 0.3s ease 0.2s;
        }

        .department-card.expanded .department-content {
            max-height: 1200px;
             
        }

        .department-expanded {
            max-height: 0;
            overflow: hidden;
            background: var(--bg-overlay);
            border-top: 1px solid var(--border-color);
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .department-card.expanded .department-expanded {
            max-height: 800px;
             
        }

        .department-contact {
            padding: var(--space-4);
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            border-bottom: 1px solid var(--border-color);
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .contact-item i {
            background: linear-gradient(180deg, var(--brand-red-tint), var(--brand-blue-tint));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            filter: drop-shadow(0 0 4px var(--primary-glow));
            font-size: 0.875rem;
        }

        .contact-item a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color var(--transition);
            font-size: 0.875rem;
        }

        .contact-item a:hover {
            color: var(--primary);
        }

        .department-team {
            padding: var(--space-4);
            position: relative;
        }

        .department-team h4 {
            margin: 0 0 var(--space-3);
            color: var(--text-primary);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .department-team h4::after {
            content: none;
            font-size: 0.65rem;
            color: var(--text-muted);
            font-weight: normal;
            text-transform: none;
            letter-spacing: normal;
            opacity: 0.7;
            animation: fadeInOut 3s ease-in-out infinite;
        }

        @keyframes fadeInOut {

            0%,
            100% {
                opacity: 0.7;
            }

            50% {
                opacity: 0.3;
            }
        }

        .team-members {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            max-height: none;
            overflow: visible;
            padding-right: 0;
            margin-right: 0;
        }

         
        @media (max-width: 600px) {
            .team-members {
                grid-template-columns: 1fr;
            }

            .team-grid {
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }

            .team-member-card {
                margin-bottom: var(--space-2);
            }
        }

         
        .team-members::-webkit-scrollbar {
            width: 10px;
        }

        .team-members::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            border: 1px solid var(--border-color);
        }

        .team-members::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--brand-blue-tint), var(--brand-red-tint));
            border-radius: 5px;
            box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.3);
        }

        .team-members::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--brand-blue), var(--brand-red));
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
        }

         
        .faq-accordion {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .faq-item {
            background: var(--bg-elevated);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .faq-item:hover {
            border-color: var(--border-hover);
        }

        .faq-question {
            width: 100%;
            padding: var(--space-4);
            background: transparent;
            border: none;
            text-align: left;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: var(--space-3);
            color: var(--text-primary);
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .faq-question:hover {
            background: var(--bg-hover);
        }

        .faq-question.active {
            background: var(--bg-hover);
            color: var(--primary);
        }

        .faq-icon {
            flex-shrink: 0;
            transition: transform 0.3s ease;
            color: var(--text-tertiary);
        }

        .faq-question.active .faq-icon {
            transform: rotate(180deg);
            color: var(--primary);
        }

        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
            padding: 0 var(--space-4);
        }

        .faq-answer.active {
            max-height: 500px;
            padding: 0 var(--space-4) var(--space-4) var(--space-4);
        }

        .faq-answer p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin: 0;
            font-size: 0.875rem;
        }

        .faq-item {
            background: white;
        }

        .faq-question:hover {
            background: var(--bg-surface);
        }

        .faq-question.active {
            background: var(--bg-surface);
        }

         
        @media (max-width: 768px) {

            .department-contact {
                padding: var(--space-3);
                gap: var(--space-2);
            }

            .contact-item a {
                word-break: break-all;
                font-size: 0.875rem;
            }

            .member-email {
                font-size: 0.7rem;
            }

            .team-member {
                padding: var(--space-2);
            }
        }

        .team-member {
            padding: 14px;
            background: var(--bg-base);
            border-radius: var(--radius-md);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            gap: 6px;
            overflow: hidden;
            word-break: break-word;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .team-member::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, var(--brand-red-tint), var(--brand-blue-tint));
            opacity: 0;
            transition: all 0.3s ease;
            transform: scaleY(0);
            transform-origin: center;
            pointer-events: none;
        }

        .team-member:hover {
            background: var(--bg-elevated);
            border-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1),
                0 0 20px rgba(31, 60, 255, 0.05);
        }

        .team-member:hover::before {
            opacity: 1;
            transform: scaleY(1);
        }


        .member-name {
            font-weight: 500;
            color: var(--text-primary);
            font-size: 0.875rem;
            line-height: 1.3;
            margin-bottom: 4px;
            word-wrap: break-word;
            overflow-wrap: break-word;
            letter-spacing: -0.01em;
        }

        .member-role {
            color: var(--text-muted);
            font-size: 0.75rem;
            line-height: 1.4;
            margin-bottom: 8px;
            opacity: 0.85;
            word-wrap: break-word;
            overflow-wrap: break-word;
            font-weight: 500;
        }

        .contact-section {
            margin-bottom: var(--space-4);
            padding-bottom: var(--space-3);
            border-bottom: 1px solid var(--border-color);
        }

        .contact-section:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .contact-section strong {
            display: block;
            color: var(--text-cream);
            font-size: 0.75rem;
            font-weight: 500;
            margin-bottom: var(--space-2);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .member-phone {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            color: var(--text-secondary);
            font-size: 0.65rem;
            line-height: 1.2;
            opacity: 0.8;
            text-decoration: none;
            transition: color 0.2s ease, transform 0.2s ease, border-color 0.2s ease, background 0.2s ease;
            cursor: pointer;
        }

        .member-phone i {
            font-size: 0.5rem;
            color: var(--text-muted);
        }

        .member-phone:hover {
            color: var(--primary);
            opacity: 1;
            transform: translateX(2px);
        }

        .member-email {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.725rem;
            line-height: 1.3;
            transition: all 0.2s ease;
            word-break: break-word;
            overflow-wrap: break-word;
            max-width: 100%;
            padding: 6px 10px;
            background: rgba(31, 60, 255, 0.05);
            border-radius: var(--radius-sm);
            border: 1px solid transparent;
            margin-top: 6px;
            cursor: pointer;
        }

        .member-email i {
            font-size: 0.65rem;
            flex-shrink: 0;
            color: var(--brand-blue-tint);
        }

        .member-email:hover {
            color: var(--text-primary);
            background: rgba(31, 60, 255, 0.1);
            border-color: rgba(31, 60, 255, 0.2);
            transform: translateX(2px);
        }

        .member-email i {
            font-size: 0.75rem;
        }

        .department-action {
            padding: var(--space-4);
            display: flex;
            justify-content: center;
        }

        .department-btn,
        .department-page-btn,
        .calendar-view-btn,
        .embed-btn {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
        }

        .department-description {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }

        .department-btn {
            margin-top: var(--space-2);
        }

        .department-btn i {
            font-size: 0.625rem;
        }

         
        #eventsContainer {
             
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .event-item {
            padding: var(--space-3);
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            transition: all var(--transition);
            position: relative;
            padding-left: var(--space-5);
            box-shadow: var(--shadow-glow),
                inset 0 1px 0 var(--glow-subtle);
            flex: 0 0 auto;
            min-height: 60px;
        }

        .event-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(135deg, var(--brand-red-tint), var(--brand-blue-tint));
            border-radius: var(--radius-md) 0 0 var(--radius-md);
            box-shadow: 0 0 6px var(--primary-glow);
        }

        .event-item:hover {
            background: var(--bg-overlay);
            transform: translateX(2px);
        }

        .event-date {
            font-weight: 500;
            color: var(--text-cream);
            font-size: 0.875rem;
        }

        .event-title {
            font-weight: 500;
            color: var(--text-primary);
            margin: var(--space-1) 0;
        }

        .event-meta {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: var(--space-2);
        }

        .event-actions {
            display: flex;
            gap: var(--space-2);
            margin-top: var(--space-2);
        }

        .event-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

         
        .nav-item:focus-visible,
        .sidebar-action-btn:focus-visible,
        .card-action:focus-visible,
        .shortcut-item:focus-visible,
        .department-btn:focus-visible,
        .event-btn:focus-visible,
        .embed-btn:focus-visible,
        .looker-select:focus-visible,
        .looker-dd-btn:focus-visible {
            outline: none;
            box-shadow: 0 0 0 2px var(--ring), 0 0 0 6px var(--ring-soft);
            background: var(--bg-overlay);
            color: var(--text-cream);
        }

         
        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition-duration: 0ms !important;
                scroll-behavior: auto !important;
            }
        }

        .event-btn i {
            font-size: 0.85rem;
        }

        .calendar-footer {
            margin-top: var(--space-4);
            padding-top: var(--space-4);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: center;
        }

         
        .skeleton {
            background: linear-gradient(90deg, var(--bg-elevated) 25%, var(--bg-overlay) 50%, var(--bg-elevated) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s ease-in-out infinite;
            border-radius: var(--radius-sm);
        }

        .skeleton {
            background: linear-gradient(90deg, #e0e0e0 25%, #f0f0f0 50%, #e0e0e0 75%);
            background-size: 200% 100%;
        }

         
        .skeleton-title {
            width: 60%;
            height: 14px;
        }

        .skeleton-text {
            width: 90%;
            height: 12px;
            margin-top: 10px;
        }

        .skeleton-text-short {
            width: 70%;
            height: 12px;
            margin-top: 6px;
        }

        .skeleton-date {
            width: 120px;
            height: 12px;
        }

        .skeleton-event-title {
            width: 60%;
            height: 14px;
            margin-top: 8px;
        }

        .skeleton-event-time {
            width: 40%;
            height: 12px;
            margin-top: 8px;
        }

        @keyframes skeleton-loading {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }


         

         
        @media (min-width: 1401px) {
            .dashboard-grid {
                grid-template-columns: repeat(12, 1fr);
            }
        }

         
        @media (max-width: 1400px) {
            .dashboard-grid {
                grid-template-columns: repeat(8, 1fr);
            }

            .span-5 {
                grid-column: span 4;
            }

            .span-6 {
                grid-column: span 4;
            }

            .span-7 {
                grid-column: span 4;
            }

            .span-12 {
                grid-column: span 8;
            }

            .shortcuts-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

         
        @media (max-width: 1024px) {
            :root {
                --sidebar-width: 240px;
            }

            .dashboard-grid {
                grid-template-columns: repeat(6, 1fr);
                gap: var(--space-4);
            }

            .span-3 {
                grid-column: span 3;
            }

            .span-4 {
                grid-column: span 3;
            }

            .span-5 {
                grid-column: span 3;
            }

            .span-6 {
                grid-column: span 6;
            }

            .span-7 {
                grid-column: span 6;
            }

            .span-12 {
                grid-column: span 6;
            }

            .shortcuts-grid,
            .department-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: var(--space-3);
            }

            .metrics-band {
                padding: var(--space-3) var(--space-4);
            }

            .progress-container {
                gap: var(--space-3);
            }
        }

         
        @media (max-width: 768px) {
            .team-grid {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
                gap: clamp(var(--space-3), 5vw, var(--space-5));
            }

            .team-member-photo {
                height: 200px;
            }

            .team-member-info {
                padding: var(--space-4);
            }

            .department-description {
                margin: var(--space-3) var(--space-2) var(--space-4);
                padding: var(--space-4);
            }

            .department-description p {
                font-size: 0.95rem;
            }

            .app-container {
                display: block;
                padding-top: 70px;
                 
            }

             
            .mobile-header {
                display: flex;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                height: 70px;
                 
                background: var(--bg-surface);
                border-bottom: 1px solid var(--border-color);
                z-index: 1000;
                align-items: center;
                padding: 0 var(--space-4);
                justify-content: space-between;
                box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
                backdrop-filter: blur(12px);
            }

             
            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid var(--border-color);
                color: var(--text-primary);
                font-size: 1.2rem;
                cursor: pointer;
                padding: var(--space-3);
                border-radius: var(--radius-md);
                min-width: 48px;
                min-height: 48px;
                transition: all var(--transition);
                position: relative;
                overflow: hidden;
            }

            .mobile-menu-btn:hover {
                background: rgba(255, 255, 255, 0.1);
                transform: translateY(-1px);
                box-shadow: 0 4px 12px var(--primary-glow);
            }

            .mobile-menu-btn:active {
                transform: translateY(0);
                background: rgba(255, 255, 255, 0.15);
            }

             
		            .mobile-header .logo-container img {
		                height: 42px;
		                width: 42px;
		                opacity: 0.95;
		                filter: brightness(1.1);
		            }

		            .mobile-header .logo-container svg {
		                height: 42px;
		                width: 42px;
		                opacity: 0.95;
		            }

            .mobile-header .logo-container span {
                color: #333333 !important;
            }

             
            .sidebar {
                position: fixed;
                top: 70px;
                left: -100%;
                bottom: 0;
                width: min(320px, 85vw);
                background: var(--bg-surface);
                z-index: 999;
                transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                overflow: hidden;
                box-shadow: 4px 0 24px rgba(0, 0, 0, 0.2);
                backdrop-filter: blur(16px);
                border-right: 1px solid var(--border-color);
            }

            .main-content {
                margin-left: 0;
                 
            }

            .sidebar.active {
                left: 0;
            }

             
            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 70px;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.6);
                z-index: 998;
                opacity: 0;
                transition: opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                backdrop-filter: blur(2px);
            }

            .sidebar-overlay.active {
                display: block;
                opacity: 1;
            }

             
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: var(--space-4);
                padding: var(--space-4) var(--space-3);
            }

            .span-3,
            .span-4,
            .span-5,
            .span-6,
            .span-7,
            .span-8,
            .span-12 {
                grid-column: span 1;
            }

            .team-grid-compact {
                grid-template-columns: 1fr;
            }

            .quick-links-list {
                max-height: none;
            }

             
            .greeting-header {
                padding: var(--space-6) var(--space-3) var(--space-4);
                text-align: center;
            }

            .greeting-text {
                font-size: 1.875rem;
                line-height: 1.2;
                margin-bottom: var(--space-3);
            }

            .greeting-date {
                font-size: 1rem;
                margin-bottom: var(--space-4);
            }

            .daily-quote-line {
                font-size: 0.9rem;
                line-height: 1.5;
                max-width: 100%;
            }

            .shortcuts-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--space-3);
            }

            .department-grid {
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }

            .progress-container {
                gap: var(--space-3);
            }

            .card {
                border-radius: var(--radius-md);
            }

            .card-body {
                padding: var(--space-4);
            }

            .card-title {
                font-size: 1.1rem;
            }

             
            .card {
                margin-bottom: var(--space-4);
                border-radius: var(--radius-lg);
            }

            .card-header {
                padding: var(--space-4) var(--space-4) var(--space-3);
            }

            .card-content {
                padding: 0 var(--space-4) var(--space-4);
            }

             
            .metrics-band {
                padding: var(--space-4);
                margin-bottom: var(--space-4);
            }

            .progress-container {
                gap: var(--space-3);
            }

             
            #newsContainer {
                display: flex;
                flex-direction: column;
                gap: var(--space-2);
            }

            .news-item {
                margin-bottom: 0;
            }
        }

         
        @media (max-width: 600px) {
            .department-description {
                margin: var(--space-2) var(--space-1) var(--space-3);
                padding: var(--space-3);
                border-radius: var(--radius-md);
            }

            .department-description p {
                font-size: 0.875rem;
                line-height: 1.6;
            }

             
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: var(--space-4);
                padding: var(--space-3);
            }

            .span-3,
            .span-4,
            .span-5,
            .span-6,
            .span-7,
            .span-8,
            .span-12 {
                grid-column: span 1;
            }

             
            .greeting-text {
                font-size: 1.625rem;
                line-height: 1.25;
            }

            .greeting-date {
                font-size: 0.95rem;
            }

            .daily-quote-line {
                font-size: 0.85rem;
                padding: 0 var(--space-2);
            }

             
            .metrics-band {
                padding: var(--space-4) var(--space-3);
                margin-bottom: var(--space-4);
            }

            .progress-label {
                font-size: 0.8rem;
            }

            .shortcuts-grid {
                grid-template-columns: 1fr;
                gap: var(--space-3);
            }

            .shortcut-item {
                padding: var(--space-3);
            }

            .shortcut-icon {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }

            .shortcut-label {
                font-size: 0.75rem;
            }

            .department-grid {
                grid-template-columns: 1fr;
            }

            .card-header {
                padding: var(--space-3);
            }

            .card-body {
                padding: var(--space-3);
            }

            .card-title {
                font-size: 1rem;
            }

            .news-title {
                font-size: 0.9rem;
            }

            .news-content {
                font-size: 0.8rem;
            }

            .news-meta {
                font-size: 0.7rem;
            }

             
            .looker-frame {
                min-height: 250px;
                border-radius: var(--radius-md);
            }

            .looker-controls {
                flex-wrap: wrap;
                gap: var(--space-2);
                padding: var(--space-3);
                justify-content: center;
            }

            .looker-control {
                font-size: 0.8rem;
                padding: var(--space-2) var(--space-3);
                min-width: 44px;
                min-height: 36px;
                border-radius: var(--radius-md);
            }

            .looker-select {
                width: 100%;
                min-height: 44px;
            }

             
            .pagination {
                padding-top: var(--space-3);
                margin-top: var(--space-3);
            }

            .pagination-btn {
                padding: var(--space-2);
                font-size: 0.8rem;
            }

            .pagination-info {
                font-size: 0.8rem;
            }

             
            .news-item,
            .event-item {
                padding: var(--space-3);
                margin-bottom: var(--space-3);
            }

            .news-item::before,
            .event-item::before {
                opacity: 0.8;
                box-shadow: 0 0 4px var(--primary-glow);
                width: 3px;
                border-radius: 0 2px 2px 0;
            }

             
            .department-card {
                padding: var(--space-4);
            }

            .department-header h3 {
                font-size: 1.1rem;
            }

            .department-stats {
                flex-direction: column;
                gap: var(--space-2);
                align-items: flex-start;
            }

             
            input,
            select,
            textarea {
                min-height: 48px;
                font-size: 1rem;
                 
                border-radius: var(--radius-md);
            }

             
            .btn {
                min-height: 48px;
                padding: var(--space-3) var(--space-4);
                font-size: 0.9rem;
            }
        }

         
        @media (max-width: 400px) {

             
            .mobile-header {
                padding: 0 var(--space-3);
            }

            .sidebar {
                width: 100vw;
            }

            .greeting-text {
                font-size: 1.375rem;
                line-height: 1.3;
            }

            .greeting-date {
                font-size: 0.9rem;
            }

            .daily-quote-line {
                font-size: 0.8rem;
                padding: 0 var(--space-1);
            }

            .dashboard-grid {
                padding: var(--space-2);
                gap: var(--space-3);
            }

            .main-content {
                padding: 0 var(--space-2) var(--space-6);
            }

            .card {
                border-radius: var(--radius-md);
            }

            .card-header {
                padding: var(--space-3);
            }

            .card-content {
                padding: 0 var(--space-3) var(--space-3);
            }

            .shortcuts-grid {
                grid-template-columns: 1fr;
                gap: var(--space-2);
            }

            .shortcut-card {
                padding: var(--space-3);
                min-height: 70px;
            }

            .progress-dates {
                display: none;
            }

            .progress-percent {
                margin-left: auto;
            }
        }

         
        body {
            transition: background-color var(--transition-slow),
                color var(--transition-slow);
        }

         
        .mobile-header,
        .mobile-menu-btn,
        .sidebar-overlay {
            display: none;
        }

        @media (max-width: 768px) {
            .mobile-header {
                display: flex !important;
            }

            .sidebar-overlay {
                display: block;
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.3s ease;
            }

            .sidebar-overlay.active {
                opacity: 1;
                pointer-events: auto;
            }
        }
	    </style>
	
	    <style>
	        :root{
	            --wf-fab-size: 115px;
	            --wf-tilt: 18deg;       
	            --wf-idle: 6.8s;        
	            --wf-hover: 240ms;      
	        }
	
	        @property --wf-tilt-current{
	            syntax: "<angle>";
	            inherits: true;
	            initial-value: 18deg;
	        }
	
	        @property --wf-lift{
	            syntax: "<length>";
	            inherits: true;
	            initial-value: 0px;
	        }
	
	        @property --wf-scale{
	            syntax: "<number>";
	            inherits: true;
	            initial-value: 1;
	        }
	
	        .wf-fab{
	            position: fixed;
	            right: 18px;
	            bottom: 18px;
	            width: var(--wf-fab-size);
	            height: var(--wf-fab-size);
	            padding: 0;
	            margin: 0;
	            border: 0;
	            background: transparent;
	            line-height: 0;
	            cursor: pointer;
	            outline: none;
	            z-index: 999;
	            display: inline-grid;
	            place-items: center;
	            isolation: isolate;
	            overflow: visible;
	            perspective: 1200px;
	            transform-style: preserve-3d;
	
	            --wf-tilt-current: var(--wf-tilt);
	            --wf-lift: 0px;
	            --wf-scale: 1;
	            transition:
	                transform 0.18s ease,
	                --wf-tilt-current var(--wf-hover) cubic-bezier(.2,.9,.2,1),
	                --wf-lift var(--wf-hover) cubic-bezier(.2,.9,.2,1),
	                --wf-scale var(--wf-hover) cubic-bezier(.2,.9,.2,1);
	        }
	
	        .wf-fab::before,
	        .wf-fab::after {
	            content: "";
	            position: absolute;
	            inset: 10px;
	            border-radius: 999px;
	            border: 1px solid rgba(0, 204, 255, 0.18);
	            background: transparent;
	            filter: drop-shadow(0 0 10px rgba(0, 204, 255, 0.12));
	            pointer-events: none;
	            z-index: -1;
	            opacity: 0;
	            transform: scale(1);
	            animation: wayfinderPulse 3.2s ease-out infinite;
	        }
	
	        .wf-fab::after {
	            inset: 4px;
	            border-color: rgba(0, 204, 255, 0.12);
	            filter: drop-shadow(0 0 14px rgba(0, 204, 255, 0.09));
	            animation-delay: 1.6s;
	        }
	
	        .wf-fab:hover{
	            transform: translateY(-2px);
	            --wf-tilt-current: 0deg;
	            --wf-lift: -2px;
	            --wf-scale: 1.03;
	        }
	
	        .wf-fab:hover::before,
	        .wf-fab:hover::after {
	            animation: none;
	            opacity: 0;
	        }
	
	        .wf-fab:active{
	            transform: translateY(0);
	            --wf-tilt-current: 0deg;
	            --wf-lift: 0px;
	            --wf-scale: 0.99;
	        }
	
	        .wf-fab:focus-visible{
	            outline: 3px solid rgba(0, 204, 255, 0.45);
	            outline-offset: 4px;
	        }
	
	        .wf-fab__tooltip{
	            position: absolute;
	            right: 0;
	            bottom: calc(100% + 12px);
	            width: min(280px, 70vw);
	            padding: 10px 12px;
	            border-radius: 12px;
	            border: 1px solid rgba(15, 23, 42, 0.1);
	            background: rgba(255, 255, 255, 0.96);
	            color: var(--text-primary);
	            font-size: 0.9rem;
	            line-height: 1.25;
	            letter-spacing: -0.01em;
	            box-shadow: 0 16px 34px rgba(15, 23, 42, 0.14);
	            backdrop-filter: blur(16px);
	            -webkit-backdrop-filter: blur(16px);
	            pointer-events: none;
	            opacity: 0;
	            transform: translateY(6px);
	            transition: opacity 0.15s ease, transform 0.15s ease;
	        }
	
	        .wf-fab__tooltip::after{
	            content: "";
	            position: absolute;
	            right: 18px;
	            top: 100%;
	            width: 10px;
	            height: 10px;
	            background: rgba(255, 255, 255, 0.96);
	            border-right: 1px solid rgba(15, 23, 42, 0.1);
	            border-bottom: 1px solid rgba(15, 23, 42, 0.1);
	            transform: translateY(-5px) rotate(45deg);
	        }
	
	        .wf-fab:hover .wf-fab__tooltip,
	        .wf-fab:focus-visible .wf-fab__tooltip{
	            opacity: 1;
	            transform: translateY(0);
	        }
	
	        .wf-fab .wf-svg{
	            width: calc(var(--wf-fab-size) * 0.92);
	            height: auto;
	            display: block;
	            transform-origin: 50% 50%;
	            transform-style: preserve-3d;
	            backface-visibility: hidden;
	            animation: wfIdleRock var(--wf-idle) ease-in-out infinite;
	            filter:
	                drop-shadow(1px 0 0 rgba(255, 255, 255, 0.98))
	                drop-shadow(-1px 0 0 rgba(255, 255, 255, 0.98))
	                drop-shadow(0 1px 0 rgba(255, 255, 255, 0.98))
	                drop-shadow(0 -1px 0 rgba(255, 255, 255, 0.98))
	                drop-shadow(0 18px 36px rgba(2, 6, 23, 0.22))
	                drop-shadow(0 6px 10px rgba(2, 6, 23, 0.10));
	            will-change: transform;
	            user-select: none;
	        }
	
	        #geminiChatModal .gemini-modal-content {
	            width: min(620px, 94vw);
	            max-width: min(620px, 94vw);
	            height: auto;
	            max-height: 90vh;
	        }
	
	        #geminiChatModal .gemini-modal-header {
	            display: flex;
	            align-items: center;
	            gap: 12px;
	        }
	
	        #geminiChatModal .wayfinder-title {
	            display: inline-flex;
	            align-items: center;
	            gap: 10px;
	        }
	
	        #geminiChatModal .wayfinder-mark {
	            width: 34px;
	            height: 34px;
	            border-radius: 14px;
	            display: inline-flex;
	            align-items: center;
	            justify-content: center;
	            background: linear-gradient(180deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0.05));
	            border: 1px solid rgba(0, 0, 0, 0.08);
	            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.38);
	        }
	
	        #geminiChatModal .wayfinder-mark i {
	            font-size: 16px;
	        }
	
	        #geminiChatModal .wayfinder-text {
	            font-weight: 600;
	            letter-spacing: -0.02em;
	        }
	
	        #geminiChatModal .gemini-open-link {
	            margin-left: auto;
	            color: var(--primary);
	            text-decoration: none;
	            font-size: 0.95rem;
	        }
	
	        #geminiChatModal .gemini-open-link:hover {
	            text-decoration: underline;
	        }
	
	        #geminiChatModal .gemini-modal-body {
	            padding: var(--space-5);
	            display: flex;
	            flex-direction: column;
	            gap: var(--space-4);
	        }
	
	        #geminiChatModal .gemini-embed-fallback {
	            padding: 10px 12px;
	            border: 1px solid var(--border-color);
	            border-radius: 12px;
	            font-size: 0.875rem;
	            color: var(--text-muted);
	            background: linear-gradient(180deg, var(--bg-elevated), var(--bg-surface));
	            box-shadow: inset 0 1px 0 var(--glow-subtle);
	        }
	
	        #geminiChatModal .wayfinder-actions {
	            display: flex;
	            gap: var(--space-3);
	            align-items: center;
	        }
	
	        @media (max-width: 768px) {
	            .wf-fab {
	                right: 14px;
	                bottom: 14px;
	                --wf-fab-size: 72px;
	            }
	
	            .wf-fab__tooltip {
	                display: none;
	            }
	
	            #geminiChatModal .gemini-modal-content {
	                width: 100vw;
	                height: 100vh;
	                max-height: 100vh;
	                border-radius: 0;
	            }
	        }
	
	        @keyframes wayfinderPulse {
	            0% {
	                opacity: 0;
	                transform: scale(1);
	            }
	            12% {
	                opacity: 0.55;
	            }
	            100% {
	                opacity: 0;
	                transform: scale(1.26);
	            }
	        }
	
	        @keyframes wfIdleRock{
	            0%   { transform: rotateY(calc(var(--wf-tilt-current) * -1)) translateY(var(--wf-lift)) scale(var(--wf-scale)); }
	            50%  { transform: rotateY(var(--wf-tilt-current)) translateY(var(--wf-lift)) scale(var(--wf-scale)); }
	            100% { transform: rotateY(calc(var(--wf-tilt-current) * -1)) translateY(var(--wf-lift)) scale(var(--wf-scale)); }
	        }
	
	        @media (prefers-reduced-motion: reduce) {
	            .wf-fab {
	                transition: none;
	                --wf-tilt-current: 0deg;
	                --wf-lift: 0px;
	                --wf-scale: 1;
	            }
	
	            .wf-fab::before,
	            .wf-fab::after {
	                animation: none;
	            }
	
	            .wf-fab .wf-svg {
	                animation: none;
	            }
	
	            .wf-fab__tooltip {
	                transition: none;
	            }
	        }
	    </style>
	</head>

<body>
    <div class="skyline-overlay" aria-hidden="true"></div>

    
    <svg aria-hidden="true" width="0" height="0"
        style="position:absolute; width:0; height:0; overflow:hidden; pointer-events:none;">
        <defs>
            <linearGradient id="hubLogoGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" stop-color="var(--brand-red-tint, #7fe7ff)" />
                <stop offset="100%" stop-color="var(--brand-blue-tint, #1E90FF)" />
            </linearGradient>
            <clipPath id="hubLogoClipA">
                <path d="M 0 229.703125 L 768 229.703125 L 768 537.953125 L 0 537.953125 Z M 0 229.703125 " />
            </clipPath>
            <clipPath id="hubLogoClipB">
                <path d="M 307 462 L 384 462 L 384 537.953125 L 307 537.953125 Z M 307 462 " />
            </clipPath>
            <symbol id="hubLogoSymbol" viewBox="0 0 768 768">
                <g clip-path="url(#hubLogoClipA)">
                    <path d="M 565.414062 232.765625 C 563.421875 230.773438 560.664062 229.703125 557.90625 229.703125 L 347.992188 229.703125 C 345.082031 229.703125 342.476562 230.773438 340.332031 232.765625 L 274.90625 298.191406 L 172.707031 298.191406 L 172.707031 298.34375 C 169.949219 298.34375 167.191406 299.417969 165.199219 301.410156 L 0.945312 465.664062 L 31.128906 465.664062 L 172.859375 323.933594 L 270.308594 421.382812 L 153.554688 538.136719 L 183.738281 538.136719 L 345.847656 376.027344 L 507.957031 538.136719 L 538.140625 538.136719 L 406.523438 406.519531 L 557.601562 255.441406 L 736.566406 434.40625 L 767.054688 434.40625 Z M 565.414062 232.765625 " fill-opacity="1" fill-rule="nonzero" />
                </g>
                <g clip-path="url(#hubLogoClipB)">
                    <path d="M 352.128906 462.753906 C 370.210938 465.816406 383.847656 481.292969 383.847656 500.292969 L 383.847656 500.597656 L 352.128906 500.597656 Z M 339.566406 500.597656 L 339.566406 462.753906 C 321.484375 465.664062 307.847656 481.292969 307.847656 500.292969 L 307.847656 500.597656 Z M 339.566406 513.164062 L 307.847656 513.164062 L 307.847656 538.292969 L 339.566406 538.292969 Z M 352.128906 513.164062 L 352.128906 538.292969 L 383.847656 538.292969 L 383.847656 513.164062 Z M 352.128906 513.164062 " fill-opacity="1" fill-rule="nonzero" />
                </g>
                <path d="M 564.496094 328.378906 C 582.574219 331.441406 596.214844 346.917969 596.214844 365.917969 L 596.214844 366.222656 L 564.496094 366.222656 Z M 551.933594 366.222656 L 551.933594 328.378906 C 533.851562 331.289062 520.214844 346.917969 520.214844 365.917969 L 520.214844 366.222656 Z M 551.933594 378.632812 L 520.214844 378.632812 L 520.214844 403.761719 L 551.933594 403.761719 Z M 564.496094 378.632812 L 564.496094 403.761719 L 596.214844 403.761719 L 596.214844 378.632812 Z M 564.496094 378.632812 " fill-opacity="1" fill-rule="nonzero" />
                <path d="M 179.601562 389.664062 C 197.679688 392.730469 211.320312 408.207031 211.320312 427.207031 L 211.320312 427.511719 L 179.601562 427.511719 Z M 167.039062 427.511719 L 167.039062 389.664062 C 148.957031 392.578125 135.320312 408.207031 135.320312 427.207031 L 135.320312 427.511719 Z M 167.039062 440.074219 L 135.320312 440.074219 L 135.320312 465.203125 L 167.035156 465.203125 L 167.035156 440.074219 Z M 179.601562 440.074219 L 179.601562 465.203125 L 211.320312 465.203125 L 211.320312 440.074219 Z M 179.601562 440.074219 " fill-opacity="1" fill-rule="nonzero" />
            </symbol>
        </defs>
    </svg>
		        
    
    
    <div id="bannerContainer" class="banner-container">
        <div class="banner-content">
            <div id="bannerScroll" class="banner-scroll">
                
            </div>
            <button class="banner-close" onclick="closeBanner()" title="Close banner">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <script>
        


        const SITE_CONFIG = {
            

            navigation: [
                { icon: 'fa-bolt', text: 'Resources', href: '#resources' },
                { icon: 'fa-users', text: 'Meet the Team', href: '#team-section' },
                { icon: 'fa-folder-tree', text: 'Department Drive', href: '#department-drive-section' }
            ],

            

            quickAccess: [
                { icon: 'fa-store', text: 'Resource Link 1', href: '#' },
                { icon: 'fa-graduation-cap', text: 'Resource Link 2', href: '#' },
                { icon: 'fa-calendar-check', text: 'Events & Training', href: '#' },
                { icon: 'fa-comments', text: 'Forums', href: 'https://forums.fastsigns.com/' },
                { icon: 'fa-trophy', text: 'Leaderboards & Incentives', href: '#' },
                { icon: 'fa-video', text: 'Webinar & Network Recordings', href: '#' },
                { icon: 'fa-question-circle', text: 'FAQ', href: '/faq' }
            ],

            

            departments: [
                {
                    icon: 'fa-tools',
                    title: 'Tech Services',
                    description: 'Equipment support & troubleshooting',
                    phone: '1-800-TECH-123',
                    email: 'techservices@fastsigns.com',
                    link: '#tech-services',
                    teamMembers: [
                        { name: 'John Smith', role: 'Director', email: 'jsmith@fastsigns.com' },
                        { name: 'Sarah Johnson', role: 'Senior Technician', email: 'sjohnson@fastsigns.com' },
                        { name: 'Mike Chen', role: 'Support Specialist', email: 'mchen@fastsigns.com' }
                    ]
                },
                {
                    icon: 'fa-chalkboard-teacher',
                    title: 'Training',
                    description: 'Certification programs & workshops',
                    phone: '1-800-TRAIN-456',
                    email: 'training@fastsigns.com',
                    link: '#training',
                    teamMembers: [
                        { name: 'Lisa Anderson', role: 'Training Director', email: 'landerson@fastsigns.com' },
                        { name: 'David Williams', role: 'Lead Instructor', email: 'dwilliams@fastsigns.com' },
                        { name: 'Amy Martinez', role: 'Curriculum Developer', email: 'amartinez@fastsigns.com' }
                    ]
                },
                {
                    icon: 'fa-chart-line',
                    title: 'Sales Development',
                    description: 'Lead generation & sales strategies',
                    phone: '1-800-SALES-789',
                    email: 'sales@fastsigns.com',
                    link: '#sales-development',
                    teamMembers: [
                        { name: 'Robert Taylor', role: 'VP of Sales', email: 'rtaylor@fastsigns.com' },
                        { name: 'Jennifer Brown', role: 'Sales Manager', email: 'jbrown@fastsigns.com' },
                        { name: 'Chris Davis', role: 'Lead Strategist', email: 'cdavis@fastsigns.com' }
                    ]
                },
                {
                    icon: 'fa-bullhorn',
                    title: 'Marketing',
                    description: 'Campaigns, materials & brand assets',
                    phone: '1-800-MARKET-321',
                    email: 'marketing@fastsigns.com',
                    link: '#marketing',
                    teamMembers: [
                        { name: 'Emily White', role: 'Marketing Director', email: 'ewhite@fastsigns.com' },
                        { name: 'James Wilson', role: 'Brand Manager', email: 'jwilson@fastsigns.com' },
                        { name: 'Maria Garcia', role: 'Digital Marketing Lead', email: 'mgarcia@fastsigns.com' }
                    ]
                },
                {
                    icon: 'fa-server',
                    title: 'IT',
                    description: 'Systems support & infrastructure',
                    phone: '1-800-IT-HELP-0',
                    email: 'itsupport@fastsigns.com',
                    link: '#it-support',
                    teamMembers: [
                        { name: 'Tom Lee', role: 'IT Director', email: 'tlee@fastsigns.com' },
                        { name: 'Rachel Green', role: 'Systems Administrator', email: 'rgreen@fastsigns.com' },
                        { name: 'Kevin Park', role: 'Network Engineer', email: 'kpark@fastsigns.com' }
                    ]
                }
            ],

            

            resources: [
                {
                    icon: 'fa-handshake',
                    title: 'Sales',
                    description: 'Pricing guides, proposals & client management'
                },
                {
                    icon: 'fa-palette',
                    title: 'Design',
                    description: 'Templates, brand guidelines & creative tools'
                },
                {
                    icon: 'fa-print',
                    title: 'Print',
                    description: 'Production specs, color profiles & workflows'
                },
                {
                    icon: 'fa-hammer',
                    title: 'Fabrication',
                    description: 'CNC guides, routing specs & material handling'
                },
                {
                    icon: 'fa-hard-hat',
                    title: 'Install',
                    description: 'Safety protocols, permits & installation guides'
                },
                {
                    icon: 'fa-tv',
                    title: 'Digital Signage',
                    description: 'Content management, networking & troubleshooting'
                },
                {
                    icon: 'fa-clipboard-list',
                    title: 'Project Manager',
                    description: 'Project timelines, client coordination & workflow management'
                }
            ],

            

            knowledgeBase: [
                {
                    icon: 'fa-print',
                    title: 'Equipment',
                    description: 'Printer manuals, maintenance & specs'
                },
                {
                    icon: 'fa-laptop-code',
                    title: 'Software',
                    description: 'Design software tutorials & tips'
                },
                {
                    icon: 'fa-layer-group',
                    title: 'Media & Substrate',
                    description: 'Material guides & application charts'
                },
                {
                    icon: 'fa-address-book',
                    title: 'Vendor Database',
                    description: 'Supplier contacts & pricing info'
                },
                {
                    icon: 'fa-play-circle',
                    title: 'Video Library',
                    description: 'Training videos & webinar recordings'
                }
            ],

            

            communities: [
                { icon: 'fa-store-alt', text: 'Franchisees', href: '#' },
                { icon: 'fa-user-tie', text: 'Center Employees', href: '#' },
                { icon: 'fa-paint-brush', text: 'Graphic Designers', href: '#' },
                { icon: 'fa-tv', text: 'Digital Signage Support', href: '#' },
                { icon: 'fa-plug', text: 'Exterior Electrical Signage Support', href: '#' }
            ],

            

            lookerDashboards: {
                regions: [
                    { value: 'cur-ne', text: 'North East' },
                    { value: 'cur-se', text: 'South East' },
                    { value: 'cur-mw', text: 'Midwest' },
                    { value: 'cur-w', text: 'West' },
                    { value: 'cur-sw', text: 'South West' },
                    { value: 'int-uk', text: 'United Kingdom' },
                    { value: 'int-ca', text: 'Canada' },
                    { value: 'int-au', text: 'Australia' }
                ],
                comparisons: [
                    { value: 'mco', text: 'Multi-Center Owners' },
                    { value: 'cmp-us', text: 'United States' },
                    { value: 'cmp-uk', text: 'United Kingdom' },
                    { value: 'cmp-ca', text: 'Canada' },
                    { value: 'cmp-au', text: 'Australia' }
                ],
                yearOverYear: [
                    { value: 'yoy-us', text: 'United States' },
                    { value: 'yoy-uk', text: 'United Kingdom' },
                    { value: 'yoy-ca', text: 'Canada' },
                    { value: 'yoy-au', text: 'Australia' }
                ],
                special: [
                    { value: 'k-clubs', text: 'K Clubs' },
                    { value: 'top10', text: 'Top 10 by Region' }
                ]
            }
        };

        


        


        


        


        function updateProgressBars() {
            var now = new Date();
            var currentYear = now.getFullYear();
            var currentMonth = now.getMonth();



            var awardsYearStart, awardsYearEnd;
            if (currentMonth >= 9) { 
                awardsYearStart = new Date(currentYear, 9, 1); 
                awardsYearEnd = new Date(currentYear + 1, 8, 30, 23, 59, 59); 
            } else { 
                awardsYearStart = new Date(currentYear - 1, 9, 1); 
                awardsYearEnd = new Date(currentYear, 8, 30, 23, 59, 59); 
            }

            var awardsYearProgress = ((now - awardsYearStart) / (awardsYearEnd - awardsYearStart)) * 100;
            var awardsPercent = Math.round(Math.min(awardsYearProgress, 100));



            var awardsYearFill = document.getElementById('awardsYearFill');
            if (awardsYearFill) {
                awardsYearFill.style.setProperty('width', awardsPercent + '%', 'important');
                try { awardsYearFill.classList.remove('glint'); void awardsYearFill.offsetWidth; awardsYearFill.classList.add('glint'); } catch (_) { }
                try {
                    var aOpacity = awardsPercent < 20 ? .16 : (awardsPercent > 60 ? .26 : .20);
                    var aSize = awardsPercent < 20 ? '32px' : (awardsPercent > 60 ? '46px' : '38px');
                    var aBlur = awardsPercent > 60 ? '7px' : '6px';
                    awardsYearFill.style.setProperty('--glow-opacity', String(aOpacity));
                    awardsYearFill.style.setProperty('--glow-size', aSize);
                    awardsYearFill.style.setProperty('--glow-blur', aBlur);
                } catch (_) { }

            } else {

            }

            var awardsYearPercentEl = document.getElementById('awardsYearPercent');
            if (awardsYearPercentEl) {
                awardsYearPercentEl.textContent = awardsPercent + '%';
            }

            var fiscalYearStart = new Date(currentYear, 0, 1);
            var fiscalYearEnd = new Date(currentYear, 11, 31, 23, 59, 59);
            var fiscalYearProgress = ((now - fiscalYearStart) / (fiscalYearEnd - fiscalYearStart)) * 100;
            var fiscalPercent = Math.round(Math.min(fiscalYearProgress, 100));



            var fiscalYearFill = document.getElementById('fiscalYearFill');
            if (fiscalYearFill) {
                fiscalYearFill.style.setProperty('width', fiscalPercent + '%', 'important');
                try { fiscalYearFill.classList.remove('glint'); void fiscalYearFill.offsetWidth; fiscalYearFill.classList.add('glint'); } catch (_) { }
                try {
                    var fOpacity = fiscalPercent < 20 ? .16 : (fiscalPercent > 60 ? .26 : .20);
                    var fSize = fiscalPercent < 20 ? '32px' : (fiscalPercent > 60 ? '46px' : '38px');
                    var fBlur = fiscalPercent > 60 ? '7px' : '6px';
                    fiscalYearFill.style.setProperty('--glow-opacity', String(fOpacity));
                    fiscalYearFill.style.setProperty('--glow-size', fSize);
                    fiscalYearFill.style.setProperty('--glow-blur', fBlur);
                } catch (_) { }

            } else {

            }

            var fiscalYearPercentEl = document.getElementById('fiscalYearPercent');
            if (fiscalYearPercentEl) {
                fiscalYearPercentEl.textContent = fiscalPercent + '%';
            }
        }

        function escapeHtmlEarly(str) {
            try {
                return String(str)
                    .replace(/&/g, '&amp;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/"/g, '&quot;')
                    .replace(/'/g, '&#39;');
            } catch (_) { return ''; }
        }

        function showNewsSkeleton() {
            var c = document.getElementById('newsContainer');
            if (!c) return;
            var sk = '';
            for (var i = 0; i < 3; i++) {
                sk += '<div class="news-item">'
                    + '<div class="skeleton skeleton-title"></div>'
                    + '<div class="skeleton skeleton-text"></div>'
                    + '<div class="skeleton skeleton-text-short"></div>'
                    + '</div>';
            }
            c.innerHTML = sk;
        }

        function showEventsSkeleton() {
            var c = document.getElementById('eventsContainer');
            if (!c) return;
            var sk = '';
            for (var i = 0; i < 8; i++) {
                sk += '<div class="event-item">'
                    + '<div class="skeleton skeleton-date"></div>'
                    + '<div class="skeleton skeleton-event-title"></div>'
                    + '<div class="skeleton skeleton-event-time"></div>'
                    + '</div>';
            }
            c.innerHTML = sk;
        }

        function earlyOpenModal(index) {
            try {
                var items = (window.newsData && window.newsData.length) ? window.newsData : (window.__earlyNews || []);
                var item = items[index] || {};
                var modal = document.getElementById('newsModal');
                var title = document.getElementById('modalTitle');
                var body = document.getElementById('modalBody');
                var meta = document.getElementById('modalMeta');
                if (!modal || !title || !body || !meta) return;
                title.textContent = item.title || 'Announcement';
                var txt = String(item.fullContent || item.content || '');
                body.textContent = txt;
                body.innerHTML = body.innerHTML.replace(/\n/g, '<br>');
                var bits = [];
                if (item.date) bits.push('<span><i class="far fa-calendar"></i> ' + escapeHtmlEarly(item.date) + '</span>');
                if (item.author) bits.push('<span><i class="far fa-user"></i> ' + escapeHtmlEarly(item.author) + '</span>');
                meta.innerHTML = bits.join(' ');
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
            } catch (e) { }
        }

        function closeModal() {
            try {
                var modal = document.getElementById('newsModal');
                if (modal) modal.classList.remove('active');
                document.body.style.overflow = '';
            } catch (e) { }
        }

        function loadNewsEarly() {
            try {

                if (!(typeof google !== 'undefined' && google.script && google.script.run)) {

                    return;
                }
                google.script.run
                    .withSuccessHandler(function (items) {
                        try {
                            var count = Array.isArray(items) ? items.length : 0;

                            try {
                                var els = document.querySelectorAll('nav.nav-section a[href="#section-1"] .nav-badge');
                                for (var i = 0; i < els.length; i++) { els[i].textContent = String(count); }
                            } catch (_) { }
                            if (!count) return;
                            if (typeof window.newsData !== 'undefined') {
                                var allItems = items.map(function (n) {
                                    return {
                                        title: (n && n.title) || 'Untitled Announcement',
                                        content: (n && n.content) || '',
                                        fullContent: (n && (n.fullContent || n.content)) || '',
                                        date: (n && n.date) || '',
                                        author: (n && n.author) || '',
                                        pinned: (n && n.pinned) || false,
                                        archived: Boolean(n && n.archived),
                                        links: (n && Array.isArray(n.links)) ? n.links : [],
                                        attachments: (n && Array.isArray(n.attachments)) ? n.attachments : [],
                                        images: (n && Array.isArray(n.images)) ? n.images : []
                                    };
                                });

                                window.archivedNewsData = allItems.filter(function (item) { return item.archived; });
                                window.newsData = allItems.filter(function (item) { return !item.archived; })
                                    .sort(function (a, b) {
                                        if (a.pinned && !b.pinned) return -1;
                                        if (!a.pinned && b.pinned) return 1;
                                        return 0;
                                    });
                                if (typeof initializeNews === 'function') {
                                    initializeNews();
                                    if (typeof updatePaginationButtons === 'function') updatePaginationButtons();
                                    return;
                                }
                            }
                            var container = document.getElementById('newsContainer');
                            if (!container) return;
                            window.__earlyNews = items.slice();
                            var html = '';
                            for (var i = 0; i < Math.min(3, items.length); i++) {
                                var it = items[i] || {};
                                html += '<div class="news-item" onclick="try{openModal(' + i + ')}catch(e){earlyOpenModal(' + i + ')}">' +
                                    '<h3 class="news-title">' + (it.title || 'Announcement') + '</h3>' +
                                    '<p class="news-content">' + (it.content || '') + '</p>' +
                                    '<div class="news-meta"><span><i class="far fa-calendar"></i> ' + (it.date || '') + '</span></div>' +
                                    '</div>';
                            }
                            container.innerHTML = html;
                        } catch (mapErr) {

                        }
                    })
                    .withFailureHandler(function (error) {

                    })
                    .getNewsAnnouncements();
            } catch (e) {

            }
        }

        function startInit() {
            if ('requestIdleCallback' in window) {
                requestIdleCallback(function () {
                    initOnLoad();
                }, { timeout: 1000 });
            } else {
                setTimeout(initOnLoad, 10);
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', startInit);
        } else {
            startInit();
        }

        (function attachGlobalErrorHandlers() {
            try {
                window.addEventListener('error', function (e) {
                    try {
                        var details = '';
                        if (e && (e.filename || e.lineno || e.colno)) {
                            details = ' at ' + (e.filename || '') + ':' + (e.lineno || 0) + ':' + (e.colno || 0);
                        }

                    } catch (_) { }
                });
                window.addEventListener('unhandledrejection', function (e) {
                    try { } catch (_) { }
                });
            } catch (_) {
            }
        })();

        var browserTimezone = '';
        try {
            browserTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
        } catch (e) {
            browserTimezone = 'America/New_York'; 
        }

        function initOnLoad() {







            try {
                var inIframe = window !== window.parent;

                if (inIframe) {

                } else {

                }
            } catch (e) {

            }


            var greetingTime = document.querySelector('.greeting-time');
            var currentDate = document.getElementById('currentDate');

            if (greetingTime) {


            } else {

            }

            if (currentDate) {

            } else {

            }



            var hasGoogle = false;
            try {
                if (typeof google !== 'undefined') {
                    hasGoogle = true;


                }
            } catch (e) {

            }

            if (hasGoogle) {
                try {
                    if (google.script) {



                        if (google.script.run) {


                            try {

                                google.script.run
                                    .withSuccessHandler(function (result) {


                                        loadAllDataInParallel();
                                    })
                                    .withFailureHandler(function (error) {


                                        showAuthorizationMessage();
                                    })
                                    .warmup();
                            } catch (e) {

                                loadAllDataInParallel();
                            }
                        } else {


                        }
                    } else {

                    }
                } catch (e) {

                }
            } else {


            }


            setDateTime();

            try { showNewsSkeleton(); } catch (_) { }
            try { showEventsSkeleton(); } catch (_) { }


            setTimeout(function () {
                if (typeof updateProgressBars === 'function') {
                    updateProgressBars();

                } else {

                }
            }, 500);


            var finalGreetingTime = document.querySelector('.greeting-time');
            var finalDate = document.getElementById('currentDate');




            if (typeof google !== 'undefined' && google.script && google.script.run) {


            } else {

            }

            applyPrimaryActionClasses();


            try { lookerDebugDump('post-init'); } catch (_) { }
        }

        function loadAllDataInParallel() {


            var cachedData = checkCache();

            var startTime = performance.now();

            loadUserInfo();

            loadCalendarEvents();

            if (typeof loadBanner === 'function') {
                loadBanner();
            }

            if (typeof loadNewsEarly === 'function') {
                loadNewsEarly();
            }

            if (typeof loadDepartments === 'function') {
                loadDepartments();
            }

            setTimeout(function () {
                var loadTime = performance.now() - startTime;

            }, 100);
        }

        function checkCache() {
            try {
                var cacheKey = 'hubData_' + new Date().toDateString();
                var cached = localStorage.getItem(cacheKey);

                var totalSize = 0;
                for (var key in localStorage) {
                    if (key.startsWith('hubData_') && key !== cacheKey) {
                        localStorage.removeItem(key);
                    } else if (key.startsWith('hubData_')) {
                        totalSize += (localStorage.getItem(key) || '').length;
                    }
                }

                if (totalSize > 2 * 1024 * 1024) {
                    localStorage.removeItem(cacheKey);
                    return null;
                }

                if (cached) {
                    if (!cached.startsWith('{') || !cached.endsWith('}')) {
                        localStorage.removeItem(cacheKey);
                        return null;
                    }

                    var data = JSON.parse(cached);

                    if (!data.timestamp || typeof data.timestamp !== 'number') {
                        localStorage.removeItem(cacheKey);
                        return null;
                    }



                    var age = Date.now() - data.timestamp;
                    if (age < 5 * 60 * 1000) {
                        applyCachedData(data);
                        return data;
                    }
                }
            } catch (e) {

                try {
                    for (var k in localStorage) {
                        if (k.startsWith('hubData_')) {
                            localStorage.removeItem(k);
                        }
                    }
                } catch (cleanupError) { }
            }
            return null;
        }

        function applyCachedData(data) {
            try {
                if (data.events) {
                    updateEventsDisplay(data.events);
                }
                if (data.banner && data.banner.length > 0) {
                    bannerData = data.banner;
                    displayBanner();
                }
                if (data.news && data.news.length > 0) {
                    window.newsData = data.news.filter(function (item) { return !item.archived; });
                    window.archivedNewsData = data.news.filter(function (item) { return item.archived; });
                    initializeNews();
                }
                if (data.departments && data.departments.length > 0) {
                    departmentsData = data.departments;
                    renderDepartments();
                }

            } catch (e) {

            }
        }

        function saveToCache(type, data) {
            try {
                var cacheKey = 'hubData_' + new Date().toDateString();
                var cached = localStorage.getItem(cacheKey);
                var cacheData = cached ? JSON.parse(cached) : { timestamp: Date.now() };

                cacheData[type] = data;
                cacheData.timestamp = Date.now();

                localStorage.setItem(cacheKey, JSON.stringify(cacheData));

            } catch (e) {
            }
        }

        function loadUserInfo() {

        }

        function loadCalendarEvents() {

            try {
                if (typeof google !== 'undefined' && google.script && google.script.run) {
                    google.script.run
                        .withSuccessHandler(function (events) {


                            if (events && events.length > 0) {


                                saveToCache('events', events);
                                updateEventsDisplay(events);

                            } else {

                            }
                        })
                        .withFailureHandler(function (error) {


                        })
                        .getCalendarEvents(browserTimezone);
                } else {


                }
            } catch (e) {


            }
        }

        function getTzAbbr(dateObj, tz) {
            try {
                var fmt = new Intl.DateTimeFormat('en-US', { timeZone: tz, timeZoneName: 'short' });
                var parts = fmt.formatToParts(dateObj);
                for (var i = 0; i < parts.length; i++) {
                    if (parts[i].type === 'timeZoneName') return parts[i].value;
                }
            } catch (e) {   }
            return '';
        }

        function formatDateToken(dateObj, tz) {
            try {
                return new Intl.DateTimeFormat('en-US', { month: 'short', day: '2-digit', timeZone: tz }).format(dateObj).toUpperCase();
            } catch (e) {
                return '';
            }
        }

        function formatTimeWindow(startDate, endDate, tz, isAllDay) {
            if (isAllDay) return 'All Day';
            try {
                var opts = { hour: 'numeric', minute: '2-digit', hour12: true, timeZone: tz, timeZoneName: 'short' };
                var startStr = new Intl.DateTimeFormat('en-US', opts).format(startDate);
                var endStr = new Intl.DateTimeFormat('en-US', opts).format(endDate);
                var tzAbbr = getTzAbbr(endDate, tz);
                startStr = startStr.replace(/\s*[A-Z]{2,4}$/, '');
                endStr = endStr.replace(/\s*[A-Z]{2,4}$/, '');
                return startStr + ' - ' + endStr + (tzAbbr ? ' ' + tzAbbr : '');
            } catch (e) {
                return '';
            }
        }

        function adjustAllDayEndForDisplay(endDate) {
            try { return new Date(endDate.getTime() - 24 * 60 * 60 * 1000); } catch (e) { return endDate; }
        }

        function updateEventsDisplay(events) {



            if (events && events.length > 0) {
                eventsData = [];

                events.forEach(function (event) {
                    try {
                        var tz = event.timezone || browserTimezone || 'America/New_York';
                        var hasUtc = typeof event.startUtc !== 'undefined' && typeof event.endUtc !== 'undefined';
                        var startDate = hasUtc ? new Date(event.startUtc) : null;
                        var endDate = hasUtc ? new Date(event.endUtc) : null;
                        var isAllDay = !!event.isAllDay;
                        var dateText = event.date ? String(event.date).toUpperCase() : 'TBD';
                        var timeText = event.time || 'TBD';
                        if (hasUtc && startDate && endDate) {
                            var startToken = formatDateToken(startDate, tz);
                            var endAdj = isAllDay ? adjustAllDayEndForDisplay(endDate) : endDate;
                            var endToken = formatDateToken(endAdj, tz);
                            if (startToken && endToken && startToken !== endToken) {
                                dateText = startToken + ' - ' + endToken;
                            } else if (startToken) {
                                dateText = startToken;
                            }
                            var tw = formatTimeWindow(startDate, endDate, tz, isAllDay);
                            if (tw) timeText = tw;
                        }
                        var eventItem = {
                            date: dateText,
                            title: event.title || 'Untitled Event',
                            time: timeText,
                            type: event.location || 'Virtual',
                            description: event.description || '',
                            audience: 'All franchisees',
                            calendarLink: event.calendarLink || '#',
                            datesParam: event.datesParam || ''
                        };
                        eventsData.push(eventItem);

                    } catch (mapErr) {

                    }
                });




                currentEventPage = 1;

                var container = document.getElementById('eventsContainer');
                if (container) {
                    try {

                        if (typeof initializeEvents === 'function') {
                            initializeEvents();
                        } else {

                            var perPage = 4;
                            var page = 1;
                            var totalPages = Math.max(1, Math.ceil(eventsData.length / perPage));
                            function fallbackRender(p) {
                                var start = (p - 1) * perPage;
                                var pageEvents = eventsData.slice(start, start + perPage);
                                var html = '';
                                for (var i = 0; i < pageEvents.length; i++) {
                                    var ev = pageEvents[i] || {};
                                    var meta = (ev.time || 'TBD') + '  ' + (ev.type || 'Virtual') + '  ' + (ev.audience || 'All franchisees');
                                    html += '<div class="event-item">' +
                                        '<div class="event-date">' + (ev.date || 'TBD') + '</div>' +
                                        '<div class="event-title">' + (ev.title || 'Untitled Event') + '</div>' +
                                        '<div class="event-meta">' + meta + '</div>' +
                                        '<div class="event-actions">' +
                                        '<button class="event-btn primary-action stripe add-btn" data-index="' + (start + i) + '"><i class="fas fa-calendar-plus"></i> Add to Calendar</button>' +
                                        '<button class="event-btn primary-action stripe share-btn" data-index="' + (start + i) + '"><i class="fas fa-share-alt"></i> Share</button>' +
                                        '</div>' +
                                        '</div>';
                                }
                                container.innerHTML = html;
                                applyPrimaryActionClasses(container);
                                var pageInfo = document.getElementById('eventPageInfo');
                                if (pageInfo) { pageInfo.textContent = 'Page ' + p + ' of ' + totalPages; }
                                var prevBtn = document.getElementById('eventPrevBtn');
                                var nextBtn = document.getElementById('eventNextBtn');
                                if (prevBtn) prevBtn.disabled = (p === 1);
                                if (nextBtn) nextBtn.disabled = (p === totalPages);
                                try {
                                    var addBtns = container.querySelectorAll('.add-btn');
                                    for (var j = 0; j < addBtns.length; j++) {
                                        addBtns[j].addEventListener('click', function () {
                                            try {
                                                var idx = parseInt(this.getAttribute('data-index'), 10) || 0;
                                                var evd = eventsData[idx] || {};
                                                var url = 'https://calendar.google.com/calendar/render?action=TEMPLATE' +
                                                    '&text=' + encodeURIComponent(evd.title || '') +
                                                    '&details=' + encodeURIComponent(evd.description || '') +
                                                    '&location=' + encodeURIComponent(evd.type || '');
                                                if (evd.datesParam) { url += '&dates=' + encodeURIComponent(evd.datesParam); }
                                                window.open(url, '_blank', 'noopener,noreferrer');
                                            } catch (err) { }
                                        });
                                    }
                                    var shareBtns = container.querySelectorAll('.share-btn');
                                    for (var k = 0; k < shareBtns.length; k++) {
                                        shareBtns[k].addEventListener('click', function () {
                                            var idx2 = parseInt(this.getAttribute('data-index'), 10) || 0;
                                            var evs = eventsData[idx2] || {};
                                            var base = 'https://calendar.google.com/calendar/render?action=TEMPLATE';
                                            var gurl = base + '&text=' + encodeURIComponent(evs.title || '') + '&details=' + encodeURIComponent((evs.description || '') + '\n\nEvent Type: ' + (evs.type || '') + '\nAudience: ' + (evs.audience || '')) + '&location=' + encodeURIComponent(evs.type || '');
                                            if (evs.datesParam) { gurl += '&dates=' + encodeURIComponent(evs.datesParam); }
                                            var shareBtn = this;
                                            function copyToClipboard(text, btn) {
                                                if (navigator.clipboard && navigator.clipboard.writeText) {
                                                    navigator.clipboard.writeText(text).then(function () {
                                                        showCopySuccess(btn);
                                                    }).catch(function () {
                                                        fallbackCopy(text, btn);
                                                    });
                                                } else {
                                                    fallbackCopy(text, btn);
                                                }
                                            }

                                            function fallbackCopy(text, btn) {
                                                var textarea = document.createElement('textarea');
                                                textarea.value = text;
                                                textarea.style.position = 'fixed';
                                                textarea.style.opacity = '0';
                                                textarea.style.pointerEvents = 'none';
                                                document.body.appendChild(textarea);
                                                textarea.select();
                                                try {
                                                    document.execCommand('copy');
                                                    showCopySuccess(btn);
                                                } catch (e) {
                                                    prompt('Copy this link:', text);
                                                }
                                                document.body.removeChild(textarea);
                                            }

                                            function showCopySuccess(btn) {
                                                var original = btn.innerHTML;
                                                btn.innerHTML = '<i class="fas fa-check"></i> Link Copied!';
                                                btn.style.background = 'var(--primary)';
                                                btn.style.color = 'var(--bg-base)';
                                                setTimeout(function () {
                                                    btn.innerHTML = original;
                                                    btn.style.background = '';
                                                    btn.style.color = '';
                                                }, 2000);
                                            }

                                            copyToClipboard(gurl, shareBtn);
                                        });
                                    }
                                } catch (wireErr) { }
                            }
                            var prev = document.getElementById('eventPrevBtn');
                            var next = document.getElementById('eventNextBtn');
                            if (prev) prev.onclick = function () { if (page > 1) { page--; fallbackRender(page); } };
                            if (next) next.onclick = function () { if (page < totalPages) { page++; fallbackRender(page); } };
                            fallbackRender(page);
                        }
                    } catch (initErr) {

                    }
                } else {

                    setTimeout(function () {

                        initializeEvents();
                    }, 500);
                }
            } else {

            }
        }

        function showAuthorizationMessage() {

            var authDiv = document.createElement('div');
            authDiv.id = 'authMessage';
            authDiv.style = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; color: black; padding: 20px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3); z-index: 10000; text-align: center; max-width: 400px;';
            authDiv.innerHTML = '<h3>Authorization Required</h3><p>This app needs permission to access your calendar and user information.</p><button onclick="authorizeApp()" style="background: #4285f4; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin-top: 10px;">Authorize App</button>';
            document.body.appendChild(authDiv);
        }

        
        window.openResourceLink = function (url) {
            if (!url) return;
            window.open(url, '_blank', 'noopener,noreferrer');
        };

        function authorizeApp() {
            var webAppUrl = 'https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec';

            window.top.location.href = webAppUrl;
        }

        function setDateTime() {
            var now = new Date();
            var hour = now.getHours();


            var timeOfDay = 'morning';
            if (hour >= 12 && hour < 17) {
                timeOfDay = 'afternoon';
            } else if (hour >= 17) {
                timeOfDay = 'evening';
            }



            var dateElement = document.getElementById('currentDate');
            if (dateElement) {
                var options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                var formattedDate = now.toLocaleDateString('en-US', options);
                dateElement.textContent = formattedDate;

            } else {

            }
        }
    </script>
    
    <button id="bannerShowBtn" class="banner-show-btn" onclick="showBannerAgain()" title="Show announcements banner">
        <i class="fas fa-bullhorn"></i>
        <span>Show Banner</span>
    </button>


    
		    <header class="mobile-header">
		        <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Toggle menu">
		            <i class="fas fa-bars"></i>
		        </button>
		        <div class="logo-container" style="display: flex; align-items: center; gap: 8px;">
		            <svg class="hub-logo-svg" viewBox="0 0 768 768" role="img" aria-label="The Hub" style="height: 42px; width: 42px; opacity: 0.95;">
		                <use href="#hubLogoSymbol"></use>
		            </svg>
		            <span
		                style="font-size: 1.25rem; font-weight: 500; color: #101010; font-family: 'Google Sans Flex', 'Google Sans', 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;">The
		                Hub</span>
		        </div>
        <div style="width: 40px;"></div> 
    </header>

    
    <div class="sidebar-overlay" onclick="closeMobileMenu()"></div>

    <div class="app-container">
        
	        <aside class="sidebar" id="sidebar">
	            
		            <div class="sidebar-logo">
		                <div class="sidebar-logo-wrapper">
		                    <svg class="sidebar-logo-img hub-logo-svg" viewBox="0 0 768 768" role="img" aria-label="The Hub">
		                        <use href="#hubLogoSymbol"></use>
		                    </svg>
		                    <span class="sidebar-logo-text">The Hub</span>
		                </div>
		            </div>

            
                        <div class="nav-scroll-container">
                <nav class="nav-section">
                    <div class="nav-section-title">Jump to Section</div>

                    <div id="navigation-items">
                                                                        <a href="javascript:void(0)" class="nav-item active"
                            data-target="financial"
                            onclick="scrollToSection(event, 'financial'); return false;">
                            <span class="nav-icon"><i class="fa-solid fa-wallet"></i></span>
                            <span>
                                Financial                            </span>
                        </a>
                                                <a href="javascript:void(0)" class="nav-item"
                            data-target="human-resources"
                            onclick="scrollToSection(event, 'human-resources'); return false;">
                            <span class="nav-icon"><i class="fa-solid fa-users"></i></span>
                            <span>
                                Human Resources                            </span>
                        </a>
                                                <a href="javascript:void(0)" class="nav-item"
                            data-target="manuals-safety-forms"
                            onclick="scrollToSection(event, 'manuals-safety-forms'); return false;">
                            <span class="nav-icon"><i class="fa-solid fa-book"></i></span>
                            <span>
                                Manuals, Safety, &amp; Forms                            </span>
                        </a>
                                                                        <a href="javascript:void(0)" class="nav-item" data-target="team-section"
                            onclick="scrollToSection(event, 'team-section'); return false;">
                            <span class="nav-icon"><i class="fas fa-users"></i></span>
                            <span>Meet the Team</span>
                        </a>
                                                <a href="javascript:void(0)" class="nav-item" data-target="department-drive-section"
                            onclick="scrollToSection(event, 'department-drive-section'); return false;">
                            <span class="nav-icon"><i class="fas fa-folder-tree"></i></span>
                            <span>Department Drive</span>
                        </a>
                                                <a href="javascript:void(0)" class="nav-item" data-target="faq-section"
                            onclick="scrollToSection(event, 'faq-section'); return false;">
                            <span class="nav-icon"><i class="fas fa-question-circle"></i></span>
                            <span>FAQ</span>
                        </a>
                    </div>
                </nav>
                <div class="nav-scrollbar" aria-hidden="true">
                    <div class="nav-scrollbar-thumb"></div>
                </div>
            </div>

            
        </aside>

        
        <main class="main-content">
                        
            <div class="greeting-header department-hero">
                <div class="department-hero__inner">
                    <div class="department-hero__left">
                        <div class="department-hero__heading">
                            <h1 class="greeting-text" id="personalGreeting" style="margin: 0;">
                                <span class="greeting-time">
                                    Operations                                </span>
                            </h1>
                                                        <p class="department-subtitle" style="margin: 0;">
                                Welcome to the Operations Page!                            </p>
                                                    </div>
                                                <div class="department-description">
                            <p>
                                Operations equips centers with the tools, standards, and best practices needed to run a high-performing FASTSIGNS business. From workflow optimization to center performance insights, Operations helps owners and teams streamline processes, reduce friction, and deliver consistently great customer experiences.                            </p>
                        </div>
                                            </div>
                    <div class="department-hero__right">
                        <div class="department-support">
                            <div class="department-support-title">How to Reach Us</div>
                            <div class="department-support-grid" id="departmentSupportGrid" data-page-size="6">
                                                                <div
                                    class="support-card support-card--warm">
                                    <div class="support-card-title">
                                        <i class="fa-solid fa-map-location-dot"></i>
                                        <span>
                                            Business Consultants Support Map                                        </span>
                                    </div>
                                    <div class="support-card-body">
                                                                                                                                                                <div class="support-detail">
                                            <i class="fas fa-external-link-alt"></i>
                                            <a class="support-detail-action" href="https://www.google.com/maps/d/u/0/viewer?mid=1KgG-juSD2lflXosLRVrH7sOSfx8Q-po&amp;femb=1&amp;ll=38.27365931178652%2C-86.36921920892324&amp;z=6" target="_blank"
                                                rel="noopener">
                                                Open Map                                            </a>
                                        </div>
                                                                            </div>
                                </div>
                                                            </div>
                                                    </div>
                    </div>
                </div>
            </div>


            <div class="dashboard-grid">

                
                                                <section id="financial" class="card span-12">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fa-solid fa-wallet"></i>
                            Financial                        </h2>
                                            </div>
                    <div class="card-body">
                        <div class="resources-grid" id="financial-items">
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/sites.google.com\/fastsigns.com\/portal\/support-teams\/operations\/o-financial\/o-business-planning')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-chart-line icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://sites.google.com/fastsigns.com/portal/support-teams/operations/o-financial/o-business-planning"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Business Planning &amp; Cashflow Budget                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/sites.google.com\/fastsigns.com\/portal\/support-teams\/operations\/o-financial\/o-pricing')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-tags icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://sites.google.com/fastsigns.com/portal/support-teams/operations/o-financial/o-pricing"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Pricing Resources                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/sites.google.com\/fastsigns.com\/portal\/support-teams\/operations\/o-financial\/o-profitkeeper')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-calculator icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://sites.google.com/fastsigns.com/portal/support-teams/operations/o-financial/o-profitkeeper"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            ProfitKeeper                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/document\/d\/1HRadF1YjFIhj68VqODXsif7RY6MBeZNAOvGooqmZ99o\/copy')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-credit-card icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/document/d/1HRadF1YjFIhj68VqODXsif7RY6MBeZNAOvGooqmZ99o/copy"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Credit Application Example                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/sites.google.com\/fastsigns.com\/portal\/support-teams\/operations\/o-quickbooks')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-file-invoice-dollar icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://sites.google.com/fastsigns.com/portal/support-teams/operations/o-quickbooks"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            QuickBooks                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                    </div>
                    </div>
                </section>
                                <section id="human-resources" class="card span-12">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fa-solid fa-users"></i>
                            Human Resources                        </h2>
                                            </div>
                    <div class="card-body">
                        <div class="resources-grid" id="human-resources-items">
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/spreadsheets\/d\/1jnXxIAMyDU97mrWpJ97ZTvnqyXypcoTIk_zMj3Qe_lg\/copy')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-clipboard-user icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/spreadsheets/d/1jnXxIAMyDU97mrWpJ97ZTvnqyXypcoTIk_zMj3Qe_lg/copy"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Employee Evaluation Template                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/spreadsheets\/d\/1qKOhQfqQTiyAtvf0P6PXAYpJTe2pt15mEZ1IQ22DH0c\/copy')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-chart-line icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/spreadsheets/d/1qKOhQfqQTiyAtvf0P6PXAYpJTe2pt15mEZ1IQ22DH0c/copy"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Performance Improvement Plan Template                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/sites.google.com\/fastsigns.com\/portal\/support-teams\/operations\/o-human-resources\/o-hiring-recruitment')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-person-circle-plus icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://sites.google.com/fastsigns.com/portal/support-teams/operations/o-human-resources/o-hiring-recruitment"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Recruitment Resources                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/document\/d\/1FqpmNKUP-fPU4dxvzb0T61zfG_GrY8mehmekYWTiIXA\/copy')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-book-open icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/document/d/1FqpmNKUP-fPU4dxvzb0T61zfG_GrY8mehmekYWTiIXA/copy"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Employee Handbook                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/document\/d\/1x3s_OWv2gP0XyzRGksTkOmzzcpewuLhrUp5euYyjmjk\/copy')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-clipboard-question icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/document/d/1x3s_OWv2gP0XyzRGksTkOmzzcpewuLhrUp5euYyjmjk/copy"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Exit Interview Template                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                    </div>
                    </div>
                </section>
                                <section id="manuals-safety-forms" class="card span-12">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fa-solid fa-book"></i>
                            Manuals, Safety, &amp; Forms                        </h2>
                                            </div>
                    <div class="card-body">
                        <div class="resources-grid" id="manuals-safety-forms-items">
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/document\/d\/1nm-L1Trdl3mhMFOW0yXJeaQFp_Fm5OJZo6-S48lkL6Y\/edit?usp=sharing')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-book-open icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/document/d/1nm-L1Trdl3mhMFOW0yXJeaQFp_Fm5OJZo6-S48lkL6Y/edit?usp=sharing"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Operations Manual                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/drive.google.com\/drive\/folders\/15M9KWdHLd8-JF-1xmEIOeY6WwFfxzwAj?usp=sharing')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-vial-virus icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://drive.google.com/drive/folders/15M9KWdHLd8-JF-1xmEIOeY6WwFfxzwAj?usp=sharing"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            MSDS Sheets                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/document\/d\/1QA1yNtVKpARuHTzA3WOyG4pz0lzTwYbp0BDi3bVqjXg\/copy')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-shield-halved icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/document/d/1QA1yNtVKpARuHTzA3WOyG4pz0lzTwYbp0BDi3bVqjXg/copy"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            FASTSIGNS OSHA Safety Manual                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/document\/d\/1scD0fsKbEKGteH59vUqnxhz_oZ-C94kbrOFw4cTKJzY\/copy')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-file-contract icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/document/d/1scD0fsKbEKGteH59vUqnxhz_oZ-C94kbrOFw4cTKJzY/copy"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Terms &amp; Conditions (Example Warranty Form)                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/document\/d\/19mRl3nzpluiWm5Vduk9BBgBCMg1RNjgCRXWna7YC4nc\/copy')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-file-signature icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/document/d/19mRl3nzpluiWm5Vduk9BBgBCMg1RNjgCRXWna7YC4nc/copy"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Sub-Contractor Agreement                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/document\/d\/10trxfdW0W-C5JMAciuq3YOZYkdROAEP9DaknsE_P97E\/copy')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-file-contract icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/document/d/10trxfdW0W-C5JMAciuq3YOZYkdROAEP9DaknsE_P97E/copy"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Confidential Request for Contractor Information                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/document\/d\/1xLYgkJQTis6uTutH0BAqO1aJL8HK6xJiwUOw37Pm3vE\/edit?usp=sharing')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-user-tie icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/document/d/1xLYgkJQTis6uTutH0BAqO1aJL8HK6xJiwUOw37Pm3vE/edit?usp=sharing"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            General Manager/Key Management Employee Designation Form                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/docs.google.com\/document\/d\/1cXZGRCE3Y5KcC-4XUhHfIpS1GIfOjIIuoojzdDBSftk\/copy')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-file-contract icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://docs.google.com/document/d/1cXZGRCE3Y5KcC-4XUhHfIpS1GIfOjIIuoojzdDBSftk/copy"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Employment Offer Letter Template                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/drive.google.com\/file\/d\/1jUnk9o_soz9neiqTNAK1DjnHbV6ODfTK\/view?usp=sharing')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-file-signature icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://drive.google.com/file/d/1jUnk9o_soz9neiqTNAK1DjnHbV6ODfTK/view?usp=sharing"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Employment Application                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                        <div class="resource-card resource-card--has-action"
                                onclick="openResourceLink('https:\/\/drive.google.com\/drive\/folders\/1OQBi1CnaQ8ylj649QxzLH0nU02hps-1b?usp=sharing')" style="cursor: pointer;">
                                                                <div class="resource-icon resource-icon--thumbnail">
                                    <i class="fa-solid fa-clipboard-list icon-gradient"></i>
                                </div>
                                                                <div class="resource-card-content">
                                    <div class="resource-card-header">
                                                                                <a class="resource-title resource-title--link" href="https://drive.google.com/drive/folders/1OQBi1CnaQ8ylj649QxzLH0nU02hps-1b?usp=sharing"
                                            target="_blank" rel="noopener" onclick="event.stopPropagation();">
                                            Job Descriptions                                        </a>
                                                                                                                    </div>
                                                                    </div>
                            </div>
                                                    </div>
                    </div>
                </section>
                                
                
                
                <section id="team-section" class="card span-8">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-users"></i>
                            Meet the Team
                        </h2>
                    </div>
                    <div class="card-body">
                                                                        <div
                            class="team-section-group team-section-group--last">
                                                        <h3 class="team-section-title">
                                Team                            </h3>
                                                        <div class="team-grid team-grid-compact">
                                                                <div class="team-member-card">
                                    <div class="team-member-photo">
                                                                                <img loading="lazy" src="https://lh3.googleusercontent.com/a-/ALV-UjWBahwMB73jCmRwzgfA_A1FvfhTBfIIUIkCTOahsgIWlUUk7tnz=s80-p" alt="Dewey Johnson">
                                                                            </div>
                                    <div class="team-member-info">
                                        <h3 class="team-member-name">
                                            Dewey Johnson                                        </h3>
                                        <p class="team-member-title">
                                            Director of Operations                                        </p>
                                        <div class="team-member-contact">
                                                                                        <a href="mailto:dewey.johnson@propelledbrands.com" class="team-contact-item"
                                                title="Email Dewey Johnson">
                                                <i class="fas fa-envelope"></i>
                                                dewey.johnson@propelledbrands.com                                            </a>
                                                                                                                                </div>
                                                                            </div>
                                </div>
                                                                <div class="team-member-card">
                                    <div class="team-member-photo">
                                                                                <img loading="lazy" src="https://lh3.googleusercontent.com/a-/ALV-UjX3O3BiwWHKj2rA9GuQMKU-EXXKDw4q85dfOmFzA6a38OtZmmo=s80-p" alt="Doug Hall">
                                                                            </div>
                                    <div class="team-member-info">
                                        <h3 class="team-member-name">
                                            Doug Hall                                        </h3>
                                        <p class="team-member-title">
                                            Vice President of Operations                                        </p>
                                        <div class="team-member-contact">
                                                                                        <a href="mailto:doug.hall@propelledbrands.com" class="team-contact-item"
                                                title="Email Doug Hall">
                                                <i class="fas fa-envelope"></i>
                                                doug.hall@propelledbrands.com                                            </a>
                                                                                                                                </div>
                                                                            </div>
                                </div>
                                                            </div>
                        </div>
                                                                    </div>
                </section>

                
                <section id="department-drive-section" class="card span-4">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-folder-tree"></i>
                            Department Drive
                        </h2>
                    </div>
                    <div class="card-body">
                                                                        <div class="drive-embed-card">
                            <div class="drive-embed-card-header">
                                <div>
                                    <div class="drive-embed-title">
                                        Operations                                    </div>
                                                                    </div>
                                                                <a href="https://drive.google.com/drive/folders/1NhqITNqO0DI_N8wyDg2nw9tr7Kj2pwmL" target="_blank" rel="noopener"
                                    class="drive-embed-button">
                                    <i class="fas fa-external-link-alt"></i>
                                    Open in Drive                                </a>
                                                            </div>
                            <iframe src="https://drive.google.com/embeddedfolderview?id=1NhqITNqO0DI_N8wyDg2nw9tr7Kj2pwmL#list" class="drive-embed-frame" loading="lazy"
                                allowfullscreen title="Department Drive"></iframe>
                        </div>
                                            </div>
                </section>

                
                <section id="faq-section" class="card span-12">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-question-circle"></i>
                            Frequently Asked Questions
                        </h2>
                    </div>
                    <div class="card-body">
                        <div class="faq-accordion">
                                                    </div>
                    </div>
                </section>

            </div>
        </main>
    </div>

	    
	    <button id="geminiChatFab" class="wf-fab" type="button" onclick="openGeminiChat()"
	        aria-label="Open The Wayfinder chat" title="The Wayfinder">
	        <img class="wf-svg" src="https://storage.googleapis.com/resourcesite-publicassets-prod/wayfinder.svg"
	            alt="The Wayfinder" draggable="false" />
	        <span class="wf-fab__tooltip" aria-hidden="true">Need help finding the right resources or contacts?</span>
	    </button>
	
	    <div class="modal-overlay" id="geminiChatModal" role="dialog" aria-modal="true" aria-label="The Wayfinder"
	        onclick="if(event &amp;&amp; event.target===this){closeGeminiChat();}">
	        <div class="modal-content gemini-modal-content">
	            <div class="modal-header gemini-modal-header">
	                <h2 class="modal-title wayfinder-title">
	                    <span class="wayfinder-mark" aria-hidden="true">
	                        <i class="fas fa-compass icon-gradient"></i>
	                    </span>
	                    <span class="wayfinder-text">The Wayfinder</span>
	                </h2>
	                <a class="gemini-open-link" href="https://gemini.google.com/gem/b81304ff5653" target="_blank"
	                    rel="noopener noreferrer">Open in Gemini</a>
	                <button class="modal-close" type="button" onclick="closeGeminiChat()" aria-label="Close The Wayfinder">
	                    <i class="fas fa-times" aria-hidden="true"></i>
	                </button>
	            </div>
	            <div class="modal-body gemini-modal-body">
	                <div class="gemini-embed-fallback">
	                    The Wayfinder opens in a pop-out window. If it doesnt appear, allow pop-ups for this site or use
	                    <a href="https://gemini.google.com/gem/b81304ff5653" target="_blank"
	                        rel="noopener noreferrer">Open in Gemini</a>.
	                </div>
	                <div class="wayfinder-actions">
	                    <button type="button" class="primary-action stripe primary-action--block"
	                        onclick="openWayfinderPopup()">
	                        <i class="fas fa-compass" aria-hidden="true"></i>
	                        <span>Open The Wayfinder</span>
	                    </button>
	                </div>
	            </div>
	        </div>
	    </div>
	
	    <script>
	        (function () {
	            var GEMINI_GEM_URL = 'https://gemini.google.com/gem/b81304ff5653';
	
	            function openWayfinderPopup() {
	                var width = 1100;
	                var height = 820;
	                var left = Math.max(0, Math.round((window.screen.width - width) / 2));
	                var top = Math.max(0, Math.round((window.screen.height - height) / 2));
	
	                var features = [
	                    'popup=yes',
	                    'width=' + width,
	                    'height=' + height,
	                    'left=' + left,
	                    'top=' + top,
	                    'noopener',
	                    'noreferrer'
	                ].join(',');
	
	                var popup = null;
	                try {
	                    popup = window.open(GEMINI_GEM_URL, 'the_wayfinder', features);
	                    if (popup) {
	                        try { popup.opener = null; } catch (_) { }
	                        try { popup.focus(); } catch (_) { }
	                    }
	                } catch (_) {
	                    popup = null;
	                }
	
	                return popup;
	            }
	
	            window.openWayfinderPopup = function () {
	                return openWayfinderPopup();
	            };
	
	            window.openGeminiChat = function () {
	                var popup = openWayfinderPopup();
	                if (popup) return;
	
	                var modal = document.getElementById('geminiChatModal');
	                if (!modal) return;
	
	                modal.classList.add('active');
	                document.body.style.overflow = 'hidden';
	            };
	
	            window.closeGeminiChat = function () {
	                var modal = document.getElementById('geminiChatModal');
	                if (!modal) return;
	
	                modal.classList.remove('active');
	                document.body.style.overflow = '';
	            };
	
	            document.addEventListener('keydown', function (e) {
	                if (!e || e.key !== 'Escape') return;
	                var modal = document.getElementById('geminiChatModal');
	                if (modal && modal.classList.contains('active')) {
	                    window.closeGeminiChat();
	                }
	            });
	        })();
	    </script>
	
	    
    <div class="modal-overlay" id="newsModal"
        onclick="if(event &amp;&amp; event.target===this){try{closeModal()}catch(e){this.classList.remove('active');document.body.style.overflow='';}}">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Announcement</h2>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="modalBody">
                
            </div>
            <div class="modal-meta" id="modalMeta">
                
            </div>
        </div>
    </div>

    
    <div class="modal-overlay" id="archiveModal" onclick="if(event &amp;&amp; event.target===this){closeArchiveModal()}">
        <div class="modal-content archive-modal-content">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-archive"></i>
                    Archived Announcements
                </h2>
                <button class="modal-close" onclick="closeArchiveModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body archive-list" id="archiveList">
                
            </div>
        </div>
    </div>

    <script>
        var newsData = [];

        var bannerData = [];

        var currentPage = 1;
        const itemsPerPage = 3;

        function loadBanner() {

            try {
                if (typeof google !== 'undefined' && google.script && google.script.run) {
                    google.script.run
                        .withSuccessHandler(function (items) {
                            var count = Array.isArray(items) ? items.length : 0;

                            if (count > 0) {
                                bannerData = items.filter(function (item) {
                                    return item && item.text && item.active !== false;
                                }).map(function (b) {
                                    return {
                                        text: b.text || '',
                                        icon: b.icon || 'fa-info-circle',
                                        link: b.link || ''
                                    };
                                });

                                if (bannerData.length > 0) {
                                    saveToCache('banner', bannerData);
                                    displayBanner();
                                }
                            }
                        })
                        .withFailureHandler(function (error) {

                        })
                        .getBannerItems();
                } else {

                }
            } catch (e) {

            }
        }

        function displayBanner() {
            var dismissedTime = localStorage.getItem('bannerDismissed');
            if (dismissedTime) {
                var hoursSinceDismissed = (Date.now() - parseInt(dismissedTime)) / (1000 * 60 * 60);
                if (hoursSinceDismissed < 24) {

                    var showBtn = document.getElementById('bannerShowBtn');
                    if (showBtn) showBtn.classList.add('visible');
                    return; 
                }
            }

            var bannerContainer = document.getElementById('bannerContainer');
            var bannerScroll = document.getElementById('bannerScroll');

            if (!bannerContainer || !bannerScroll || bannerData.length === 0) {

                return;
            }



            var showBtn = document.getElementById('bannerShowBtn');
            if (showBtn) showBtn.classList.remove('visible');

	            function linkifyBannerText(text) {
	                var safeText = escapeHtml(text === undefined || text === null ? '' : String(text));
	                var urlRegex = /((?:https?:\/\/|www\.)[^\s<>]+)/gi;
	                return safeText.replace(urlRegex, function (match) {
	                    var urlText = match;
	                    var trailing = '';
	                    while (/[)\].,!?;:]+$/.test(urlText)) {
	                        trailing = urlText.slice(-1) + trailing;
	                        urlText = urlText.slice(0, -1);
	                    }
	                    var href = urlText;
	                    if (/^www\./i.test(href)) {
	                        href = 'https://' + href;
	                    }
	                    return '<a href="' + href + '" target="_blank" rel="noopener noreferrer">' + urlText + '</a>' + trailing;
	                });
	            }

	            var singleSetHTML = '';
	            bannerData.forEach(function (item) {
	                var iconClass = escapeHtml(item && item.icon ? String(item.icon) : '');
	                var rawText = item && item.text !== undefined ? item.text : '';
	                var escapedText = escapeHtml(rawText === undefined || rawText === null ? '' : String(rawText));
	                var linkifiedText = linkifyBannerText(rawText);
	                var rawLink = item && item.link ? String(item.link) : '';
	                var safeLink = rawLink ? escapeHtml(rawLink) : '';

	                var itemHTML = '<span class="banner-item">';
	                if (iconClass) {
	                    itemHTML += '<i class="fas ' + iconClass + ' banner-icon"></i>';
	                }
	                if (safeLink) {
	                    itemHTML += '<span class="banner-text"><a href="' + safeLink + '" target="_blank" rel="noopener noreferrer">' + escapedText + '</a></span>';
	                } else {
	                    itemHTML += '<span class="banner-text">' + linkifiedText + '</span>';
	                }
	                itemHTML += '</span>';
	                singleSetHTML += itemHTML;
	            });

	            var minRepetitions = Math.max(6, Math.ceil(4000 / Math.max(200, singleSetHTML.length)));

            var bannerHTML = '';
            for (var i = 0; i < minRepetitions; i++) {
                bannerHTML += singleSetHTML;
            }

            bannerScroll.innerHTML = bannerHTML;
            bannerContainer.classList.add('active');
            document.body.classList.add('has-banner');
        }

        function closeBanner() {
            var bannerContainer = document.getElementById('bannerContainer');
            if (bannerContainer) {
                bannerContainer.classList.remove('active');
                document.body.classList.remove('has-banner');
                localStorage.setItem('bannerDismissed', Date.now().toString());
                var showBtn = document.getElementById('bannerShowBtn');
                if (showBtn) showBtn.classList.add('visible');
            }
        }

        function forceShowBanner() {
            localStorage.removeItem('bannerDismissed');

            loadBanner();
        }

        function showBannerAgain() {
            localStorage.removeItem('bannerDismissed');
            var showBtn = document.getElementById('bannerShowBtn');
            if (showBtn) showBtn.classList.remove('visible');

            if (bannerData && bannerData.length > 0) {
                displayBanner();
            } else {
                loadBanner();
            }
        }

        function loadNews() {

            try {
                if (typeof google !== 'undefined' && google.script && google.script.run) {
                    google.script.run
                        .withSuccessHandler(function (items) {
                            var count = Array.isArray(items) ? items.length : 0;

                            if (count > 0) {
                                try {
                                    var allItems = items.map(function (n) {
                                        return {
                                            title: n && n.title ? n.title : 'Untitled Announcement',
                                            content: n && n.content ? n.content : '',
                                            fullContent: n && (n.fullContent || n.content) ? (n.fullContent || n.content) : '',
                                            date: n && n.date ? n.date : '',
                                            author: n && n.author ? n.author : '',
                                            priority: n && n.priority ? n.priority : 'normal',
                                            pinned: n && n.pinned ? n.pinned : false,
                                            archived: Boolean(n && n.archived),
                                            links: Array.isArray(n && n.links) ? n.links : [],
                                            attachments: Array.isArray(n && n.attachments) ? n.attachments : [],
                                            images: Array.isArray(n && n.images) ? n.images : []
                                        };
                                    });

                                    window.archivedNewsData = allItems.filter(function (item) { return item.archived; });
                                    newsData = allItems.filter(function (item) { return !item.archived; })
                                        .sort(function (a, b) {
                                            if (a.pinned && !b.pinned) return -1;
                                            if (!a.pinned && b.pinned) return 1;
                                            return 0;
                                        });
                                    currentPage = 1;
                                    initializeNews();
                                    updatePaginationButtons();
                                    updateNewsBadgeCount(newsData.length);
                                } catch (mapErr) {

                                }
                            } else {

                                updateNewsBadgeCount(0);
                            }
                        })
                        .withFailureHandler(function (error) {

                        })
                        .getNewsAnnouncements();
                } else {

                }
            } catch (e) {

            }
        }

        function updateNewsBadgeCount(count) {
            try {
                var els = document.querySelectorAll('nav.nav-section a[href="#news-section"] .nav-badge');
                for (var i = 0; i < els.length; i++) {
                    els[i].textContent = String(count);
                }
            } catch (_) { }
        }

        function initializeNews() {
            renderNews();
            updatePaginationButtons();
            setupEventDelegation();
        }

        function setupEventDelegation() {
            var newsContainer = document.getElementById('newsContainer');
            if (newsContainer && !newsContainer.hasListener) {
                newsContainer.addEventListener('click', function (e) {
                    var newsItem = e.target.closest('.news-item');
                    if (newsItem) {
                        var index = parseInt(newsItem.getAttribute('data-index'), 10);
                        if (!isNaN(index)) {
                            openModal(index);
                        }
                    }
                });
                newsContainer.hasListener = true;
            }

            var archiveList = document.getElementById('archiveList');
            if (archiveList && !archiveList.hasListener) {
                archiveList.addEventListener('click', function (e) {
                    var archiveItem = e.target.closest('.archive-item');
                    if (archiveItem) {
                        var index = parseInt(archiveItem.getAttribute('data-archive-index'), 10);
                        if (!isNaN(index)) {
                            openArchivedItem(index);
                        }
                    }
                });
                archiveList.hasListener = true;
            }
        }

        function renderNews(animate, direction) {
            animate = animate || false;
            direction = direction || 1;
            const container = document.getElementById('newsContainer');
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageItems = newsData.slice(startIndex, endIndex);

            const newContent = pageItems.map((item, index) => `
                <div class="news-item ${item.pinned ? 'pinned' : ''}" data-index="${startIndex + index}" style="cursor: pointer;">
                    ${item.pinned ? '<div class="pin-indicator"><i class="fas fa-thumbtack"></i> <span>Pinned</span></div>' : ''}
                    <h3 class="news-title">${item.title}</h3>
                    <p class="news-content">${item.content}</p>
                    <div class="news-meta">
                        <span><i class="far fa-calendar"></i> ${item.date}</span>
                    </div>
                </div>
            `).join('');

            if (animate) {
                const wrapper = document.createElement('div');
                wrapper.className = direction > 0 ? 'slide-in-right' : 'slide-in-left';
                wrapper.innerHTML = newContent;

                if (container.firstChild) {
                    container.firstChild.className = direction > 0 ? 'slide-out-left' : 'slide-out-right';
                    setTimeout(() => {
                        container.innerHTML = '';
                        container.appendChild(wrapper);
                    }, 200);
                } else {
                    container.appendChild(wrapper);
                }
            } else {
                container.innerHTML = newContent;
            }
        }

        function changePage(direction) {
            const totalPages = Math.ceil(newsData.length / itemsPerPage);
            const oldPage = currentPage;
            currentPage += direction;

            if (currentPage < 1) currentPage = 1;
            if (currentPage > totalPages) currentPage = totalPages;

            if (currentPage !== oldPage) {
                renderNews(true, direction);
                updatePaginationButtons();
            }
        }

        function updatePaginationButtons() {
            const totalPages = Math.ceil(newsData.length / itemsPerPage);
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const pageInfo = document.getElementById('pageInfo');

            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages;
            pageInfo.textContent = 'Page ' + currentPage + ' of ' + totalPages;
        }

        function escapeHtml(str) {
            try {
                return String(str)
                    .replace(/&/g, '&amp;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/"/g, '&quot;')
                    .replace(/'/g, '&#39;');
            } catch (_) { return ''; }
        }

        function applyInlineFormatting(text) {
            try {
                var s = text;
                s = s.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                s = s.replace(/\*(.*?)\*/g, '<em>$1</em>');
                return s;
            } catch (_) { return text; }
        }

        function linkify(text) {
            try {
                return text.replace(/(https?:\/\/[^\s<]+)/g, function (url) {
                    var safe = url.replace(/"/g, '%22');
                    return '<a href="' + safe + '" target="_blank" rel="noopener noreferrer">' + url + '</a>';
                });
            } catch (_) { return text; }
        }

        function formatAnnouncementContent(raw) {
            try {
                var text = escapeHtml(raw || '');
                var lines = text.split(/\r?\n/);
                var html = '';
                var inUL = false, inOL = false;
                var para = [];

                function flushPara() {
                    if (para.length) {
                        var p = para.join('<br>').trim();
                        p = applyInlineFormatting(p);
                        p = linkify(p);
                        html += '<p>' + p + '</p>';
                        para = [];
                    }
                }
                function openUL() { if (!inUL) { html += '<ul>'; inUL = true; } }
                function closeUL() { if (inUL) { html += '</ul>'; inUL = false; } }
                function openOL() { if (!inOL) { html += '<ol>'; inOL = true; } }
                function closeOL() { if (inOL) { html += '</ol>'; inOL = false; } }

                for (var i = 0; i < lines.length; i++) {
                    var line = lines[i];
                    var trimmed = line.trim();
                    if (!trimmed) {
                        flushPara();
                        closeUL();
                        closeOL();
                        continue;
                    }
                    var mNum = trimmed.match(/^(\d+)\.\s+(.*)$/);
                    var mBul = trimmed.match(/^[-*]\s+(.*)$/);
                    if (mNum) {
                        flushPara();
                        closeUL();
                        openOL();
                        var item = applyInlineFormatting(escapeHtml(mNum[2]));
                        item = linkify(item);
                        html += '<li>' + item + '</li>';
                        continue;
                    } else if (mBul) {
                        flushPara();
                        closeOL();
                        openUL();
                        var bi = applyInlineFormatting(escapeHtml(mBul[1]));
                        bi = linkify(bi);
                        html += '<li>' + bi + '</li>';
                        continue;
                    }
                    para.push(trimmed);
                }
                flushPara();
                closeUL();
                closeOL();
                if (!html) {
                    html = '<p>' + linkify(applyInlineFormatting(text)) + '</p>';
                }
                return html;
            } catch (e) {
                return escapeHtml(raw || '').replace(/\n/g, '<br>');
            }
        }

        function openModal(index) {
            const item = newsData[index] || {};
            const modal = document.getElementById('newsModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            const modalMeta = document.getElementById('modalMeta');

            modalTitle.textContent = item.title || 'Announcement';
            var safeContent = formatAnnouncementContent(item.fullContent || item.content || '');
            modalBody.innerHTML = safeContent; 
            var attachHtml = '';
            try {
                var imgs = Array.isArray(item.images) ? item.images : [];
                var links = Array.isArray(item.links) ? item.links : [];
                var files = Array.isArray(item.attachments) ? item.attachments.filter(function (a) { return a && a.type !== 'image'; }) : [];

                var contentText = (item.fullContent || item.content || '').toLowerCase();
                links = links.filter(function (link) {
                    if (!link) return false;

                    var normalizedLink = link.toLowerCase()
                        .replace(/^https?:\/\//, '')  
                        .replace(/^www\./, '')         
                        .replace(/\/$/, '');           

                    return contentText.indexOf(normalizedLink) === -1;
                });

                if (imgs.length || links.length || files.length) {
                    attachHtml += '<div class="news-attachments">';
                    if (imgs.length) {
                        attachHtml += '<h4>Images</h4><div class="news-images">';
                        for (var i = 0; i < imgs.length && i < 8; i++) {
                            var src = imgs[i];
                            attachHtml += '<a href="' + src + '" target="_blank" rel="noopener noreferrer">'
                                + '<img loading="lazy" src="' + src + '" alt="image"></a>';
                        }
                        attachHtml += '</div>';
                    }
                    var linkItems = links.slice();
                    for (var j = 0; j < files.length; j++) {
                        if (files[j] && files[j].url) linkItems.push(files[j].url);
                    }
                    if (linkItems.length) {
                        attachHtml += '<h4>Links & Files</h4><div class="news-links">';
                        for (var k = 0; k < linkItems.length && k < 10; k++) {
                            var lu = linkItems[k];
                            var label = lu.replace(/^https?:\/\//, '');
                            attachHtml += '<a href="' + lu + '" target="_blank" rel="noopener noreferrer">' + label + '</a>';
                        }
                        attachHtml += '</div>';
                    }
                    attachHtml += '</div>';
                }
            } catch (e) {   }
            if (attachHtml) {
                modalBody.innerHTML += attachHtml;
            }
            var metaHtml = '';
            if (item.date) metaHtml += '<span><i class="far fa-calendar"></i> ' + item.date + '</span> ';
            if (item.author) metaHtml += '<span><i class="far fa-user"></i> ' + item.author + '</span>';
            modalMeta.innerHTML = metaHtml;

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            const modal = document.getElementById('newsModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function showArchive() {
            const modal = document.getElementById('archiveModal');
            const archiveList = document.getElementById('archiveList');

            archiveList.innerHTML = '';

            const archivedItems = window.archivedNewsData || [];

            if (archivedItems.length === 0) {
                archiveList.innerHTML = `
                    <div class="archive-empty">
                        <i class="fas fa-archive"></i>
                        <p>No archived announcements</p>
                    </div>
                `;
            } else {
                archivedItems.forEach(function (item, index) {
                    const archiveItem = document.createElement('div');
                    archiveItem.className = 'archive-item';
                    archiveItem.onclick = function () { openArchivedItem(index); };

                    archiveItem.innerHTML = `
                        <div class="archive-item-header">
                            <h3 class="archive-item-title">${escapeHtml(item.title || 'Untitled')}</h3>
                            <span class="archive-item-date">${escapeHtml(item.date || '')}</span>
                        </div>
                        <div class="archive-item-content">${escapeHtml(item.content || '')}</div>
                        ${item.author ? `
                            <div class="archive-item-meta">
                                <span><i class="fas fa-user"></i> ${escapeHtml(item.author)}</span>
                            </div>
                        ` : ''}
                    `;

                    archiveList.appendChild(archiveItem);
                });
            }

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeArchiveModal() {
            const modal = document.getElementById('archiveModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }

        function openArchivedItem(index) {
            const item = window.archivedNewsData[index] || {};
            const modal = document.getElementById('newsModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            const modalMeta = document.getElementById('modalMeta');

            closeArchiveModal();

            modalTitle.textContent = item.title || 'Archived Announcement';
            var safeContent = formatAnnouncementContent(item.fullContent || item.content || '');
            modalBody.innerHTML = safeContent; 

            var attachHtml = '';
            try {
                var imgs = Array.isArray(item.images) ? item.images : [];
                var links = Array.isArray(item.links) ? item.links : [];
                var files = Array.isArray(item.attachments) ? item.attachments.filter(function (a) { return a && a.type !== 'image'; }) : [];

                var contentText = (item.fullContent || item.content || '').toLowerCase();
                links = links.filter(function (link) {
                    if (!link) return false;

                    var normalizedLink = link.toLowerCase()
                        .replace(/^https?:\/\//, '')  
                        .replace(/^www\./, '')         
                        .replace(/\/$/, '');           

                    return contentText.indexOf(normalizedLink) === -1;
                });

                if (imgs.length || links.length || files.length) {
                    attachHtml += '<div class="news-attachments">';
                    if (imgs.length) {
                        attachHtml += '<h4>Images</h4><div class="news-images">';
                        for (var i = 0; i < imgs.length && i < 8; i++) {
                            var src = imgs[i];
                            attachHtml += '<a href="' + src + '" target="_blank" rel="noopener noreferrer">'
                                + '<img loading="lazy" src="' + src + '" alt="image"></a>';
                        }
                        attachHtml += '</div>';
                    }
                    if (files.length) {
                        attachHtml += '<h4>Attachments</h4><div class="news-files">';
                        for (var j = 0; j < files.length; j++) {
                            var f = files[j];
                            attachHtml += '<a href="' + f.url + '" target="_blank" rel="noopener noreferrer" class="news-file-link">'
                                + '<i class="fas fa-file"></i> ' + (f.name || 'File ' + (j + 1)) + '</a>';
                        }
                        attachHtml += '</div>';
                    }
                    if (links.length) {
                        attachHtml += '<h4>Links</h4><div class="news-links">';
                        for (var k = 0; k < links.length; k++) {
                            var lnk = links[k];
                            attachHtml += '<a href="' + lnk + '" target="_blank" rel="noopener noreferrer" class="news-link">'
                                + '<i class="fas fa-link"></i> ' + lnk + '</a>';
                        }
                        attachHtml += '</div>';
                    }
                    attachHtml += '</div>';
                }
            } catch (e) { }
            if (attachHtml) modalBody.innerHTML += attachHtml;

            const metaItems = [];
            if (item.date) metaItems.push(`<span><i class="far fa-calendar"></i> ${escapeHtml(item.date)}</span>`);
            if (item.author) metaItems.push(`<span><i class="far fa-user"></i> ${escapeHtml(item.author)}</span>`);
            metaItems.push(`<span><i class="fas fa-archive"></i> Archived</span>`);
            modalMeta.innerHTML = metaItems.join(' ');

            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        document.addEventListener('click', function (event) {
            const modal = document.getElementById('newsModal');
            if (event.target === modal) {
                closeModal();
            }
        });

        document.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        });

        var eventsData = []; 


        function toggleDepartment(index, event) {


            if (event) {
                event.stopPropagation();

            }

            const card = document.querySelector(`[data-department-id="${index}"]`);
            if (!card) {

                return;
            }



            const isExpanding = !card.classList.contains('expanded');

            document.querySelectorAll('.department-card.expanded').forEach(otherCard => {
                if (otherCard !== card) {
                    otherCard.classList.add('collapsing');
                    otherCard.classList.remove('expanded');
                    setTimeout(() => {
                        otherCard.classList.remove('collapsing');
                    }, 500);
                }
            });

            if (isExpanding) {
                card.classList.add('expanded');
            } else {
                card.classList.add('collapsing');
                card.classList.remove('expanded');
                setTimeout(() => {
                    card.classList.remove('collapsing');
                }, 500);
            }

            if (isExpanding) {
                setTimeout(() => {
                    card.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            }
        }

        document.addEventListener('click', function (event) {
            if (!event.target.closest('.department-card')) {
                document.querySelectorAll('.department-card.expanded').forEach(card => {
                    card.classList.add('collapsing');
                    card.classList.remove('expanded');
                    setTimeout(() => {
                        card.classList.remove('collapsing');
                    }, 500);
                });
            }
        });

        var currentEventPage = 1;
        const eventsPerPage = 4; 

        function initializeEvents() {

            try {
                renderEvents();

                updateEventPaginationButtons();

            } catch (e) {




                try {
                    var container = document.getElementById('eventsContainer');
                    if (container && eventsData.length > 0) {
                        var simpleHTML = '';
                        for (var i = 0; i < Math.min(3, eventsData.length); i++) {
                            simpleHTML += '<div class="event-item">' +
                                '<div class="event-date">' + eventsData[i].date + '</div>' +
                                '<div class="event-title">' + eventsData[i].title + '</div>' +
                                '<div class="event-meta">' + eventsData[i].time + '</div>' +
                                '</div>';
                        }
                        container.innerHTML = simpleHTML;

                    }
                } catch (fallbackError) {

                }
            }
        }

        function renderEvents(animate, direction) {
            if (typeof animate === 'undefined') animate = false;
            if (typeof direction === 'undefined') direction = 1;

            var container = document.getElementById('eventsContainer');
            if (!container) {

                return;
            }
            var startIndex = (currentEventPage - 1) * eventsPerPage;
            var endIndex = startIndex + eventsPerPage;
            var pageEvents = eventsData.slice(startIndex, endIndex);


            var eventsHTML = '';
            for (var i = 0; i < pageEvents.length; i++) {
                var event = pageEvents[i];
                var globalIndex = startIndex + i;
                var meta = (event.time || 'TBD') + '  ' + (event.type || 'Virtual') + '  ' + (event.audience || 'All franchisees');
                eventsHTML += '<div class="event-item">' +
                    '<div class="event-date">' + (event.date || 'TBD') + '</div>' +
                    '<div class="event-title">' + (event.title || 'Untitled Event') + '</div>' +
                    '<div class="event-meta">' + meta + '</div>' +
                    '<div class="event-actions">' +
                    '<button class="event-btn primary-action stripe" onclick="addToCalendar(' + globalIndex + ')">' +
                    '<i class="fas fa-calendar-plus"></i> Add to Calendar' +
                    '</button>' +
                    '<button class="event-btn primary-action stripe" onclick="shareEvent(' + globalIndex + ')">' +
                    '<i class="fas fa-share-alt"></i> Share' +
                    '</button>' +
                    '</div>' +
                    '</div>';
            }

            var emptySlots = eventsPerPage - pageEvents.length;
            for (var i = 0; i < emptySlots; i++) {
                eventsHTML += '<div style="flex: 0 0 auto; min-height: 130px;"></div>';
            }

            if (animate) {
                var wrapper = document.createElement('div');
                wrapper.style.width = '100%';
                wrapper.className = direction > 0 ? 'slide-in-right' : 'slide-in-left';
                wrapper.innerHTML = eventsHTML;

                if (container.firstChild) {
                    container.firstChild.className = direction > 0 ? 'slide-out-left' : 'slide-out-right';
                    setTimeout(function () {
                        container.innerHTML = '';
                        container.appendChild(wrapper);
                    }, 200);
                } else {
                    container.appendChild(wrapper);
                }
            } else {

                container.innerHTML = eventsHTML;

            }

            applyPrimaryActionClasses(container);
        }

        function changeEventPage(direction) {
            const totalPages = Math.ceil(eventsData.length / eventsPerPage);
            const oldPage = currentEventPage;
            currentEventPage += direction;

            if (currentEventPage < 1) currentEventPage = 1;
            if (currentEventPage > totalPages) currentEventPage = totalPages;

            if (currentEventPage !== oldPage) {
                renderEvents(true, direction);
                updateEventPaginationButtons();
            }
        }

        function updateEventPaginationButtons() {
            var totalPages = Math.ceil(eventsData.length / eventsPerPage) || 1;
            var prevBtn = document.getElementById('eventPrevBtn');
            var nextBtn = document.getElementById('eventNextBtn');
            var pageInfo = document.getElementById('eventPageInfo');

            if (prevBtn) prevBtn.disabled = currentEventPage === 1;
            if (nextBtn) nextBtn.disabled = currentEventPage === totalPages;
            if (pageInfo) pageInfo.textContent = 'Page ' + currentEventPage + ' of ' + totalPages;
        }

        function addToCalendar(index) {
            try {
                var event = eventsData[index];
                var googleCalendarUrl = 'https://calendar.google.com/calendar/render?action=TEMPLATE&text=' + encodeURIComponent(event.title || '') + '&details=' + encodeURIComponent(event.description || '') + '&location=' + encodeURIComponent(event.type || '');
                if (event && event.datesParam) {
                    googleCalendarUrl += '&dates=' + encodeURIComponent(event.datesParam);
                }
                window.open(googleCalendarUrl, '_blank', 'noopener,noreferrer');
            } catch (error) {

            }
        }

        function shareEvent(index) {
            try {
                var ev = eventsData[index] || {};
                var base = 'https://calendar.google.com/calendar/render?action=TEMPLATE';
                var url = base + '&text=' + encodeURIComponent(ev.title || '') + '&details=' + encodeURIComponent((ev.description || '') + '\n\nEvent Type: ' + (ev.type || '') + '\nAudience: ' + (ev.audience || '')) + '&location=' + encodeURIComponent(ev.type || '');
                if (ev.datesParam) { url += '&dates=' + encodeURIComponent(ev.datesParam); }
                var btn = (window.event && (window.event.target || window.event.srcElement)) || null;
                var el = btn && btn.closest ? btn.closest('.event-btn') : null;

                if (navigator.clipboard && navigator.clipboard.writeText) {
                    navigator.clipboard.writeText(url).then(function () {
                        showShareSuccess(el);
                    }).catch(function () {
                        fallbackShareCopy(url, el);
                    });
                } else {
                    fallbackShareCopy(url, el);
                }
            } catch (error) {

            }
        }

        function fallbackShareCopy(text, el) {
            var textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            textarea.style.opacity = '0';
            textarea.style.pointerEvents = 'none';
            document.body.appendChild(textarea);
            textarea.select();
            try {
                document.execCommand('copy');
                showShareSuccess(el);
            } catch (e) {
                prompt('Copy this link:', text);
            }
            document.body.removeChild(textarea);
        }

        function showShareSuccess(el) {
            if (el) {
                var original = el.innerHTML;
                el.innerHTML = '<i class="fas fa-check"></i> Link Copied!';
                el.style.background = 'var(--primary)';
                el.style.color = 'var(--bg-base)';
                setTimeout(function () {
                    el.innerHTML = original;
                    el.style.background = '';
                    el.style.color = '';
                }, 2000);
            }
        }

        function applyPrimaryActionClasses(context) {
            var root = context || document;
            var targets = [
                { selector: '.calendar-view-btn', classes: ['primary-action', 'stripe', 'primary-action--small'] },
                { selector: '.embed-btn', classes: ['primary-action', 'stripe', 'primary-action--compact'] },
                { selector: '.department-page-btn', classes: ['primary-action', 'stripe'] },
                { selector: '.department-btn', classes: ['primary-action', 'stripe', 'primary-action--compact'] },
                { selector: '.event-btn', classes: ['primary-action', 'stripe', 'primary-action--compact'] },
                { selector: '.modal-action.primary-action', classes: ['primary-action', 'stripe', 'primary-action--compact'] }
            ];
            targets.forEach(function (cfg) {
                root.querySelectorAll(cfg.selector).forEach(function (el) {
                    cfg.classes.forEach(function (cls) { el.classList.add(cls); });
                });
            });
        }

        function viewFullCalendar() {
            const calendarUrl = 'https://calendar.google.com/calendar/embed?src=fastsigns.com_2r9u352pf43qiv9nrh4o78eo58%40group.calendar.google.com&ctz=America%2FNew_York';
            window.open(calendarUrl, '_blank', 'noopener,noreferrer');
        }

        var departmentsData = [];
        function loadDepartments() {

            try {
                if (typeof google !== 'undefined' && google.script && google.script.run) {
                    google.script.run
                        .withSuccessHandler(function (departments) {

                            if (departments && departments.length > 0) {
                                departmentsData = departments;
                                saveToCache('departments', departments);
                                renderDepartments();
                            }
                        })
                        .withFailureHandler(function (error) {

                        })
                        .getDepartments();
                } else {

                }
            } catch (e) {

            }
        }

        function renderDepartments() {
            var container = document.getElementById('departments-items');
            if (!container || departmentsData.length === 0) return;

            var html = '';
            departmentsData.forEach(function (dept, index) {
                html += '<div class="department-card" data-department-id="' + index + '" data-clickable="true">';
                html += '  <div class="department-header">';
                html += '    <div class="department-icon">';
                html += '      <i class="fas ' + (dept.icon || 'fa-building') + ' icon-gradient"></i>';
                html += '    </div>';
                html += '    <div class="department-name">' + escapeHtml(dept.name) + '</div>';
                html += '    <div class="department-description">' + escapeHtml(dept.description) + '</div>';
                html += '    <div class="department-arrow">';
                html += '      <i class="fas fa-chevron-down"></i>';
                html += '    </div>';
                html += '  </div>';
                html += '  <div class="department-content">';

                if (dept.contacts && dept.contacts.length > 0) {
                    html += '    <div class="department-contact">';

                    var contactGroups = {};
                    dept.contacts.forEach(function (contact) {
                        if (!contactGroups[contact.label]) {
                            contactGroups[contact.label] = [];
                        }
                        contactGroups[contact.label].push(contact);
                    });

                    for (var label in contactGroups) {
                        html += '      <div class="contact-section">';
                        html += '        <strong>' + escapeHtml(label) + '</strong>';

                        contactGroups[label].forEach(function (contact) {
                            html += '        <div class="contact-item">';
                            if (contact.type === 'email') {
                                html += '          <i class="fas fa-envelope"></i>';
                                html += '          <a href="mailto:' + contact.value + '" title="Email ' + escapeHtml(contact.label || dept.name) + '">' + escapeHtml(contact.value) + '</a>';
                            } else {
                                html += '          <i class="fas fa-phone"></i>';
                                var cleanPhone = contact.value.replace(/\D/g, ''); 
                                html += '          <a href="tel:' + cleanPhone + '" title="Call ' + escapeHtml(contact.label || dept.name) + '">' + escapeHtml(contact.value) + '</a>';
                            }
                            html += '        </div>';
                        });

                        html += '      </div>';
                    }

                    html += '    </div>';
                }

                if (dept.teamMembers && dept.teamMembers.length > 0) {
                    html += '    <div class="department-team">';
                    html += '      <h4><i class="fas fa-users"></i> Team Members</h4>';
                    html += '      <div class="team-members">';

                    dept.teamMembers.forEach(function (member) {
                        html += '        <div class="team-member">';
                        html += '          <span class="member-name">' + escapeHtml(member.name) + '</span>';
                        if (member.role) {
                            html += '          <span class="member-role">' + escapeHtml(member.role) + '</span>';
                        }
                        if (member.phone) {
                            html += '          <a href="tel:' + member.phone.replace(/\D/g, '') + '" class="member-phone" title="Call ' + escapeHtml(member.name) + '">';
                            html += '            <i class="fas fa-phone"></i> ' + escapeHtml(member.phone);
                            html += '          </a>';
                        }
                        if (member.email) {
                            html += '          <a href="mailto:' + member.email + '" class="member-email" title="Email ' + escapeHtml(member.name) + '">';
                            html += '            <i class="fas fa-envelope"></i> ' + escapeHtml(member.email);
                            html += '          </a>';
                        }
                        html += '        </div>';
                    });

                    html += '      </div>';
                    html += '    </div>';
                }

                if (dept.pageUrl) {
                    html += '    <div class="department-action">';
                    html += '      <button class="department-page-btn primary-action stripe" data-url="' + escapeHtml(dept.pageUrl) + '">';
                    html += '        <i class="fas fa-arrow-right"></i> Go to ' + escapeHtml(dept.name) + ' Page';
                    html += '      </button>';
                    html += '    </div>';
                }

                html += '  </div>';
                html += '</div>';
            });

            container.innerHTML = html;

            applyPrimaryActionClasses(container);

            setupDepartmentHandlers();
        }

        function setupDepartmentHandlers() {
            var cards = document.querySelectorAll('.department-card');
            cards.forEach(function (card) {
                card.addEventListener('click', function (e) {
                    if (e.target.tagName === 'A' || e.target.tagName === 'BUTTON' || e.target.closest('a') || e.target.closest('button')) {
                        return;
                    }

                    var id = this.getAttribute('data-department-id');
                    toggleDepartment(parseInt(id), e);
                });
            });
        }

        function visitDepartment(department) {

            alert(`Opening ${department.replace('-', ' ')} department page...`);
        }

        function toggleFAQ(button) {
            try {
                if (!button) {
                    return;
                }

                var answer = button.nextElementSibling;
                var isActive = button.classList.contains('active');

                var openQuestions = document.querySelectorAll('.faq-question.active');
                Array.prototype.forEach.call(openQuestions, function (other) {
                    if (other !== button) {
                        other.classList.remove('active');
                        var otherAnswer = other.nextElementSibling;
                        if (otherAnswer) {
                            otherAnswer.classList.remove('active');
                        }
                    }
                });

                if (isActive) {
                    button.classList.remove('active');
                    if (answer) {
                        answer.classList.remove('active');
                    }
                } else {
                    button.classList.add('active');
                    if (answer) {
                        answer.classList.add('active');
                    }
                }
            } catch (error) {

            }
        }

        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.sidebar-overlay');

            if (sidebar.classList.contains('active')) {
                closeMobileMenu();
            } else {
                sidebar.classList.add('active');
                overlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.sidebar-overlay');

            sidebar.classList.remove('active');
            overlay.classList.remove('active');
            document.body.style.overflow = '';
        }

        function scrollToSection(evt, sectionId) {


            scrollSpyDisabledUntil = Date.now() + 2000;

            try {
                if (evt && evt.preventDefault) {
                    evt.preventDefault();

                }

                var navItems = document.querySelectorAll('.nav-item');
                navItems.forEach(function (item) {
                    item.classList.remove('active');
                });

                var clickedItem = null;

                if (evt && evt.currentTarget) {
                    clickedItem = evt.currentTarget;
                } else if (evt && evt.target) {
                    clickedItem = evt.target.closest('.nav-item');
                }

                if (!clickedItem) {
                    navItems.forEach(function (item) {
                        if (item.getAttribute('data-target') === sectionId ||
                            item.getAttribute('href') === '#' + sectionId) {
                            clickedItem = item;
                        }
                    });
                }

                if (clickedItem) {
                    clickedItem.classList.add('active');

                } else {

                }

                if (window.innerWidth <= 768) {
                    closeMobileMenu();
                }

	                var section = document.getElementById(sectionId);
	                if (section) {
	
	                    var prefersReduced = false;
	                    try {
	                        prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
	                    } catch (_) { }
	
	                    var embeddedScroller = null;
	                    try {
	                        if (document.documentElement.classList.contains('is-embedded')) {
	                            embeddedScroller = document.querySelector('.app-container');
	                        }
	                    } catch (_) { }
	                    var useElementScroller = !!(embeddedScroller && embeddedScroller.scrollTop !== undefined);
	
	                    if (!section.scrollIntoView || !('scrollBehavior' in document.documentElement.style)) {
	                        var targetPosition = 0;
	                        var startPosition = 0;
	
	                        if (useElementScroller) {
	                            var containerRect = embeddedScroller.getBoundingClientRect();
	                            var sectionRect = section.getBoundingClientRect();
	                            targetPosition = embeddedScroller.scrollTop + (sectionRect.top - containerRect.top);
	                            startPosition = embeddedScroller.scrollTop;
	                        } else {
	                            var currentScroll = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
	                            targetPosition = currentScroll + section.getBoundingClientRect().top;
	                            startPosition = currentScroll;
	                        }
	
	                        var distance = targetPosition - startPosition;
	                        var duration = prefersReduced ? 0 : 600;
	                        var start = null;
	
	                        function performScroll(position) {
	                            if (useElementScroller) {
	                                embeddedScroller.scrollTop = position;
	                                return;
	                            }
	
	                            if (window.scrollTo) window.scrollTo(0, position);
	                            if (document.documentElement && document.documentElement.scrollTop !== undefined) document.documentElement.scrollTop = position;
	                            if (document.body && document.body.scrollTop !== undefined) document.body.scrollTop = position;
	                        }

                        function animation(currentTime) {
                            if (start === null) start = currentTime;
                            var timeElapsed = currentTime - start;
                            var progress = Math.min(timeElapsed / duration, 1);

                            var ease = progress < 0.5
                                ? 2 * progress * progress
                                : 1 - Math.pow(-2 * progress + 2, 2) / 2;

                            var newPosition = startPosition + distance * ease;
                            performScroll(newPosition);

                            if (timeElapsed < duration) {
                                requestAnimationFrame(animation);
                            }
                        }

	                        if (duration > 0 && typeof requestAnimationFrame !== 'undefined') {
	                            requestAnimationFrame(animation);
	                        } else {
	                            performScroll(targetPosition);
	                        }
	                    } else {
	                        section.scrollIntoView({ behavior: prefersReduced ? 'auto' : 'smooth', block: 'start' });
	                    }
	                }

                try {
                    var items = document.querySelectorAll('.nav-item');
                    for (var i = 0; i < items.length; i++) {
                        items[i].classList.remove('active');
                    }

                    var targetNav = document.querySelector('.nav-item[data-target="' + sectionId + '"]');
                    if (!targetNav) {
                        targetNav = document.querySelector('.nav-item[href="#' + sectionId + '"]');
                    }
                    if (targetNav) {
                        targetNav.classList.add('active');
                    }
                } catch (e) {

                }
            } catch (e) {

            }
            return false;
        }


        function toggleCompactView() {
            const isCompact = document.getElementById('compactView').checked;
            if (isCompact) {
                document.documentElement.style.setProperty('--space-4', '0.5rem');
                document.documentElement.style.setProperty('--space-6', '0.75rem');
                document.documentElement.style.setProperty('--space-8', '1rem');
            } else {
                document.documentElement.style.setProperty('--space-4', '1rem');
                document.documentElement.style.setProperty('--space-6', '1.5rem');
                document.documentElement.style.setProperty('--space-8', '2rem');
            }
        }

        function toggleHideRead() {
            const hideRead = document.getElementById('hideRead').checked;

        }

        function refreshData() {
            const btn = event.target.closest('.sidebar-action-btn');
            const originalContent = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> <span>Refreshing...</span>';

            setTimeout(() => {
                btn.innerHTML = originalContent;
            }, 1500);
        }

        function exportReport() {

        }

        function openSettings() {

        }

        var dailyQuotes = [
            { text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
            { text: "The way to get started is to quit talking and begin doing.", author: "Walt Disney" },
            { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
            { text: "The future belongs to those who believe in the beauty of their dreams.", author: "Eleanor Roosevelt" },
            { text: "It always seems impossible until it's done.", author: "Nelson Mandela" },
            { text: "Success is walking from failure to failure with no loss of enthusiasm.", author: "Winston Churchill" },
            { text: "Opportunities don't happen. You create them.", author: "Chris Grosser" },
            { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
            { text: "Innovation distinguishes between a leader and a follower.", author: "Steve Jobs" },
            { text: "The best time to plant a tree was 20 years ago. The second best time is now.", author: "Chinese Proverb" },
            { text: "Your time is limited, don't waste it living someone else's life.", author: "Steve Jobs" },
            { text: "The harder you work for something, the greater you'll feel when you achieve it.", author: "Anonymous" },
            { text: "Dream bigger. Do bigger.", author: "Anonymous" },
            { text: "Success doesn't just find you. You have to go out and get it.", author: "Anonymous" },
            { text: "Great things never come from comfort zones.", author: "Anonymous" },
            { text: "Dream it. Wish it. Do it.", author: "Anonymous" },
            { text: "Success is the sum of small efforts repeated day in and day out.", author: "Robert Collier" },
            { text: "The key to success is to focus on goals, not obstacles.", author: "Anonymous" },
            { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
            { text: "A goal without a plan is just a wish.", author: "Antoine de Saint-Exupry" },
            { text: "Quality is not an act, it is a habit.", author: "Aristotle" },
            { text: "The sign of a beautiful person is that they always see beauty in others.", author: "Omar Suleiman" },
            { text: "Your customers' perception is your reality.", author: "Kate Zabriskie" },
            { text: "Business has only two functions  marketing and innovation.", author: "Milan Kundera" },
            { text: "Every sale has five basic obstacles: no need, no money, no hurry, no desire, no trust.", author: "Zig Ziglar" }
        ];

        function setDailyQuote() {
            if (typeof google !== 'undefined' && google.script && google.script.run) {

                google.script.run
                    .withSuccessHandler(function (quoteData) {
                        if (quoteData && quoteData.quote) {

                            updateQuoteDisplay(quoteData.quote, quoteData.author);
                        } else {

                            setLocalQuote();
                        }
                    })
                    .withFailureHandler(function (error) {

                        setLocalQuote();
                    })
                    .getDailyQuote();
            } else {
                setLocalQuote();
            }
        }

        function setLocalQuote() {
            var today = new Date();
            var dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / 86400000);
            var quoteIndex = dayOfYear % dailyQuotes.length;
            var quote = dailyQuotes[quoteIndex];

            if (quote) {
                updateQuoteDisplay(quote.text, quote.author);
            }
        }

        function updateQuoteDisplay(quoteText, author) {
            var quoteElement = document.getElementById('dailyQuote');
            var authorElement = document.getElementById('quoteAuthor');

            if (quoteElement) {
                quoteElement.textContent = quoteText;
            }
            if (authorElement) {
                authorElement.textContent = ' ' + author;
            }
        }

        function initializeGreeting() {
            const hour = new Date().getHours();
            var timeOfDay = 'morning';
            if (hour >= 12 && hour < 17) {
                timeOfDay = 'afternoon';
            } else if (hour >= 17) {
                timeOfDay = 'evening';
            }


            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const currentDate = now.toLocaleDateString('en-US', options);
            var currentDateEl = document.getElementById('currentDate');
            if (currentDateEl) {
                currentDateEl.textContent = currentDate;
            }

            setDailyQuote();

            const currentYear = now.getFullYear();
            const currentMonth = now.getMonth();

            try {
                let awardsYearStart, awardsYearEnd;
                if (currentMonth >= 9) { 
                    awardsYearStart = new Date(currentYear, 9, 1); 
                    awardsYearEnd = new Date(currentYear + 1, 8, 30, 23, 59, 59); 
                } else { 
                    awardsYearStart = new Date(currentYear - 1, 9, 1); 
                    awardsYearEnd = new Date(currentYear, 8, 30, 23, 59, 59); 
                }

                const awardsYearProgress = ((now - awardsYearStart) / (awardsYearEnd - awardsYearStart)) * 100;
                const awardsYearFill = document.getElementById('awardsYearFill');
                const awardsYearPercent = document.getElementById('awardsYearPercent');
                const awardsYearDatesEl = document.getElementById('awardsYearDates');

                if (awardsYearFill) {
                    awardsYearFill.style.width = Math.min(awardsYearProgress, 100) + '%';

                }
                if (awardsYearPercent) {
                    awardsYearPercent.textContent = Math.round(Math.min(awardsYearProgress, 100)) + '%';
                }

                const awardsStartYear = awardsYearStart.getFullYear();
                const awardsEndYear = awardsYearEnd.getFullYear();
                if (awardsYearDatesEl) {
                    awardsYearDatesEl.textContent = 'October ' + awardsStartYear + ' - September ' + awardsEndYear;
                }

                let outsideSalesYearStart, outsideSalesYearEnd;
                if (now.getMonth() >= 6) { 
                    outsideSalesYearStart = new Date(currentYear, 6, 1); 
                    outsideSalesYearEnd = new Date(currentYear + 1, 5, 30, 23, 59, 59); 
                } else {
                    outsideSalesYearStart = new Date(currentYear - 1, 6, 1); 
                    outsideSalesYearEnd = new Date(currentYear, 5, 30, 23, 59, 59); 
                }

                const outsideSalesYearProgress = ((now - outsideSalesYearStart) / (outsideSalesYearEnd - outsideSalesYearStart)) * 100;
                const outsideSalesYearFill = document.getElementById('outsideSalesYearFill');
                const outsideSalesYearPercent = document.getElementById('outsideSalesYearPercent');
                const outsideSalesYearDatesEl = document.getElementById('outsideSalesYearDates');

                if (outsideSalesYearFill) {
                    outsideSalesYearFill.style.width = Math.min(outsideSalesYearProgress, 100) + '%';

                }
                if (outsideSalesYearPercent) {
                    outsideSalesYearPercent.textContent = Math.round(Math.min(outsideSalesYearProgress, 100)) + '%';
                }

                const outsideSalesStartYear = outsideSalesYearStart.getFullYear();
                const outsideSalesEndYear = outsideSalesYearEnd.getFullYear();
                if (outsideSalesYearDatesEl) {
                    if (outsideSalesStartYear === outsideSalesEndYear) {
                        outsideSalesYearDatesEl.textContent = 'July 1 - June 30, ' + outsideSalesStartYear;
                    } else {
                        outsideSalesYearDatesEl.textContent = 'July ' + outsideSalesStartYear + ' - June ' + outsideSalesEndYear;
                    }
                }

                const fiscalYearStart = new Date(currentYear, 0, 1); 
                const fiscalYearEnd = new Date(currentYear, 11, 31, 23, 59, 59); 
                const fiscalYearProgress = ((now - fiscalYearStart) / (fiscalYearEnd - fiscalYearStart)) * 100;

                const fiscalYearFill = document.getElementById('fiscalYearFill');
                const fiscalYearPercent = document.getElementById('fiscalYearPercent');
                const fiscalYearDatesEl = document.getElementById('fiscalYearDates');

                if (fiscalYearFill) {
                    fiscalYearFill.style.width = Math.min(fiscalYearProgress, 100) + '%';

                }
                if (fiscalYearPercent) {
                    fiscalYearPercent.textContent = Math.round(Math.min(fiscalYearProgress, 100)) + '%';
                }
                if (fiscalYearDatesEl) {
                    fiscalYearDatesEl.textContent = currentYear.toString();
                }
            } catch (e) {

            }






            try {
                google.script.run.withSuccessHandler(function (user) {

                    if (user) {
                        var displayName = 'there'; 

                        if (user.firstName) {
                            displayName = user.firstName;
                        }
                        else if (user.fullName) {
                            displayName = user.fullName.split(' ')[0];
                        }
                        else if (user.email) {
                            const emailPrefix = user.email.split('@')[0];
                            var parsedName = emailPrefix;

                            if (emailPrefix.includes('.')) {
                                const parts = emailPrefix.split('.');
                                if (parts[0].length === 1) {
                                    parsedName = emailPrefix.replace(/\./g, ' ');
                                } else {
                                    parsedName = parts[0];
                                }
                            } else if (emailPrefix.includes('_')) {
                                parsedName = emailPrefix.split('_')[0];
                            } else if (emailPrefix.includes('-')) {
                                parsedName = emailPrefix.split('-')[0];
                            }

                            displayName = parsedName
                                .split(' ')
                                .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
                                .join(' ');
                        }

                        if (displayName && displayName !== 'there') {
                            displayName = displayName.charAt(0).toUpperCase() + displayName.slice(1);
                        }

                        document.querySelector('.greeting-name').textContent = displayName;
                    }
                }).withFailureHandler(function (error) {

                }).getUserInfo();
            } catch (e) {


            }
        }

        function setupEventHandlers() {


            var departmentsContainer = document.getElementById('departments-items');
            if (departmentsContainer) {


                var cards = departmentsContainer.querySelectorAll('.department-card');


                departmentsContainer.removeEventListener('click', handleDepartmentClick);
                departmentsContainer.addEventListener('click', handleDepartmentClick, false);



                cards.forEach(function (card, index) {
                    var id = card.getAttribute('data-department-id');

                });
            } else {

            }

            var navigationContainer = document.getElementById('navigation-items');
            if (navigationContainer) {


                var navItems = navigationContainer.querySelectorAll('.nav-item');


                navigationContainer.removeEventListener('click', handleNavClick);
                navigationContainer.addEventListener('click', handleNavClick, false);



                navItems.forEach(function (item, index) {
                    var href = item.getAttribute('href');
                    var dataTarget = item.getAttribute('data-target');
                    var classes = item.className;

                });
            } else {

            }



        }

        function handleDepartmentClick(event) {


            var departmentCard = event.target.closest('.department-card');
            if (departmentCard) {
                var departmentId = departmentCard.getAttribute('data-department-id');


                event.preventDefault();
                event.stopPropagation();

                try {
                    if (typeof toggleDepartment === 'function') {

                        toggleDepartment(parseInt(departmentId), event);
                    } else {

                    }
                } catch (error) {

                }
            } else {

            }
        }

        function handleNavClick(event) {


            var navItem = event.target.closest('.nav-item');
            if (navItem) {
                var sectionId = navItem.getAttribute('data-target');
                if (!sectionId) {
                    var href = navItem.getAttribute('href');
                    if (href && href.startsWith('#')) {
                        sectionId = href.substring(1);
                    }
                }

                if (sectionId) {


                    event.preventDefault();
                    event.stopPropagation();

                    try {
                        if (typeof scrollToSection === 'function') {

                            scrollToSection(event, sectionId);
                        } else {

                        }
                    } catch (error) {

                    }
                } else {

                }
            } else {

            }
        }

        window.initScrollSpy = function () {


            var sections = Array.from(document.querySelectorAll('section[id]'));
            var navLinks = document.querySelectorAll('.nav-item');

            if (!sections.length) {

                return;
            }



            sections.forEach(function (section) {
                var rect = section.getBoundingClientRect();

            });

            var lastActiveSection = null;

            function getCurrentSection() {
                var scrollY = window.scrollY || window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
                var windowHeight = window.innerHeight;
                var docHeight = document.documentElement.scrollHeight || document.body.scrollHeight;



                if (scrollY < 50) {

                    return sections[0] ? sections[0].id : null;
                }

                if (scrollY + windowHeight >= docHeight - 50) {

                    return sections[sections.length - 1].id;
                }

                var currentSection = null;
                var maxVisibleHeight = 0;

                for (var i = 0; i < sections.length; i++) {
                    var section = sections[i];
                    var rect = section.getBoundingClientRect();

                    var visibleTop = Math.max(0, rect.top);
                    var visibleBottom = Math.min(windowHeight, rect.bottom);
                    var visibleHeight = Math.max(0, visibleBottom - visibleTop);



                    if (visibleHeight > maxVisibleHeight) {
                        maxVisibleHeight = visibleHeight;
                        currentSection = section.id;
                    }
                }

                if (currentSection) {

                    return currentSection;
                }

                for (var i = sections.length - 1; i >= 0; i--) {
                    var section = sections[i];
                    var sectionTop = section.offsetTop;
                    if (scrollY >= sectionTop - 100) {

                        return section.id;
                    }
                }


                return sections[0] ? sections[0].id : null;
            }

            function updateNavigation() {
                var currentSectionId = getCurrentSection();



                if (!currentSectionId || currentSectionId === lastActiveSection) {
                    return; 
                }

                lastActiveSection = currentSectionId;

                navLinks.forEach(function (link) {
                    link.classList.remove('active');
                });

                var activeLink = document.querySelector('.nav-item[data-target="' + currentSectionId + '"]') ||
                    document.querySelector('.nav-item[href="#' + currentSectionId + '"]');

                if (activeLink) {
                    activeLink.classList.add('active');

                } else {

                }
            }

            var isScrolling = false;
            var scrollEventCount = 0;
            function handleScroll() {
                if (scrollEventCount < 5) {

                    scrollEventCount++;
                }
                if (!isScrolling) {
                    window.requestAnimationFrame(function () {
                        updateNavigation();
                        isScrolling = false;
                    });
                    isScrolling = true;
                }
            }

            if (window.scrollSpyScrollHandler) {
                window.removeEventListener('scroll', window.scrollSpyScrollHandler);
                document.removeEventListener('scroll', window.scrollSpyScrollHandler);
            }

            window.scrollSpyScrollHandler = handleScroll;

            window.addEventListener('scroll', handleScroll, { passive: true });
            document.addEventListener('scroll', handleScroll, { passive: true });

            var scrollCheckInterval = setInterval(function () {
                var currentScroll = window.scrollY || window.pageYOffset || document.documentElement.scrollTop || 0;
                if (currentScroll !== window.lastScrollPosition) {
                    window.lastScrollPosition = currentScroll;
                    handleScroll();
                }
            }, 100);

            window.scrollCheckInterval = scrollCheckInterval;

            window.addEventListener('resize', function () {
                setTimeout(updateNavigation, 100);
            });

            updateNavigation();

            setTimeout(updateNavigation, 500);
            setTimeout(updateNavigation, 1500);



            setTimeout(function () {

            }, 2000);
        };

        var scrollSpyDisabledUntil = 0; 

        function setupScrollSpy() {
            var sections = document.querySelectorAll('section[id]');
            var navItems = document.querySelectorAll('.nav-item');



            if (!sections.length || !navItems.length) {

                return;
            }

            sections.forEach(function (section) {

            });

            function highlightActiveSection() {
                if (Date.now() < scrollSpyDisabledUntil) {
                    return;
                }

                var scrollPosition = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
                var windowHeight = window.innerHeight;
                var documentHeight = document.documentElement.scrollHeight || document.body.scrollHeight;

                scrollPosition += 150; 

                var activeFound = false;
                var currentActiveId = null;

                var isAtBottom = (scrollPosition + windowHeight) >= (documentHeight - 50);

                if (isAtBottom && sections.length > 0) {
                    currentActiveId = sections[sections.length - 1].getAttribute('id');
                    activeFound = true;
                } else {
                    for (var i = sections.length - 1; i >= 0; i--) {
                        var section = sections[i];
                        var sectionTop = section.offsetTop;
                        var sectionHeight = section.offsetHeight;
                        var sectionId = section.getAttribute('id');

                        if (scrollPosition >= sectionTop && scrollPosition < (sectionTop + sectionHeight)) {
                            currentActiveId = sectionId;
                            activeFound = true;
                            break;
                        }

                        if (scrollPosition >= sectionTop - 50) {
                            currentActiveId = sectionId;
                            activeFound = true;
                            break;
                        }
                    }
                }

                if (!activeFound && scrollPosition < 200) {
                    currentActiveId = sections[0] ? sections[0].getAttribute('id') : null;
                }

                if (currentActiveId) {
                    var alreadyActive = document.querySelector('.nav-item.active[data-target="' + currentActiveId + '"]');
                    if (!alreadyActive) {
                        alreadyActive = document.querySelector('.nav-item.active[href="#' + currentActiveId + '"]');
                    }

                    if (!alreadyActive) {


                        for (var j = 0; j < navItems.length; j++) {
                            navItems[j].classList.remove('active');
                        }

                        var targetNav = document.querySelector('.nav-item[data-target="' + currentActiveId + '"]');
                        if (!targetNav) {
                            targetNav = document.querySelector('.nav-item[href="#' + currentActiveId + '"]');
                        }
                        if (targetNav) {
                            targetNav.classList.add('active');

                        } else {

                        }
                    }
                } else {

                }
            }

            var scrollTimeout;
            var scrollHandler = function () {
                if (scrollTimeout) {
                    clearTimeout(scrollTimeout);
                }
                scrollTimeout = setTimeout(highlightActiveSection, 50);
            };

            window.removeEventListener('scroll', window.scrollSpyHandler);

            window.scrollSpyHandler = scrollHandler;

            window.addEventListener('scroll', scrollHandler, { passive: true });

            window.addEventListener('resize', function () {
                setTimeout(highlightActiveSection, 100);
            });

            setTimeout(highlightActiveSection, 200);

            setTimeout(highlightActiveSection, 1000);



        }

        function initSidebarNavScrollbars() {
            try {
                var containers = document.querySelectorAll('.nav-scroll-container');
                if (!containers || !containers.length) {
                    return;
                }

                function initContainer(container) {
                    if (!container || container.getAttribute('data-nav-scrollbar-initialized') === 'true') {
                        return;
                    }
                    container.setAttribute('data-nav-scrollbar-initialized', 'true');

                    var scrollArea = container.querySelector('.nav-section');
                    var thumb = container.querySelector('.nav-scrollbar-thumb');
                    if (!scrollArea || !thumb) {
                        return;
                    }

                    function updateThumb() {
                        var scrollHeight = scrollArea.scrollHeight || 0;
                        var clientHeight = scrollArea.clientHeight || 0;
                        var maxScrollTop = Math.max(0, scrollHeight - clientHeight);
                        var isScrollable = maxScrollTop > 1;
                        container.classList.toggle('nav-scrollable', isScrollable);
                        if (!isScrollable) {
                            return;
                        }

                        var minThumbHeight = 28;
                        var trackInset = 6;
                        var trackHeight = Math.max(0, clientHeight - (trackInset * 2));
                        var thumbHeight = Math.max(minThumbHeight, Math.round((clientHeight / scrollHeight) * trackHeight));
                        if (trackHeight && thumbHeight > trackHeight) {
                            thumbHeight = trackHeight;
                        }
                        var maxThumbTop = Math.max(0, trackHeight - thumbHeight);
                        var scrollTop = Math.max(0, scrollArea.scrollTop || 0);
                        var thumbTop = maxScrollTop ? Math.round((scrollTop / maxScrollTop) * maxThumbTop) : 0;

                        thumb.style.height = thumbHeight + 'px';
                        thumb.style.transform = 'translateY(' + thumbTop + 'px)';
                    }

                    updateThumb();
                    scrollArea.addEventListener('scroll', updateThumb, { passive: true });
                    window.addEventListener('resize', updateThumb, { passive: true });

                    if (typeof ResizeObserver !== 'undefined') {
                        try {
                            var resizeObserver = new ResizeObserver(updateThumb);
                            resizeObserver.observe(scrollArea);
                        } catch (_) { }
                    }
                }

                for (var i = 0; i < containers.length; i++) {
                    initContainer(containers[i]);
                }
            } catch (_) { }
        }

        document.addEventListener('DOMContentLoaded', function () {



            initializeGreeting();
            initSidebarNavScrollbars();

            setTimeout(updateProgressBars, 100);
            setTimeout(updateProgressBars, 500);
            setTimeout(updateProgressBars, 1000);

            document.addEventListener('click', function (e) {
                var target = e.target;

                var inDepartmentContent = target.closest('.department-content');

                if (inDepartmentContent) {
                    var isClickable = target.tagName === 'A' ||
                        target.closest('a') ||
                        target.tagName === 'BUTTON' ||
                        target.closest('button');

                    if (isClickable) {
                        e.stopImmediatePropagation();

                        var deptBtn = target.closest('.department-page-btn');
                        if (deptBtn) {
                            e.preventDefault();
                            var url = deptBtn.getAttribute('data-url');
                            if (url) {
                                window.location.href = url;
                            }
                        }
                    }
                    return;
                }
            }, true); 

            document.addEventListener('click', function (e) {
                var target = e.target;

                var departmentHeader = target.closest('.department-header');
                if (departmentHeader) {
                    var departmentCard = target.closest('.department-card[data-clickable="true"]');
                    if (departmentCard) {
                        e.preventDefault();
                        var departmentId = departmentCard.getAttribute('data-department-id');
                        if (departmentId !== null) {
                            toggleDepartment(parseInt(departmentId), e);
                        }
                    }
                    return;
                }

                var button = target.closest('.share-btn');
                if (button) {
                    e.preventDefault();
                    var index = button.getAttribute('data-index');
                    if (index) {
                        shareEvent(parseInt(index));
                    }
                }

                var addButton = target.closest('.add-btn');
                if (addButton) {
                    e.preventDefault();
                    var index = addButton.getAttribute('data-index');
                    if (index) {
                        addToCalendar(parseInt(index));
                    }
                }
            });

            setTimeout(function () {
                if (typeof loadCalendarEvents === 'function') {

                    loadCalendarEvents();
                }
            }, 1500);

            var isAppsScript = window.self !== window.top;


            if (isAppsScript) {


                try {
                    var testDiv = document.createElement('div');
                    testDiv.onclick = function () { };

                } catch (e) {

                }

                try {
                    document.addEventListener('test', function () { });

                } catch (e) {

                }

                try {
                    var event = new Event('test');

                } catch (e) {

                }


            }

            setTimeout(function () {

                setupEventHandlers();
            }, 200);

            setTimeout(function () {

            }, 500);

            setTimeout(function () {

                setupEventHandlers();
            }, 1500);

            setTimeout(function () {

                setupEventHandlers();
            }, 3000);

            document.querySelectorAll('.card').forEach(card => {
                card.addEventListener('mouseenter', function () {
                    this.style.transform = 'translateY(-2px)';
                });
                card.addEventListener('mouseleave', function () {
                    this.style.transform = 'translateY(0)';
                });
            });

            if (Array.isArray(window.newsData) && window.newsData.length > 0) {
                initializeNews();
            }


            updateStats();

            try { initLookerEmbed(); } catch (_) { }
            try {
                var LOOKER_MAP = {
                    'cur-ne': { report: '5e9d6cb7-2ee5-4284-9411-5d6a727af512', page: 'uwIVB', height: 340, label: 'Current Top 10  North East' },
                    'cur-se': { report: '5e9d6cb7-2ee5-4284-9411-5d6a727af512', page: 'IoeYB', height: 340, label: 'Current Top 10  South East' },
                    'cur-mw': { report: '5e9d6cb7-2ee5-4284-9411-5d6a727af512', page: 'uneYB', height: 340, label: 'Current Top 10  Midwest' },
                    'cur-w': { report: '5e9d6cb7-2ee5-4284-9411-5d6a727af512', page: 'soeYB', height: 340, label: 'Current Top 10  West' },
                    'cur-sw': { report: '5e9d6cb7-2ee5-4284-9411-5d6a727af512', page: 'coeYB', height: 340, label: 'Current Top 10  South West' },
                    'cur-uk': { report: '5e9d6cb7-2ee5-4284-9411-5d6a727af512', page: 'EpeYB', height: 340, label: 'Current Top 10  United Kingdom' },
                    'cur-ca': { report: '5e9d6cb7-2ee5-4284-9411-5d6a727af512', page: '5oeYB', height: 340, label: 'Current Top 10  Canada' },
                    'cur-au': { report: '5e9d6cb7-2ee5-4284-9411-5d6a727af512', page: 'SpeYB', height: 340, label: 'Current Top 10  Australia' },
                    'cur-mco': { report: '5e9d6cb7-2ee5-4284-9411-5d6a727af512', page: 'SBPnB', height: 340, label: 'Current Top 10  Multi-Center Owners' },
                    'kclub-us': { report: '1c3c7ef5-d15f-41f5-9421-e183c0c52de6', page: 'uwIVB', height: 540, label: 'Current K-Club  United States' },
                    'kclub-uk': { report: '1c3c7ef5-d15f-41f5-9421-e183c0c52de6', page: 'FGeYB', height: 540, label: 'Current K-Club  United Kingdom' },
                    'kclub-ca': { report: '1c3c7ef5-d15f-41f5-9421-e183c0c52de6', page: 'aHeYB', height: 540, label: 'Current K-Club  Canada' },
                    'kclub-au': { report: '1c3c7ef5-d15f-41f5-9421-e183c0c52de6', page: 'THeYB', height: 540, label: 'Current K-Club  Australia' },
                    'award-us': { report: '1HvFXEXs898hrr7O6Z0Q1IFWeQOq-rqYR', page: 'y5dkB', height: 1007, label: 'Award Year Sales Comparison  United States' },
                    'award-uk': { report: '1HvFXEXs898hrr7O6Z0Q1IFWeQOq-rqYR', page: 'mnekB', height: 1007, label: 'Award Year Sales Comparison  United Kingdom' },
                    'award-ca': { report: '1HvFXEXs898hrr7O6Z0Q1IFWeQOq-rqYR', page: 'GtekB', height: 1007, label: 'Award Year Sales Comparison  Canada' },
                    'award-au': { report: '1HvFXEXs898hrr7O6Z0Q1IFWeQOq-rqYR', page: 'WsekB', height: 1007, label: 'Award Year Sales Comparison  Australia' },
                    'hist-kclubs': { report: '1c3c7ef5-d15f-41f5-9421-e183c0c52de6', page: 'VXeYB', height: 540, label: 'Historical  K Clubs' },
                    'hist-top10': { report: '5e9d6cb7-2ee5-4284-9411-5d6a727af512', page: 'mreYB', height: 340, label: 'Historical  Top 10 by Region' }
                };
                var lookerSel = document.getElementById('lookerSimpleSelect');
                var lookerOpen = document.getElementById('lookerOpenFullTop');
                var lookerFrame = document.getElementById('lookerFrame');
                function setLookerSelection(key) {
                    try { } catch (_) { }
                    var cfg = LOOKER_MAP[key];
                    if (!cfg) { try { } catch (_) { } return; }
                    if (lookerFrame) {
                        try {
                            var loader = lookerFrame.parentNode && lookerFrame.parentNode.querySelector('.embed-loader');
                            if (loader) loader.style.display = 'flex';
                        } catch (_) { }
                        var embedUrl = 'https://lookerstudio.google.com/embed/reporting/' + cfg.report + '/page/' + cfg.page;
                        lookerFrame.src = embedUrl;
                        try { lookerFrame.style.height = (cfg.height || 340) + 'px'; } catch (_) { }
                    }
                    if (lookerOpen) {
                        lookerOpen.href = 'https://lookerstudio.google.com/reporting/' + cfg.report + '/page/' + cfg.page;
                    }
                    try { localStorage.setItem('lookerKey', key); } catch (_) { }
                    if (lookerSel && lookerSel.value !== key) {
                        try { lookerSel.value = key; } catch (_) { }
                    }
                }
                var savedKey = 'cur-ne';
                try { savedKey = localStorage.getItem('lookerKey') || 'cur-ne'; } catch (_) { }
                if (!savedKey) savedKey = 'cur-ne';
                if (!localStorage.getItem('lookerKey')) {
                    try {
                        var legacy = localStorage.getItem('lookerPage');
                        if (legacy === 'uwIVB') savedKey = 'cur-ne';
                        else if (legacy === 'IoeYB') savedKey = 'cur-se';
                    } catch (_) { }
                }
                if (lookerSel) {
                    try { lookerSel.value = savedKey; } catch (_) { }
                }
                if (savedKey !== 'cur-ne') { setLookerSelection(savedKey); } else { setLookerSelection('cur-ne'); }
                if (lookerSel) {
                    lookerSel.addEventListener('change', function () { setLookerSelection(this.value); });
                }
                try { window.setLookerSelection = setLookerSelection; } catch (_) { }
            } catch (e) { try { } catch (_) { } }

            try {
                if (window.initScrollSpy) {
                    window.initScrollSpy();
                } else {
                    setupScrollSpy();
                }
            } catch (e) {

            }

            setInterval(initializeGreeting, 60000);
        });

        window.addEventListener('load', function () {

            if (window.initScrollSpy) {
                window.initScrollSpy();
            }
        });

        setTimeout(function () {

            if (window.initScrollSpy) {
                window.initScrollSpy();
            }
        }, 3000);

        window.addEventListener('scroll', function () {
            if (!window.scrollTestDone) {

                window.scrollTestDone = true;
            }
        });

        document.addEventListener('scroll', function () {
            if (!window.docScrollTestDone) {

                window.docScrollTestDone = true;
            }
        });

        window.onscroll = function () {
            if (!window.onscrollTestDone) {

                window.onscrollTestDone = true;
                window.onscroll = null;
            }
        };

        function updateStats() {
            try {
                var badges = document.querySelectorAll('.nav-badge');
                for (var i = 0; i < badges.length; i++) {
                    badges[i].textContent = String((window.newsData && newsData.length) ? newsData.length : 0);
                }
            } catch (_) { }
        }

        function initLookerEmbed() {
            var f = document.getElementById('lookerFrame');
            if (!f) return;
            function hideLoader() {
                try {
                    var loader = f.parentNode && f.parentNode.querySelector('.embed-loader');
                    if (loader) loader.style.display = 'none';
                } catch (_) { }
            }
            var t = setTimeout(hideLoader, 1500);
            f.addEventListener('load', function () {
                clearTimeout(t);
                hideLoader();
                try { lookerDebugDump('iframe-loaded'); } catch (_) { }
            });
        }

        function isAppsScriptEnv() {
            try { return typeof google !== 'undefined' && google.script && google.script.run; } catch (_) { return false; }
        }
        function defaultLookerDashboards() {
            return [
                {
                    group: 'Current Top 10', items: [
                        { name: 'North East', id: 'nOs7S4JrXH4' },
                        { name: 'South East', id: 'o2qtIjhjNNU' },
                        { name: 'Midwest', id: 'reaTGwgInqQ' },
                        { name: 'West', id: 'kpmQ_-cYTAE' },
                        { name: 'South West', id: 'n_e1EXP8dkk' },
                        { name: 'United Kingdom', id: 'jNZpIZAbR84' },
                        { name: 'Canada', id: 'sjKjJuCz2Ek' },
                        { name: 'Australia', id: 'uezr4aDrbLY' }
                    ]
                },
                {
                    group: 'Current K-Club', items: [
                        { name: 'United States', id: 'jwQawMpXuc8' },
                        { name: 'United Kingdom', id: 'tSONo6QS3jU' },
                        { name: 'Canada', id: 'oufYsqGHCOg' },
                        { name: 'Australia', id: 'stUbVAPzjco' }
                    ]
                },
                {
                    group: 'Award Year Sales Comparison', items: [
                        { name: 'United States', id: 'hvCJeDSAkmQ' },
                        { name: 'United Kingdom', id: 'iC-Wmt1r0fo' },
                        { name: 'Canada', id: 'mypEYrg_Dns' },
                        { name: 'Australia', id: 'kuh-Sd6SxMg' }
                    ]
                },
                {
                    group: 'Historical', items: [
                        { name: 'K Clubs', id: 'r-QtSy24Aj4' },
                        { name: 'Top 10 by Region', id: 'obbxONPDkkk' }
                    ]
                }
            ];
        }
        var LOOKER_DASHBOARDS = [
            {
                group: 'Current Top 10', items: [
                    { name: 'North East', id: 'nOs7S4JrXH4' },
                    { name: 'South East', id: 'o2qtIjhjNNU' },
                    { name: 'Midwest', id: 'reaTGwgInqQ' },
                    { name: 'West', id: 'kpmQ_-cYTAE' },
                    { name: 'South West', id: 'n_e1EXP8dkk' },
                    { name: 'United Kingdom', id: 'jNZpIZAbR84' },
                    { name: 'Canada', id: 'sjKjJuCz2Ek' },
                    { name: 'Australia', id: 'uezr4aDrbLY' }
                ]
            },
            {
                group: 'Current K-Club', items: [
                    { name: 'United States', id: 'jwQawMpXuc8' },
                    { name: 'United Kingdom', id: 'tSONo6QS3jU' },
                    { name: 'Canada', id: 'oufYsqGHCOg' },
                    { name: 'Australia', id: 'stUbVAPzjco' }
                ]
            },
            {
                group: 'Award Year Sales Comparison', items: [
                    { name: 'United States', id: 'hvCJeDSAkmQ' },
                    { name: 'United Kingdom', id: 'iC-Wmt1r0fo' },
                    { name: 'Canada', id: 'mypEYrg_Dns' },
                    { name: 'Australia', id: 'kuh-Sd6SxMg' }
                ]
            },
            {
                group: 'Historical', items: [
                    { name: 'K Clubs', id: 'r-QtSy24Aj4' },
                    { name: 'Top 10 by Region', id: 'obbxONPDkkk' }
                ]
            }
        ];

        function selectedLookerId() {
            try { return localStorage.getItem('lookerSelectedId') || 'nOs7S4JrXH4'; } catch (_) { return 'nOs7S4JrXH4'; }
        }
        function saveSelectedLookerId(id) {
            try { localStorage.setItem('lookerSelectedId', id); } catch (_) { }
        }
        function buildLookerSelector() {
            var sel = document.getElementById('lookerSelect');
            if (!sel) return;
            sel.innerHTML = '';
            var dashboards;
            try {
                dashboards = (Array.isArray(LOOKER_DASHBOARDS) && LOOKER_DASHBOARDS.length) ? LOOKER_DASHBOARDS : defaultLookerDashboards();
            } catch (_) { dashboards = defaultLookerDashboards(); }
            try { } catch (_) { }
            for (var g = 0; g < dashboards.length; g++) {
                var grp = dashboards[g];
                for (var i = 0; i < grp.items.length; i++) {
                    var it = grp.items[i];
                    var opt = document.createElement('option');
                    opt.value = it.id;
                    opt.textContent = grp.group + '  ' + it.name;
                    sel.appendChild(opt);
                }
            }
            try { } catch (_) { }
            var cur = selectedLookerId();
            try { sel.value = cur; } catch (_) { }
            if (!sel.value && sel.options && sel.options.length) sel.selectedIndex = 0;
            try { } catch (_) { }
            sel.addEventListener('change', function () { updateLookerEmbed(this.value, true); });
            ensureLookerControlsVisible();
            try { lookerDebugDump('selector-built'); } catch (_) { }

            if (!isAppsScriptEnv()) {
                try { buildLookerCustomDropdown(cur); } catch (e) { }
            }

            try {
                var btn = document.querySelector('#lookerDd .looker-dd-btn');
                var ok = !!(btn && btn.textContent && btn.textContent.trim().length);
                if (ok) {
                    var r = btn.getBoundingClientRect();
                    ok = r && r.width > 30 && r.height > 10;
                }
                if (ok && !isAppsScriptEnv()) {
                    sel.style.display = 'none';
                    try { } catch (_) { }
                } else {
                    sel.style.display = '';
                    try { } catch (_) { }
                }
            } catch (e) {
                sel.style.display = '';
                try { } catch (_) { }
            }
        }
        function labelForId(id) {
            try {
                for (var g = 0; g < LOOKER_DASHBOARDS.length; g++) {
                    var grp = LOOKER_DASHBOARDS[g];
                    for (var i = 0; i < grp.items.length; i++) if (grp.items[i].id === id) return grp.group + '  ' + grp.items[i].name;
                }
            } catch (_) { }
            return 'Select dashboard';
        }
        function buildLookerCustomDropdown(currentId) {
            var controls = document.querySelector('.looker-controls');
            if (!controls) return;
            var old = document.getElementById('lookerDd'); if (old) old.remove();
            var dd = document.createElement('div'); dd.id = 'lookerDd'; dd.className = 'looker-dd';
            var btn = document.createElement('button'); btn.type = 'button'; btn.className = 'looker-dd-btn'; btn.setAttribute('aria-expanded', 'false'); btn.textContent = labelForId(currentId);
            dd.appendChild(btn);
            var menu = document.createElement('div'); menu.className = 'looker-dd-menu';
            for (var g = 0; g < LOOKER_DASHBOARDS.length; g++) {
                var grp = LOOKER_DASHBOARDS[g];
                var gh = document.createElement('div'); gh.className = 'looker-dd-group'; gh.textContent = grp.group; menu.appendChild(gh);
                for (var i = 0; i < grp.items.length; i++) { var it = grp.items[i]; var item = document.createElement('button'); item.type = 'button'; item.className = 'looker-dd-item'; item.setAttribute('data-id', it.id); item.textContent = it.name; menu.appendChild(item); }
            }
            dd.appendChild(menu);
            controls.insertBefore(dd, controls.firstChild);
            try {
                var sel = document.getElementById('lookerSelect');
                sel.style.display = '';
                sel.style.visibility = 'visible';
            } catch (_) { }
            function positionMenu() {
                try {
                    var r = btn.getBoundingClientRect();
                    menu.style.position = 'fixed';
                    menu.style.top = (r.bottom + 6) + 'px';
                    menu.style.left = (r.left) + 'px';
                    menu.style.minWidth = Math.max(260, Math.round(r.width)) + 'px';
                    menu.style.maxWidth = Math.min(window.innerWidth - r.left - 12, 520) + 'px';
                } catch (_) { }
            }
            function openMenu() { dd.classList.add('open'); btn.setAttribute('aria-expanded', 'true'); positionMenu(); window.addEventListener('scroll', positionMenu, true); window.addEventListener('resize', positionMenu, true); }
            function closeMenu() { dd.classList.remove('open'); btn.setAttribute('aria-expanded', 'false'); window.removeEventListener('scroll', positionMenu, true); window.removeEventListener('resize', positionMenu, true); }
            btn.addEventListener('click', function (e) { e.stopPropagation(); if (dd.classList.contains('open')) closeMenu(); else openMenu(); });
            menu.addEventListener('click', function (e) { var t = e.target.closest('.looker-dd-item'); if (!t) return; var id = t.getAttribute('data-id'); btn.textContent = labelForId(id); dd.classList.remove('open'); btn.setAttribute('aria-expanded', 'false'); updateLookerEmbed(id, true); });
            document.addEventListener('click', function () { closeMenu(); });
            try { } catch (_) { }
        }
        function updateLookerEmbed(id, persist) {
            try {
                var f = document.getElementById('lookerFrame');
                if (!f) return;
                var loader = f.parentNode && f.parentNode.querySelector('.embed-loader');
                if (loader) loader.style.display = 'flex';
                var embedUrl = 'https://lookerstudio.google.com/embed/s/' + id;
                f.src = embedUrl;
                var openUrl = 'https://lookerstudio.google.com/s/' + id;
                try {
                    var top = document.getElementById('lookerOpenFullTop');
                    if (top) top.href = openUrl;
                    var fb = document.getElementById('lookerFallbackLink'); if (fb) fb.href = openUrl;
                } catch (_) { }
                if (persist) saveSelectedLookerId(id);
                ensureLookerControlsVisible();
                try { lookerDebugDump('embed-updated:' + id); } catch (_) { }

                try { if (window.__lookerEmbedTimer) clearTimeout(window.__lookerEmbedTimer); } catch (_) { }
                window.__lookerEmbedTimer = setTimeout(function () { tryShowLookerFallback(); }, 4000);
            } catch (_) { }
        }
        function tryShowLookerFallback() {
            try {
                var frame = document.getElementById('lookerFrame');
                var fb = document.getElementById('lookerFallback');
                if (!frame || !fb) return;
                if (!frame.src || frame.clientHeight < 50) {
                    fb.style.display = 'flex';
                }
            } catch (_) { }
        }
        function ensureLookerControlsVisible() {
            try {
                var header = document.querySelector('.card-header.looker-header');
                var controls = document.querySelector('.looker-controls');
                var sel = document.getElementById('lookerSelect') || document.getElementById('lookerSimpleSelect');
                if (!header || !controls || !sel) return;
                var r = sel.getBoundingClientRect();
                if (!r || r.height < 10 || r.width < 50) {
                    header.style.position = 'relative';
                    header.style.zIndex = '10';
                    controls.style.position = 'relative';
                    controls.style.zIndex = '11';
                    sel.style.position = 'relative';
                    sel.style.zIndex = '12';
                    sel.style.minHeight = '32px';
                }
                var dd = document.getElementById('lookerDd');
                if (dd) {
                    dd.style.position = 'relative';
                    dd.style.zIndex = '13';
                }
            } catch (e) {   }
        }
        function lookerDebugDump(stage) {
            try {
                if (!window || !window.console || !console.debug) {
                    return;
                }
                var sel = document.getElementById('lookerSelect') || document.getElementById('lookerSimpleSelect');
                var frame = document.getElementById('lookerFrame');
                var open = document.getElementById('lookerOpenFullTop');
                var info = {
                    stage: stage || '',
                    hasSelect: !!sel,
                    hasFrame: !!frame,
                    hasOpenLink: !!open
                };
                if (sel) {
                    var srect = sel.getBoundingClientRect();
                    info.selectBox = srect ? { width: Math.round(srect.width), height: Math.round(srect.height) } : null;
                    info.selectZ = window.getComputedStyle(sel).zIndex;
                }
                if (frame) {
                    var frect = frame.getBoundingClientRect();
                    info.frameBox = frect ? { width: Math.round(frect.width), height: Math.round(frect.height) } : null;
                }
                var header = document.querySelector('.card-header.looker-header');
                if (header) {
                    info.headerZ = window.getComputedStyle(header).zIndex;
                }
                console.debug('[LookerDebug]', info);
            } catch (e) {   }
        }

        function initializeDynamicContent() {

        }

        window.addEventListener('load', function () {

        });

        if (document.readyState === 'complete' || document.readyState === 'interactive') {

            setTimeout(function () {
            }, 0);
        }

        setTimeout(function () {
            if (typeof google !== 'undefined' && google.script) {

            }
        }, 2000);

        (function () {

            try {
                var inAppsScript = false;
                try {
                    if (typeof google !== 'undefined' && google.script) {
                        inAppsScript = true;
                    }
                } catch (e) { }



                if (typeof initializeDynamicContent === 'function') {


                    setTimeout(function () {

                    }, 50);

                    setTimeout(function () {

                    }, 250);
                } else {

                }
            } catch (e) {

            }
        })();
    </script>

    <script>
        (function () {
            function matchesSelector(element, selector) {
                if (!element || element.nodeType !== 1) {
                    return false;
                }
                var proto = element.matches || element.msMatchesSelector || element.webkitMatchesSelector;
                if (!proto) {
                    var nodes = (element.parentNode || document).querySelectorAll(selector);
                    for (var i = 0; i < nodes.length; i++) {
                        if (nodes[i] === element) {
                            return true;
                        }
                    }
                    return false;
                }
                return proto.call(element, selector);
            }

            function closestElement(element, selector) {
                while (element && element.nodeType === 1) {
                    if (matchesSelector(element, selector)) {
                        return element;
                    }
                    element = element.parentElement;
                }
                return null;
            }

            if (typeof window.scrollToSection !== 'function') {
                window.scrollToSection = function (evt, sectionId) {
                    if (evt && typeof evt.preventDefault === 'function') {
                        evt.preventDefault();
                    }

                    var navItems = document.querySelectorAll('.nav-item');
                    for (var i = 0; i < navItems.length; i++) {
                        navItems[i].classList.remove('active');
                    }

                    var fromEvent = evt && (evt.currentTarget || (evt.target && closestElement(evt.target, '.nav-item')));
                    var targetItem = fromEvent || null;
                    if (!targetItem) {
                        for (var j = 0; j < navItems.length; j++) {
                            var item = navItems[j];
                            var dataTarget = item.getAttribute('data-target');
                            var hrefTarget = item.getAttribute('href');
                            if (dataTarget === sectionId || hrefTarget === '#' + sectionId) {
                                targetItem = item;
                                break;
                            }
                        }
                    }
                    if (targetItem) {
                        targetItem.classList.add('active');
                    }

                    if (window.innerWidth <= 768) {
                        if (typeof window.closeMobileMenu === 'function') {
                            window.closeMobileMenu();
                        } else {
                            var sidebar = document.getElementById('sidebar');
                            var overlay = document.querySelector('.sidebar-overlay');
                            if (sidebar) {
                                sidebar.classList.remove('active');
                            }
                            if (overlay) {
                                overlay.classList.remove('active');
                            }
                            if (document.body) {
                                document.body.style.overflow = '';
                            }
                        }
                    }

                    var section = document.getElementById(sectionId);
                    if (!section) {
                        return false;
                    }

                    try {
                        section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    } catch (error) {
                        var top = section.getBoundingClientRect ? section.getBoundingClientRect().top + (window.pageYOffset || document.documentElement.scrollTop || 0) : section.offsetTop;
                        window.scrollTo(0, top || 0);
                    }

                    return false;
                };
            }

            if (typeof window.toggleFAQ !== 'function') {
                window.toggleFAQ = function (button) {
                    var question = button;
                    if (!question || question.nodeType !== 1) {
                        question = closestElement(button, '.faq-question');
                    }
                    if (!question) {
                        return;
                    }

                    var isActive = question.classList.contains('active');
                    var questions = document.querySelectorAll('.faq-question');
                    for (var i = 0; i < questions.length; i++) {
                        questions[i].classList.remove('active');
                        var answerNode = questions[i].nextElementSibling;
                        if (answerNode) {
                            answerNode.classList.remove('active');
                        }
                    }

                    if (!isActive) {
                        question.classList.add('active');
                        var answer = question.nextElementSibling;
                        if (answer) {
                            answer.classList.add('active');
                        }
                    }
                };
            }
        })();
    </script>

    <script>
        (function () {
            var data = Array.isArray(window.departmentSupportData) ? window.departmentSupportData : null;
            if (!data) {
                return;
            }

            var grid = document.getElementById('departmentSupportGrid');
            var prevBtn = document.getElementById('supportPrev');
            var nextBtn = document.getElementById('supportNext');
            var pageInfo = document.getElementById('supportPageInfo');
            if (!grid || !prevBtn || !nextBtn || !pageInfo) {
                return;
            }

            var pageSize = parseInt(grid.getAttribute('data-page-size'), 10);
            if (!pageSize || pageSize < 1) {
                pageSize = 6;
            }

            if (data.length <= pageSize) {
                return;
            }
            var currentPage = 0;

            function renderCard(item, globalIndex) {
                if (!item) return '';
                var cls = (globalIndex % 2 === 0) ? 'support-card support-card--warm' : 'support-card support-card--cool';
                var icon = item.icon || 'fas fa-headset';
                var title = item.title || '';
                var phone = item.phone || '';
                var email = item.email || '';
                var link = item.link || '';
                var linkLabel = item.linklabel || item.linktext || 'Open Link';

                var html = '';
                html += '<div class="' + cls + '">';
                html += '<div class="support-card-title">';
                html += '<i class="' + icon + '"></i>';
                html += '<span>' + title + '</span>';
                html += '</div>';
                html += '<div class="support-card-body">';
                if (phone) {
                    html += '<div class="support-detail"><i class="fas fa-phone"></i><span class="support-detail-text">' + phone + '</span></div>';
                }
                if (email) {
                    html += '<div class="support-detail"><i class="fas fa-envelope"></i><a class="support-detail-link" href="mailto:' + email + '">' + email + '</a></div>';
                }
                if (link) {
                    html += '<div class="support-detail"><i class="fas fa-external-link-alt"></i><a class="support-detail-action" href="' + link + '" target="_blank" rel="noopener">' + linkLabel + '</a></div>';
                }
                html += '</div>';
                html += '</div>';
                return html;
            }

            function renderPage() {
                var start = currentPage * pageSize;
                var slice = data.slice(start, start + pageSize);
                var html = '';
                for (var i = 0; i < slice.length; i++) {
                    html += renderCard(slice[i], start + i);
                }
                grid.innerHTML = html;

                var totalPages = Math.max(1, Math.ceil(data.length / pageSize));
                prevBtn.disabled = currentPage === 0;
                nextBtn.disabled = currentPage >= totalPages - 1;
                pageInfo.textContent = 'Page ' + (currentPage + 1) + ' of ' + totalPages;
            }

            prevBtn.addEventListener('click', function () {
                if (currentPage > 0) {
                    currentPage--;
                    renderPage();
                }
            });
            nextBtn.addEventListener('click', function () {
                var totalPages = Math.max(1, Math.ceil(data.length / pageSize));
                if (currentPage < totalPages - 1) {
                    currentPage++;
                    renderPage();
                }
            });

            renderPage();
        })();
    </script>
</body>

</html>
